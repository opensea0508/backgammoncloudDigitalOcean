{"version":3,"sources":["config.ts","game/components/constants.ts","game/game-manager/game-state/index.tsx","game/dom-refs.ts","game/utils/index.ts","game/utils/backgammon.ts","game/game-manager/game-ui/hooks/useMoveCheckerAnimation.ts","game/game-manager/game-ui/hooks/useHandleMoveAnimation.ts","game/game-manager/game-ui/hooks/useRollDiceAnimation.ts","game/game-manager/game-ui/index.tsx","game/game-manager/network-manager/io.ts","game/components/bar-actions/icons/check.svg","game/game-manager/network-manager/constants.ts","game/game-manager/network-manager/hooks/useListeners.ts","game/game-manager/network-manager/hooks/useEmitters.ts","game/game-manager/network-manager/hooks/useRooms.ts","game/game-manager/network-manager/index.tsx","game/game-manager/inference/index.tsx","game/game-manager/stats/index.tsx","services/auth.service.ts","common/EventBus.ts","game/components/lobby/styles.tsx","game/components/lobby/ui/styles.tsx","game/components/lobby/ui/textbox/styles.tsx","game/components/lobby/ui/textbox/index.tsx","game/components/lobby/create-game/index.tsx","game/components/lobby/join-game/styles.tsx","game/components/lobby/join-game/index.tsx","game/components/lobby/index.tsx","pages/lobby/index.tsx","game/components/checker/styles.tsx","game/components/checker/index.tsx","game/components/board/styles.tsx","game/components/quadrant/styles.tsx","game/components/pip/styles.tsx","game/components/pip/index.tsx","game/components/quadrant/index.tsx","game/components/hud/styles.tsx","game/components/dice-container/styles.tsx","game/components/die/config.ts","game/components/die/styles.tsx","game/components/die/index.tsx","game/components/dice-container/index.tsx","game/components/hud/index.tsx","game/components/hit-space/styles.tsx","game/components/hit-space/index.tsx","game/components/bear-off/styles.tsx","game/components/bear-off/index.tsx","game/components/bar-actions/icons/undo.svg","game/components/bar-actions/styles.tsx","game/components/bar-actions/index.tsx","game/components/board/index.tsx","game/components/playground/styles.tsx","game/components/playground/index.tsx","pages/playground/index.tsx","game/components/login/index.tsx","game/components/register/index.tsx","pages/Home/index.tsx","game/components/profile/index.tsx","services/auth-header.ts","services/user.service.ts","pages/boardUser/index.tsx","game/components/allRooms.tsx","game/components/allUsers/index.tsx","pages/config.ts","pages/main.tsx","pages/index.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["API_URL","SOCKET_URL","QUADRANT_CONFIGS","left","quadrantNum","pipsRange","from","to","right","DIMENSIONS_CONFIG","PlayerTypeEnum","INITIAL_STATE","turn","diceRolled","plyRoll","positionTransitionsMap","stateMachine","initDiceRolled","W","B","hitSpace","bearOff","pips","isEmpty","player","count","pipId","undefined","ANIMATION_DURATION","GameStateContext","createContext","GameStateProvider","children","useState","state","updateGameState","consequences","updateConsequences","Provider","value","useGameState","useContext","pipRefs","hitSpaceRefs","bearOffRefs","getOpponent","p","coalesce","arr","find","it","getUniqueId","Math","random","toString","substr","wait","ms","Promise","resolve","setTimeout","calculateTranslatingPosition","sourceElement","targetElement","offset","sourcePosition","getBoundingClientRect","targetPosition","top","isFacingNorth","getBearOffPosition","isThereMoveOnPipPosition","pipPosition","positionTranslations","some","n","BEAROFF_CHECKER_RATIO","useMoveChecker","animationsMetadata","setAnimationsMetadata","currentAnimations","animationHandler","commit","fromPosition","toPosition","shouldDispose","animationUniqueId","isHitSpaceMove","isBearOffMove","sourceParent","targetParent","sourcePip","querySelector","targetPip","transformedPosition","duration","pipNum","filter","dispose","useHandleMoveAnimation","params","animationService","handleMoveAnimation","move","isHit","document","click","moveChecker","animationDisposeId","nthDie","die","randomDieFaceSequence","concat","times","map","dieFaceSequence","ROLL_DICE_ANIMATION_DURATION","GameUIContext","GameUIProvider","selectedChecker","pressedRoll","pressedUndo","pressedConfirm","isExecutingMove","isExecutingRoll","uiState","updateUiState","useMoveCheckerAnimation","moveCheckerHandler","moveCheckerAnimationsMetadata","useRollDiceAnimation","rollDiceHandler","rollDiceAnimationsMetadata","rollDice","animations","useGameUI","hostname","window","location","_path","_path2","socket","io","Actions","JOIN_ROOM_ERRORS","useListeners","syncUpdateGameState","syncUpdateConsequences","syncUpdateUiState","history","useHistory","networkState","syncUpdateNetworkState","updateNetworkState","roomsService","currentNetworkState","currentGameState","currentConsequences","currentUiState","newState","useEffect","IO","on","payload","then","setRooms","rooms","setIsLoading","console","log","setAllRooms","allRooms","setIsLoadingAll","setAllUsers","allUsers","roomId","roomName","role","hostUsername","status","initCreateForm","setIsCreatingRoom","guestUsername","setError","push","initState","setIsSendRematchInvitationLoading","setHasPendingRematchInvitation","finalState","diceRolledMetadata","animationsToExecute","all","length","transactionEntries","i","updatedState","error","errorType","includes","setIsJoiningRoom","useEmitters","createRoom","emit","deleteRoom","joinRoom","username","pressInitRoll","pressRoll","getRooms","getAllRooms","getAllUsers","selectToMove","positionTranslation","confirmMove","undo","sendRematchInvitation","acceptRematchInvitation","declineRematchInvitation","quitFromGame","useRoomsService","isLoading","isLoadingAll","isSendRematchInvitationLoading","hasPendingRematchInvitation","isCreatingRoom","isJoiningRoom","createRoomForm","updateCreateRoomForm","joinRoomForm","updateJoinRoomForm","initJoinForm","NetworkManagerContext","NetworkManagerProvider","useRooms","emitterService","useNetworkManager","InferenceContext","InferenceProvider","myPlayer","isMyTurn","shouldShowDiceContainer","getUsernameByPlayer","getNetworkRoleByPlayer","hasWin","canInviteForRematch","shouldShowRematchInvitation","canInitRoll","checks","every","identity","canRoll","canUndo","canConfirmMove","getHasPipMove","hasPossibleMove","get","areThereNonAvailableMoves","Boolean","type","getDiceMetadata","isRolling","nonAvailableMovesConsequence","sameRollConsequence","finishedInitRollConsequence","dieNum","rolledDie","initDie","resultingRoll","rolledDice","whoWon","maxBy","playerName","bearOffRank","useGameInference","StatsContext","StatsProvider","hasSameDieRolledConsequence","hasFinishedInitRollConsequence","inferLog","cond","constant","style","color","consequence","password","axios","post","response","data","accessToken","localStorage","setItem","JSON","stringify","removeItem","email","country","gender","birthday","userStr","getItem","parse","eventBus","event","callback","addEventListener","e","dispatch","dispatchEvent","CustomEvent","detail","remove","removeEventListener","colors","Lobby","styled","div","OptionsForm","Body","RightContainer","isSelected","Container","Link","Title","h3","Button","button","ControlWrapper","ErrorWrapper","label","TextBox","input","TextBoxComponent","defaultValue","onChange","width","placeholder","currentValue","setCurrentValue","newValue","target","CreateGameComponent","isCreateDisabled","key","syncField","flexDirection","height","disabled","onClick","onCreate","StyledBody","GameItems","ItemWrapper","isExpanded","Item","ItemSection","section","ItemLabel","JoinGameComponent","expandedRoomId","setExpandedRoom","setUsername","AuthService","getCurrentUser","isJoinDisabled","errorMessage","getErrorMessage","game","id","current","name","LobbyComponent","useLocation","currentUserRole","setCurrentUserRole","Page","LobbyPage","ACTIVE_CHECKER_RATIO","CheckerInner","Checker","dimensions","theme","animationMetadata","shouldAnimate","css","keyframes","hasMove","isBearOffChecker","CheckerComponent","entries","checkerNum","canBeSelected","isHitChecker","countIndicator","canBeHit","moveCheckerAnimations","classNames","when","join","moveCheckerAnimation","animation","shouldTransformToBearOffChecker","shouldShowInner","className","onMouseDown","stopPropagation","nextSelectedChecker","BAR_TICKNESS_RATIO","CENTER_BAR_TICKNESS_RATIO","BEAROFF_BAR_RATIO","ActiveSection","Board","WoodBar","side","calculateWoodBoxStyles","PlaygroundContainer","Ruler","Pips","Quadrant","PipWrapper","Triangle","metadata","styles","even","backgroundColor","transform","renderPipTriangle","shouldHighlight","CheckerStack","PositionHandle","PipComponent","pipNumber","currentPipState","nth","currentCount","checkersIterator","slice","getCanBeSelected","MAX_CHECKERS_SHOWN","positionTranslationsForSelectedChecker","shouldHighlightMovePosition","onSelectPosition","ref","QuadrantComponent","range","CONTROLS_RATIO","animateExpandButton","HUD","ActionButtonsWrapper","RollButton","DiceContainer","pointConfigs","Map","set","faceConfigs","face","points","DIE_RATIO","DIE_POINT_RATIO","getDieSize","viewportDimensions","getPointSize","getDieDimension","getRotationForDieNum","Scene","Die","faceDieNumFaceUpFront","stepIntensity","rotationSequence","nthStep","rotateCube","DieFace","cubeSize","styleCubeFace","Point","position","pointSize","halfPointSize","bottom","stylePoint","DieComponent","animationForThisDice","faceConfig","DiceContainerComponent","diceToShow","HUDComponent","onRoll","isInit","HitContainer","BearOffContainer","Inner","direction","borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius","getDirectionStyles","BearOffComponent","checkersDirection","_excluded","_extends","Object","assign","arguments","source","prototype","hasOwnProperty","call","apply","this","_objectWithoutProperties","excluded","sourceKeys","keys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","SvgCheck","_ref","svgRef","title","titleId","props","xmlns","viewBox","d","fill","stroke","ForwardRef","SvgUndo","BarActions","ControlItem","isDisabled","CheckIcon","$CheckIcon","is_disabled","UndoIcon","$UndoIcon","BarActionsComponent","isUndoDisabled","isConfirmDisabled","String","woodBarsSides","BoardComponent","config","Playground","BoardContainer","Stats","PendingBanner","PlayerLane","LogLane","Toast","Spinner","JumpOutImage","PlaygroundComponent","shouldRenderBoard","borderRight","borderLeft","src","PlaygroundPage","Styles","Login","loading","setLoading","message","setMessage","validationSchema","Yup","shape","required","alt","initialValues","onSubmit","formValue","login","reload","resMessage","htmlFor","component","Register","successful","setSuccessful","showState","setShowState","countryValue","setCountryValue","test","val","register","as","currentTarget","Home","Profile","currentUser","substring","authHeader","userInfo","Error","headers","deleteItem","BoardUser","content","UserService","getUserBoard","setState","EventBus","Component","AllRoomsComponent","room","j","hostCountry","guestCountry","AllUsersComponent","routes","path","isExact","Datas","setDatas","userService","deleteUser","user","win_time","loss_time","created_date","last_login_date","Main","gameStatus","setGameStatus","setCurrentUser","showAdminBoard","setShowAdminBoard","logOut","logout","href","route","exact","RouterWrapper","App","innerWidth","currentWidth","setCurrentWidth","innerHeight","currentHeight","setCurrentHeight","useSound","playMove","playHit","playDieThrow","playSelectChecker","undoMove","playWin","onResize","min","display","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"+MACIA,EAAiBC,E,yFCCRC,EAAmB,CAC9BC,KAAM,CACJ,CACEC,YAAa,EACbC,UAAW,CACTC,KAAM,EACNC,GAAI,KAGR,CACEH,YAAa,EACbC,UAAW,CACTC,KAAM,GACNC,GAAI,MAKVC,MAAO,CACL,CACEJ,YAAa,EACbC,UAAW,CACTC,KAAM,EACNC,GAAI,IAGR,CACEH,YAAa,EACbC,UAAW,CACTC,KAAM,GACNC,GAAI,OAMCE,EACS,IADTA,EAEgB,IAFhBA,EAGQ,IAHRA,EAIW,IAJXA,EAOY,IAPZA,EAQK,GARLA,EASA,GATAA,EAUM,IAKNC,EACJ,IADIA,EAEJ,IAQIC,EAA2B,CACtCC,KAAM,IACNC,WAAY,CAAC,EAAG,GAChBC,QAAS,CAAC,EAAG,GAEbC,uBAAwB,GACxBC,aAAc,eACdC,eAAgB,CACdC,EAAG,EACHC,EAAG,GAELC,SAAU,CACRF,EAAG,EACHC,EAAG,GAELE,QAAS,CACPH,EAAG,EACHC,EAAG,GAELG,KAAM,CACJ,CAAEC,SAAS,EAAOC,OAAQd,EAAsBe,MAAO,EAAGC,MAAO,GACjE,CAAEH,SAAS,EAAMC,YAAQG,EAAWF,MAAO,EAAGC,MAAO,GACrD,CAAEH,SAAS,EAAMC,YAAQG,EAAWF,MAAO,EAAGC,MAAO,GACrD,CAAEH,SAAS,EAAMC,YAAQG,EAAWF,MAAO,EAAGC,MAAO,GACrD,CAAEH,SAAS,EAAMC,YAAQG,EAAWF,MAAO,EAAGC,MAAO,GACrD,CAAEH,SAAS,EAAOC,OAAQd,EAAsBe,MAAO,EAAGC,MAAO,GACjE,CAAEH,SAAS,EAAMC,YAAQG,EAAWF,MAAO,EAAGC,MAAO,GACrD,CAAEH,SAAS,EAAOC,OAAQd,EAAsBe,MAAO,EAAGC,MAAO,GACjE,CAAEH,SAAS,EAAMC,YAAQG,EAAWF,MAAO,EAAGC,MAAO,GACrD,CAAEH,SAAS,EAAMC,YAAQG,EAAWF,MAAO,EAAGC,MAAO,GACrD,CAAEH,SAAS,EAAMC,YAAQG,EAAWF,MAAO,EAAGC,MAAO,IACrD,CAAEH,SAAS,EAAOC,OAAQd,EAAsBe,MAAO,EAAGC,MAAO,IACjE,CAAEH,SAAS,EAAOC,OAAQd,EAAsBe,MAAO,EAAGC,MAAO,IACjE,CAAEH,SAAS,EAAMC,YAAQG,EAAWF,MAAO,EAAGC,MAAO,IACrD,CAAEH,SAAS,EAAMC,YAAQG,EAAWF,MAAO,EAAGC,MAAO,IACrD,CAAEH,SAAS,EAAMC,YAAQG,EAAWF,MAAO,EAAGC,MAAO,IACrD,CAAEH,SAAS,EAAOC,OAAQd,EAAsBe,MAAO,EAAGC,MAAO,IACjE,CAAEH,SAAS,EAAMC,YAAQG,EAAWF,MAAO,EAAGC,MAAO,IACrD,CAAEH,SAAS,EAAOC,OAAQd,EAAsBe,MAAO,EAAGC,MAAO,IACjE,CAAEH,SAAS,EAAMC,YAAQG,EAAWF,MAAO,EAAGC,MAAO,IACrD,CAAEH,SAAS,EAAMC,YAAQG,EAAWF,MAAO,EAAGC,MAAO,IACrD,CAAEH,SAAS,EAAMC,YAAQG,EAAWF,MAAO,EAAGC,MAAO,IACrD,CAAEH,SAAS,EAAMC,YAAQG,EAAWF,MAAO,EAAGC,MAAO,IACrD,CAAEH,SAAS,EAAOC,OAAQd,EAAsBe,MAAO,EAAGC,MAAO,MAIxDE,EAAqB,G,OCnGrBC,EAAmBC,wBAAc,IAEjCC,EAA8B,SAAC,GAAkB,IAAhBC,EAAe,EAAfA,SAC5C,EACEC,mBAAgCtB,GADlC,mBAAOuB,EAAP,KAAcC,EAAd,KAGA,EAA2CF,mBAAwB,IAAnE,mBAAOG,EAAP,KAAqBC,EAArB,KAEA,OACE,cAACR,EAAiBS,SAAlB,CACEC,MAAO,CACLL,MAAOA,EACPE,eACAD,kBACAE,sBALJ,SAQGL,KAKMQ,EAAe,WAE1B,OADgBC,qBAAWZ,I,wBC/BlBa,EAAe,GACfC,EAAwC,CACjDzB,EAAG,KACHC,EAAG,MAGMyB,EAAuC,CAChD1B,EAAG,KACHC,EAAG,M,mCCNQ0B,EAAc,SAACC,GAAD,MACnB,MAANA,EAAY,IAAM,KAKPC,EAAW,SAACC,GAAD,OAAqBA,EAAIC,MAAK,SAACC,GAAD,OAAe,OAAPA,MAEjDC,EAAc,iBAAM,IAAMC,KAAKC,SAASC,SAAS,IAAIC,OAAO,EAAG,IAE/DC,EAAO,SAACC,GAAD,OAClB,IAAIC,SAAQ,SAACC,GAAD,OAAaC,WAAWD,EAASF,OAElCI,EAA+B,SAC1CC,EACAC,GAE0B,IAD1BC,EACyB,uDADhB,EAEHC,EAAiBH,EAAcI,wBAC/BC,EAAc,OAAGJ,QAAH,IAAGA,OAAH,EAAGA,EAAeG,wBAEtC,QAC2BvC,KAAX,OAAdsC,QAAc,IAAdA,OAAA,EAAAA,EAAgB9D,YACOwB,IAAvBsC,EAAeG,UACUzC,KAAX,OAAdwC,QAAc,IAAdA,OAAA,EAAAA,EAAgBhE,YACOwB,IAAvBwC,EAAeC,IAKjB,MAAO,CACLjE,KAAMgE,EAAehE,KAAO8D,EAAe9D,KAC3CiE,IAAKD,EAAeC,IAAMH,EAAeG,IAAMJ,I,kBC9BtCK,EAAgB,SAAC7C,GAAD,MAAmC,MAAXA,GAExC8C,EAAqB,SAAC9C,GAAD,OAChC6C,EAAc7C,IAAW,EAAI,IAQlB+C,EAA2B,SACtCC,EACAC,GAEA,YAA6B9C,IAAzB8C,GAIgBC,IAAKD,EAAqBlE,IAAI,SAACoE,GAAD,OAAOA,IAAMH,MCNzDI,EAA0BnE,EAmHnBoE,EAnGQ,WACrB,MAAoD5C,mBAElD,IAFF,mBAAO6C,EAAP,KAA2BC,EAA3B,KAIIC,EAAoD,GAElDC,EAAmB,CACvBC,OAAO,WAAD,sCAAE,WACNC,EACAC,EACA5D,GAHM,kHAIN6D,IAJM,iCAMAC,EAAoBnC,IACpBoC,EAAkC,cAAjBJ,EACjBK,EAAgBJ,IAAed,EAAmB9C,GAElDiE,EACa,cAAjBN,EACIxC,EAAanB,GACbkB,EAAQyC,GAERO,EACW,cAAfN,EACIzC,EAAanB,GACbgE,EACA5C,EAAYpB,GACZkB,EAAQ0C,GAERO,EAAYF,EAAaG,cAAc,4BAEvCC,EAAY9C,EAAS,CACzB2C,EAAaE,cAAb,sBAA0C/C,EAAYrB,KACtDkE,EAAaE,cAAc,sBAGvB5B,EACJwB,IAAkBnB,EAAc7C,GACH,KAAxBoD,EACD,OAOsBjD,KANtBmE,EAAsBjC,EAC1B8B,EACAE,EACA7B,IApCI,0CAwCGsB,GAxCH,eA4CNN,EAAiB,sBACZA,GADY,CAEf,CACEM,oBACAnF,KAAM2F,EAAoB3F,KAC1BiE,IAAK0B,EAAoB1B,IACzB2B,SAAUnE,EACVoE,OAAQT,OACJ5D,EACwB,kBAAjBwD,EACPA,OACAxD,EACJ4D,iBACAC,gBACAhE,YAGJuD,EAAsBC,GA7DhB,UAgEAxB,EAAK5B,KAhEL,eAoEFyD,IACFL,EAAoBA,EAAkBiB,QACpC,SAAC/C,GAAD,OAAQA,EAAGoC,oBAAsBA,KAEnCP,EAAsBC,IAxElB,kBA2ECM,GA3ED,4CAAF,uDAAC,GA6EPY,QAAQ,WAAD,sCAAE,WAAOZ,GAAP,2EACPN,EAAoBA,EAAkBiB,QACpC,SAAC/C,GAAD,OAAQA,EAAGoC,oBAAsBA,KAEnCP,EAAsBC,GAJf,2CAAF,mDAAC,IAQV,MAAO,CACLC,mBACAH,uBCvEWqB,EA/CgB,SAACC,GAC9B,IAAQC,EAAqBD,EAArBC,iBAEFC,EAAmB,iDAAG,WAAOC,GAAP,0FAClBjG,EAA4BiG,EAA5BjG,KAAMC,EAAsBgG,EAAtBhG,GAAIiB,EAAkB+E,EAAlB/E,QAAkB+E,EAAVC,MADA,wBAWvBC,SAASb,cAAc,cAAoCc,QAXpC,SAaSL,EAAiBM,YAAYzB,OAC5D5E,EACAC,EACAiB,GACA,GAjBsB,cAalBoF,EAbkB,OAoBvBH,SAASb,cAAc,aAAmCc,QApBnC,SAsBlBL,EAAiBM,YAAYzB,OACjC3E,EACA,YACAsC,EAAYrB,IAzBU,wBA4BlB6E,EAAiBM,YAAYT,QAAQU,GA5BnB,uCA8BvBH,SAASb,cAAc,cAAoCc,QA9BpC,UAgClBL,EAAiBM,YAAYzB,OAAO5E,EAAMC,EAAIiB,GAhC5B,8EAAH,sDAuCzB,MAAO,CACL8E,wB,sCC+BWzB,GAjEQ,WACrB,MAAoD5C,mBAElD,IAFF,mBAAO6C,EAAP,KAA2BC,EAA3B,KAIIC,EAAiD,GAE/CC,EAAmB,CACvBC,OAAO,WAAD,sCAAE,WACN1D,EACAqF,EACAC,GAHM,wGAINzB,IAJM,iCAMAC,EAAoBnC,IAGpB4D,EAAwB,CAAC,GAC5BC,OAAOC,KAAM5D,KAAO,GAAI,KAAK6D,KAAI,kBAAM7D,KAAO,EAAG,OACjD2D,OAAOF,GAGV9B,EAAiB,sBACZA,GADY,CAEf,CACExD,SACA8D,oBACAS,SAxCkC,EAyClCoB,gBAAiBJ,EACjBF,YAIJ9B,EAAsBC,GACDyB,SAASb,cAAc,oBACpCc,QA3BF,SA8BAlD,EAAK4D,KA9BL,cAkCF/B,IACFL,EAAoBA,EAAkBiB,QACpC,SAAC/C,GAAD,OAAQA,EAAGoC,oBAAsBA,KAEnCP,EAAsBC,IAtClB,kBAyCCM,GAzCD,4CAAF,uDAAC,GA2CPY,QAAQ,WAAD,sCAAE,WAAOZ,GAAP,2EACPN,EAAoBA,EAAkBiB,QACpC,SAAC/C,GAAD,OAAQA,EAAGoC,oBAAsBA,KAEnCP,EAAsBC,GAJf,2CAAF,mDAAC,IAQV,MAAO,CACLC,mBACAH,uBC7BSuC,GAAgBvF,wBAAc,IAE9BwF,GAA2B,SAAC,GAAkB,IAAhBtF,EAAe,EAAfA,SACzC,EAAiCC,mBAAkB,CACjDsF,qBAAiB5F,EACjB6F,aAAa,EACbC,aAAa,EACbC,gBAAgB,EAChBC,iBAAiB,EACjBC,gBAAiB,CACf1G,GAAG,EACHC,GAAG,KARP,mBAAO0G,EAAP,KAAgBC,EAAhB,KAaA,EAGIC,IAFgBC,EADpB,EACE/C,iBACoBgD,EAFtB,EAEEnD,mBAIF,EAGIoD,KAFgBC,EADpB,EACElD,iBACoBmD,EAFtB,EAEEtD,mBAGIuB,EAAqC,CACzCM,YAAaqB,EACbK,SAAUF,GAGJ7B,EAAwBH,EAAuB,CAAEE,qBAAjDC,oBAER,OACE,cAACe,GAAc/E,SAAf,CACEC,MAAO,CACLsF,UACAC,gBACAxB,sBACAD,mBACAiC,WAAY,CACV3B,YAAasB,EACbI,SAAUD,IARhB,SAYGpG,KAKMuG,GAAY,WAEvB,OADgB9F,qBAAW4E,K,oCT3GzBmB,GAAWC,OAAOC,SAASF,SAEf,cAAbA,IACCxI,EAAU,UAAYwI,GAAW,aACjCvI,EAAa,QAAUuI,GAAW,UAGlCxI,EAAU,WAAawI,GAAW,QAClCvI,EAAa,SAAWuI,IUL5B,I,0LCHIG,GAAOC,GDGLC,GAASC,aAAG7I,GAEH4I,MEHFE,GACQ,oBADRA,GAEQ,oBAFRA,GAGI,gBAHJA,GAIG,eAJHA,GAKE,cALFA,GAMG,eANHA,GAOC,aAPDA,GAQG,eARHA,GASG,eATHA,GAWK,iBAXLA,GAYU,sBAZVA,GAac,0BAbdA,GAckB,8BAdlBA,GAeC,aAfDA,GAgBA,YAhBAA,GAmBI,gBAnBJA,GAoBI,gBApBJA,GAqBA,YArBAA,GAsBE,cAtBFA,GAuBA,YAvBAA,GAwBA,YAxBAA,GAyBL,OAzBKA,GA0BL,OA1BKA,GA2BA,YA3BAA,GA4BG,eA5BHA,GA6BS,qBA7BTA,GA8BK,iBA9BLA,GA+BM,kBA/BNA,GAgCK,iBAhCLA,GAiCE,cAGFC,GAAgC,CAC3C,qBACA,wBCsVaC,GAnWM,SAAC7C,GACpB,MAKI5D,IAJFN,EADF,EACEA,MACAE,EAFF,EAEEA,aACiB8G,EAHnB,EAGE/G,gBACoBgH,EAJtB,EAIE9G,mBAGF,EAKIkG,KAJFV,EADF,EACEA,QACeuB,EAFjB,EAEEtB,cACAxB,EAHF,EAGEA,oBACAD,EAJF,EAIEA,iBAGIgD,EAAUC,eAGdC,EAGEnD,EAHFmD,aACoBC,EAElBpD,EAFFqD,mBACAC,EACEtD,EADFsD,aAGEC,EAAmB,gBAAQJ,GAC3BK,EAAgB,gBAAQ1H,GACxB2H,EAAmB,YAAOzH,GAC1B0H,EAAc,gBAAQjC,GAEpB1F,EAAkB,SAAC4H,GACvBH,EAAgB,gBAAQG,GACxBb,EAAoBU,IAGhBvH,EAAqB,SAACD,GAC1ByH,EAAmB,YAAOzH,GAC1B+G,EAAuBU,IAGnBJ,EAAqB,SAACM,GAC1BJ,EAAmB,gBAAQI,GAC3BP,EAAuBG,IAGnB7B,EAAgB,SAACiC,GACrBD,EAAc,gBAAQC,GACtBX,EAAkBU,IAkTpB,OA/SAE,qBAAU,WACRC,GAAGC,GAAGnB,IAAuB,SAACoB,GAC5B3G,EAAK,KAAK4G,MAAK,WACbV,EAAaW,SAASF,EAAQG,OAC9BZ,EAAaa,cAAa,SAI9BN,GAAGC,GAAGnB,IAA2B,SAACoB,GAChCK,QAAQC,IAAI,qBACZjH,EAAK,KAAK4G,MAAK,WACbV,EAAagB,YAAYP,EAAQQ,UACjCjB,EAAakB,iBAAgB,GAC7BJ,QAAQC,IAAI,qBACZD,QAAQC,IAAIN,EAAQQ,gBAIxBV,GAAGC,GAAGnB,IAA2B,SAACoB,GAChC3G,EAAK,KAAK4G,MAAK,WACbV,EAAamB,YAAYV,EAAQW,UACjCpB,EAAakB,iBAAgB,SAIjCX,GAAGC,GAAGnB,IAAsB,SAACoB,GAC3B,IAAQY,EAAiDZ,EAAjDY,OAAQC,EAAyCb,EAAzCa,SAAUC,EAA+Bd,EAA/Bc,KAAMC,EAAyBf,EAAzBe,aAAcC,EAAWhB,EAAXgB,OAC9CX,QAAQC,IAAI1B,GAAsBoB,GAElCR,EAAmB,6BACdA,GADc,IAEjBwB,SACAJ,SACAC,WACAC,OACAC,iBAGFzB,EAAmBE,GAEnBnG,EAAK,KAAK4G,MAAK,WACbV,EAAa0B,iBACb1B,EAAa2B,mBAAkB,SAMnCpB,GAAGC,GAAGnB,IAA6B,SAACoB,GAClCK,QAAQC,IAAI1B,GAA6BoB,GAEzC,IAAQY,EAAsDZ,EAAtDY,OAAQE,EAA8Cd,EAA9Cc,KAAMC,EAAwCf,EAAxCe,aAAcI,EAA0BnB,EAA1BmB,cAAeH,EAAWhB,EAAXgB,OAEnDxB,EAAmB,6BACdA,GADc,IAEjBwB,SACAJ,SACAE,OACAC,eACAI,kBAGF7B,EAAmBE,MAGrBM,GAAGC,GAAGnB,IAAqB,SAACoB,GAC1BK,QAAQC,IAAI1B,GAAqBoB,GACjC,IAAQY,EACNZ,EADMY,OAAQC,EACdb,EADca,SAAUC,EACxBd,EADwBc,KAAMC,EAC9Bf,EAD8Be,aAAcI,EAC5CnB,EAD4CmB,cAAeH,EAC3DhB,EAD2DgB,OAG7DX,QAAQC,IAAI,WAEZd,EAAmB,6BACdA,GADc,IAEjBoB,SACAC,WACAC,OACAC,eACAI,gBACAH,WAGF1B,EAAmBE,GACnBD,EAAa6B,cAAS5J,GACtB0H,EAAQmC,KAAR,gBAAsBT,OAGxBd,GAAGC,GAAGnB,IAAsB,SAACoB,GAC3BK,QAAQC,IAAI1B,GAAsBoB,GAClC,IAAQsB,EAActB,EAAdsB,UAERtJ,EAAgB,gBACXsJ,IAGL/B,EAAagC,mCAAkC,GAC/ChC,EAAaiC,gCAA+B,GAE5ChC,EAAmB,6BACdA,GADc,IAEjBwB,OAAQ,YAEV1B,EAAmBE,MAGrBM,GAAGC,GAAGnB,IAAoB,SAACoB,GACzBK,QAAQC,IAAI1B,GAAoBoB,GAChC,IAAQjI,EAAsBiI,EAAtBjI,MAAO0J,EAAezB,EAAfyB,WAEfzJ,EAAgB,gBACXD,IAGD0J,GACFpI,EAAK,MAAM4G,MAAK,WACdjI,EAAgB,gBACXyJ,OAKTnC,EAAmB,6BAAKE,GAAN,IAA2BwB,OAAQ,aAQrDrD,EAAc,6BACTgC,GAPuB,CAC1BtC,aAAa,EACbC,aAAa,EACbC,gBAAgB,QASpBuC,GAAGC,GAAGnB,GAAN,iDAA4B,WAAOoB,GAAP,gGAC1BK,QAAQC,IAAI1B,GAAsBoB,GAE1B0B,EAA4C1B,EAA5C0B,mBAAoBzJ,EAAwB+H,EAAxB/H,aAAcF,EAAUiI,EAAVjI,MAEpC4J,EAAsB5E,IAC1B2E,GACA,gBAAGrK,EAAH,EAAGA,OAAQqF,EAAX,EAAWA,OAAQC,EAAnB,EAAmBA,IAAnB,OACET,EAAiBgC,SAASnD,OAAO1D,EAAQqF,EAAQC,MAG/CtF,EAASqK,EAAmB,GAAGrK,OAUrCsG,EAAc,6BACTgC,GADQ,IAEXlC,gBAAgB,6BACXkC,EAAelC,iBADL,mBAEZpG,GAAS,OAzBY,SA6BpBkC,QAAQqI,IAAID,GA7BQ,YA+BtB1J,EAAa4J,OAAS,GA/BA,wBAgCxB3J,EAAmBD,GAhCK,UAiClBoB,EAAK,MAjCa,QAkCxBnB,EAAmB,IAlCK,QAqC1BF,EAAgBD,GAChB4F,EAAc,6BACTgC,GADQ,IAEXlC,gBAAgB,6BACXkC,EAAelC,iBADL,mBAEZpG,GAAS,OA1CY,4CAA5B,uDA+CAyI,GAAGC,GAAGnB,IAAmB,SAACoB,GACxBK,QAAQC,IAAI1B,GAAmBoB,GAC/B,IAAQjI,EAAUiI,EAAVjI,MAERC,EAAgB,gBACXD,IAGLyH,EAAmB,6BAAQA,GAAR,IAA6BwB,OAAQ,YACxD1B,EAAmBE,MAGrBM,GAAGC,GAAGnB,GAAN,iDAA4B,WAAOoB,GAAP,yFAC1BK,QAAQC,IAAI1B,GAAsB,YAAaoB,GAEzC8B,EACJ9B,EAAQ8B,mBAEVnE,EAAc,6BACTgC,GADQ,IAEXnC,iBAAiB,KAGVuE,EAAI,EAXa,YAWVA,EAAID,EAAmBD,QAXb,wBAYlBzF,EAAO0F,EAAmBC,GAAG3F,KAC7B4F,EAAeF,EAAmBC,GAAGhK,MAbnB,SAelBoE,EAAoBC,GAfF,OAgBxBpE,EAAgBgK,GAhBQ,QAWqBD,IAXrB,4BAqBPvK,KAFXiK,EAAezB,EAAfyB,aAKNzJ,EAAgByJ,GAGlB9D,EAAc,6BACTgC,GADQ,IAEXnC,iBAAiB,KA7BO,4CAA5B,uDAiCAsC,GAAGC,GAAGnB,IAAiC,WACrCW,EAAaiC,gCAA+B,MAG9C1B,GAAGC,GAAGnB,IAAqC,WACzCW,EAAagC,mCAAkC,GAC/ChC,EAAaiC,gCAA+B,GAC5CtC,EAAQmC,KAAK,QAGfvB,GAAGC,GAAGnB,GAAN,iDAA8B,WAAOqD,GAAP,iFAC5B5B,QAAQC,IAAI1B,GAAwB,QAASqD,GAErCC,EAAcD,EAAdC,UAEJrD,GAAiBsD,SAASD,KAC5B3C,EAAa6B,SAASa,GACtB1C,EAAa6C,kBAAiB,IAPJ,2CAA9B,uDAWAtC,GAAGC,GAAGnB,IAAoB,SAACkC,GACzBT,QAAQC,IAAIQ,GAEK,SAAdA,EAAKA,OACNT,QAAQC,IAAI,4CAEoB,SAA7Bd,EAAoBsB,MACrBtB,EAAoBwB,OAAS,cAC7BxB,EAAoBsB,UAAOtJ,EAC3BgI,EAAoBuB,kBAAevJ,EACnCgI,EAAoB2B,mBAAgB3J,EACpCgI,EAAoBoB,YAASpJ,EAC7BgI,EAAoBqB,cAAWrJ,IAG/BgI,EAAoBwB,OAAS,oBAC7BxB,EAAoBsB,KAAO,OAC3BtB,EAAoBuB,aAAevB,EAAoB2B,cACvD3B,EAAoB2B,mBAAgB3J,GAEtC8H,EAAmBE,IAEJ,UAAdsB,EAAKA,OACNT,QAAQC,IAAI,6CACoB,SAA7Bd,EAAoBsB,MACrBtB,EAAoBwB,OAAS,oBAC7BxB,EAAoB2B,mBAAgB3J,IAGpCgI,EAAoBwB,OAAS,cAC7BxB,EAAoBsB,UAAOtJ,EAC3BgI,EAAoBuB,kBAAevJ,EACnCgI,EAAoB2B,mBAAgB3J,EACpCgI,EAAoBoB,YAASpJ,EAC7BgI,EAAoBqB,cAAWrJ,GAEjC8H,EAAmBE,OAKvBM,GAAGC,GAAGnB,IAAmB,WACvByB,QAAQC,IAAI,uCACZd,EAAoBwB,OAAS,cAC7BxB,EAAoBsB,UAAOtJ,EAC3BgI,EAAoBuB,kBAAevJ,EACnCgI,EAAoB2B,mBAAgB3J,EACpCgI,EAAoBoB,YAASpJ,EAC7BgI,EAAoBqB,cAAWrJ,EAC/B8H,EAAmBE,GACnBa,QAAQC,IAAI,SAGb,IAEI,ICzPM+B,GAjGK,SAACpG,GACnB,IAAQsD,EAAiBtD,EAAjBsD,aA6ER,MAAO,CACL+C,WA5DiB,SAACzB,GAClBf,GAAGyC,KAAK3D,GAAqB,CAC3BiC,cA2DF2B,WAvDiB,SAAC5B,GAClBP,QAAQC,IAAI,cACZR,GAAGyC,KAAK3D,GAAqB,CAC3BgC,YAqDF6B,SAjDe,SAAC7B,EAAgB8B,GAChC5C,GAAGyC,KAAK3D,GAAmB,CACzBgC,SACA8B,cA+CFC,cA3CoB,WACpB7C,GAAGyC,KAAK3D,GAAmB,KA2C3BgE,UAxCgB,WAChB9C,GAAGyC,KAAK3D,GAAc,KAwCtBiE,SAtEe,WACftD,EAAaa,cAAa,GAC1BN,GAAGyC,KAAK3D,GAAmB,KAqE3BkE,YA7EkB,WAClBzC,QAAQC,IAAI,6BACZf,EAAakB,iBAAgB,GAC7BX,GAAGyC,KAAK3D,GAAuB,KA2E/BmE,YAnFkB,WAClBxD,EAAakB,iBAAgB,GAC7BX,GAAGyC,KAAK3D,GAAuB,KAkF/BoE,aAxCmB,SAACC,GAEpBnD,GAAGyC,KAAK3D,GAAcqE,IAuCtBC,YApCkB,WAClBpD,GAAGyC,KAAK3D,GAAsB,KAoC9BuE,KAjCW,WACXrD,GAAGyC,KAAK3D,GAAmB,KAiC3BwE,sBA7B4B,WAC5BtD,GAAGyC,KAAK3D,GAA4B,KA6BpCyE,wBA1B8B,WAC9BvD,GAAGyC,KAAK3D,GAAwB,KA0BhC0E,yBAvB+B,WAC/BxD,GAAGyC,KAAK3D,GAAyB,KAuBjC2E,aApBmB,SAACvC,EAAgBJ,EAAgBE,EAAcC,EAAsBI,GACxFd,QAAQC,IAAI,6CACZR,GAAGyC,KAAK3D,GAAwB,CAACoC,SAAQJ,SAAQE,OAAMC,eAAcI,qBCW1DqC,GA/DS,SAACvH,GACvB,MAAkCnE,oBAAkB,GAApD,mBAAO2L,EAAP,KAAkBrD,EAAlB,KACA,EAAwCtI,oBAAkB,GAA1D,mBAAO4L,EAAP,KAAqBjD,EAArB,KACA,EACE3I,oBAAkB,GADpB,mBAAO6L,EAAP,KAAuCpC,EAAvC,KAGA,EACEzJ,oBAAkB,GADpB,mBAAO8L,EAAP,KAAoCpC,EAApC,KAGA,EAA0B1J,mBAAiB,IAA3C,mBAAOqI,EAAP,KAAcD,EAAd,KACA,EAAgCpI,mBAAqB,IAArD,mBAAO0I,EAAP,KAAiBD,EAAjB,KACA,EAAgCzI,mBAAqB,IAArD,mBAAO6I,EAAP,KAAiBD,EAAjB,KACA,EAA4C5I,oBAAkB,GAA9D,mBAAO+L,EAAP,KAAuB3C,EAAvB,KACA,EAA0CpJ,oBAAkB,GAA5D,mBAAOgM,EAAP,KAAsB1B,EAAtB,KAEA,EAA+CtK,mBAzBf,CAChC+I,cAAUrJ,IAwBV,mBAAOuM,EAAP,KAAuBC,EAAvB,KAIA,EAA2ClM,mBAxBb,CAC9B8I,YAAQpJ,EACRkL,cAAUlL,IAsBV,mBAAOyM,EAAP,KAAqBC,EAArB,KAIA,EAA0BpM,wBAA6BN,GAAvD,mBAAOyK,EAAP,KAAcb,EAAd,KAUA,MAAO,CACLqC,YACArD,eACAD,QACAD,WACAwD,eACAjD,kBACAD,WACAD,cACAI,WACAD,cACAqD,iBACAF,iBACA3C,oBACA8C,uBACA/C,eAvBqB,WACrB+C,EApC8B,CAChCnD,cAAUrJ,KA0DRsM,gBACA1B,mBACA8B,qBACAD,eACAE,aAxBmB,WACnBD,EAnC4B,CAC9BtD,YAAQpJ,EACRkL,cAAUlL,KAyDRyK,QACAb,WACAuC,iCACApC,oCACAqC,8BACApC,mCCtGS4C,GAAwBzM,wBACnC,IAGW0M,GAAmC,SAAC,GAAkB,IAAhBxM,EAAe,EAAfA,SACjD,EAA2CC,mBAAuB,CAChEkJ,OAAQ,cACRJ,YAAQpJ,EACRqJ,cAAUrJ,EACVuJ,kBAAcvJ,EACd2J,mBAAe3J,EACfsJ,UAAMtJ,IANR,mBAAO4H,EAAP,KAAqBE,EAArB,KASMC,EAAe+E,GAAS,IAE9BxF,GAAa,CAAEM,eAAcE,qBAAoBC,iBAEjD,IAAMgF,EAAiBlC,GAAY,CACjCjD,eACAE,qBACAC,iBAGF,OACE,cAAC6E,GAAsBjM,SAAvB,CACEC,MAAO,CACLgH,eACAG,eACAgF,kBAJJ,SAOG1M,KAKM2M,GAAoB,WAE/B,OADgBlM,qBAAW8L,K,QCPhBK,GAAmB9M,wBAAc,IAEjC+M,GAA8B,SAAC,GAAkB,IAAhB7M,EAAe,EAAfA,SAC5C,EAAuC2M,KAA/BpF,EAAR,EAAQA,aAAcG,EAAtB,EAAsBA,aACtB,EAAgClH,IAAxBN,EAAR,EAAQA,MAAOE,EAAf,EAAeA,aACPyF,EAAYU,KAAZV,QAEFiH,EZrCG,SYqC2BvF,EAAa0B,KZrC/B,IAAM,IYsClB8D,EAAW7M,EAAMtB,OAASkO,EAuF1BE,EAA0B,SAACxN,GAC/B,IAAQR,EAAmDkB,EAAnDlB,aAAoBC,GAA+BiB,EAArCtB,KAAqCsB,EAA/BjB,gBAA+BiB,EAAfrB,WAU5C,OAT4BgH,EAApBD,gBAE0BpG,IAIf,iBAAjBR,GACkB,sBAAjBA,IAAoE,IAA5BC,EAAeO,IAuGtDyN,EAAsB,SAACzN,GAC3B,IAAMyJ,EZ5O4B,SAACzJ,GAAD,MACzB,MAAXA,EAAiB,OAAS,QY2OX0N,CAAuB1N,GAIpC,OAFW,SAATyJ,EAAkB1B,EAAa2B,aAAe3B,EAAa+B,gBAE1C,IAGf6D,EAAS,WAEb,MAAwB,QADCjN,EAAjBlB,cA2CV,OACE,cAAC4N,GAAiBtM,SAAlB,CACEC,MAAO,CACLuM,WACAC,WACAK,oBAhBsB,WAC1B,IAAKD,IACH,OAAO,EAGT,IAAQrB,EACNpE,EADMoE,+BAAgCC,EACtCrE,EADsCqE,4BAGxC,OAAQD,IAAmCC,GASvCsB,4BA1B8B,WAClC,QAAKF,KAImCzF,EAAhCqE,6BAsBJuB,YA9Oc,WAClB,IAAQ9H,EAAiCK,EAAjCL,YAAaI,EAAoBC,EAApBD,gBACb5G,EAAiCkB,EAAjClB,aAAcC,EAAmBiB,EAAnBjB,eAChBsO,EAAS,EACZ3H,EAAgBkH,GACA,sBAAjB9N,GAC8B,IAA9BC,EAAe6N,IACdtH,GAGH,OAAOgI,iBAAMD,EAAQE,cAqOjBC,QAlOU,WACd,IAAQ1O,EAA6BkB,EAA7BlB,aAAcH,EAAeqB,EAAfrB,WACd2G,EAAiCK,EAAjCL,YAAaI,EAAoBC,EAApBD,gBAEf2H,EAAS,CACbR,GACCnH,EAAgBkH,GACA,iBAAjB9N,EACsB,IAAtBH,EAAWmL,QACVxE,GAEH,OAAOgI,iBAAMD,EAAQE,cAwNjBE,QAxMU,WACd,IAAQhI,EAAiCE,EAAjCF,gBAAiBF,EAAgBI,EAAhBJ,YACjBzG,EAAsCkB,EAAtClB,aAAcH,EAAwBqB,EAAxBrB,WAIhB0O,EAAS,CAJ+BrN,EAAZpB,QAEUkL,OAASnL,EAAWmL,QAI7DvE,EACDsH,EACiB,iBAAjB/N,GACC2G,GAGH,OAAO6H,iBAAMD,EAAQE,cA2LjBG,eAtNiB,WACrB,IAAQlI,EAAmBG,EAAnBH,eACA1G,EAAqDkB,EAArDlB,aAAcH,EAAuCqB,EAAvCrB,WAAYE,EAA2BmB,EAA3BnB,uBAC5BwO,EAAS,CACbR,GACCrH,EACgB,iBAAjB1G,EACsB,IAAtBH,EAAWmL,QAAkD,IAAlCjL,EAAuBiL,QAGpD,OAAOwD,iBAAMD,EAAQE,cA6MjBI,cApQgB,SACpBnO,EACAF,GAEA,IAAQT,EAA2BmB,EAA3BnB,uBAEF+O,EACJC,eAAI9M,gBAAKlC,EAAwB,CAAET,KAAMoB,IAAU,YAAa,GAAK,EAIvE,MAAc,cAAVA,EACKqN,IAH0B,cAAVrN,GAAyBF,IAAWsN,IAGpBgB,EAGlCf,GAAYe,GAsPfb,sBACAe,0BA3L4B,WAOhC,OANqCC,QACnChN,gBAAKb,EAAc,CACjB8N,KAAM,0BAyLNlB,0BACAmB,gBArKkB,SAAC3O,GAGvB,IAFoBwN,EAAwBxN,GAG1C,MAAO,GAGT,IAAQR,EAAmDkB,EAAnDlB,aAAcJ,EAAqCsB,EAArCtB,KAAMK,EAA+BiB,EAA/BjB,eAAgBJ,EAAeqB,EAAfrB,WAGtCuP,EAFsBvI,EAApBD,gBAE0BpG,GAC5B6O,EAA+BpN,gBAAKb,EAAc,CACtD8N,KAAM,wBAGR,GAAqB,sBAAjBlP,EAAsC,CACxC,IAAMsP,EAAsBrN,gBAAKb,EAAc,CAC7C8N,KAAM,oBAGFK,EAA8BtN,gBAAKb,EAAc,CACrD8N,KAAM,uBAGR,QAA4BvO,IAAxB2O,EAGF,MAAO,CACL,CACEzJ,OAAQ,EACR2J,OALkBF,EAAoBnG,QAAlCsG,YAUV,QAAoC9O,IAAhC4O,EAKF,MAAO,CACL,CACE1J,OAAQ,EACR2J,OAPuBD,EAA4BpG,QAA/ClJ,eAE4BO,KAUtC,IAAMkP,EAAUzP,EAAeO,GAM/B,MAAO,EAL4B,IAAbkP,EAElB,CAAE7J,OAAQ,EAAG2J,OAAQE,GACrB,CAAE7J,OAAQ,EAAG2J,OAAQ,IAK3B,GAAIJ,EAAW,CACb,IAAMO,OAC6BhP,IAAjC0O,EACKA,EAA6BlG,QAAQyG,WACtC3J,iBAAM,GAUZ,OAR6CC,eAC3CyJ,GACA,SAACH,EAAQ3J,GAAT,MAAqB,CACnBA,SACA2J,aAON,GAAIhP,IAAWZ,EAAM,CACnB,IAAMyP,EAA+BpN,gBAAKb,EAAc,CACtD8N,KAAM,wBAGFS,OAC6BhP,IAAjC0O,EACKA,EAA6BlG,QAAQyG,WACtC/P,EAUN,OAR6CqG,eAC3CyJ,GACA,SAACH,EAAQ3J,GAAT,MAAqB,CACnBA,SACA2J,aAON,MAAO,IAuEHrB,SACA0B,OAxDS,WAA2B,IAAD,EACvC,GAAK1B,IAeL,OAXmB,UAAG2B,iBACpB5J,eACE,CAACxG,EAAsBA,IACvB,SAACc,GAAD,MAAyB,CACvBuP,WAAY9B,EAAoBzN,GAChCwP,YAAa9O,EAAMb,QAAQG,OAG/B,sBARiB,aAAG,EASnBuP,aA0BH,SAmBG/O,KAKMiP,GAAmB,WAE9B,OADgBxO,qBAAWmM,KC3ThBsC,GAAepP,wBAAc,IAE7BqP,GAA0B,SAAC,GAAkB,IAAhBnP,EAAe,EAAfA,SACxC,EAAgCQ,IAAxBN,EAAR,EAAQA,MAAOE,EAAf,EAAeA,aACPyF,EAAYU,KAAZV,QACR,EACEoJ,KADMjB,EAAR,EAAQA,0BAA2Bf,EAAnC,EAAmCA,oBAAqBE,EAAxD,EAAwDA,OAAQ0B,EAAhE,EAAgEA,OAG1DO,EAA8B,kBAClC1M,gBAAKtC,EAAc,CACjB8N,KAAM,qBAGJmB,EAAiC,kBACrC3M,gBAAKtC,EAAc,CACjB8N,KAAM,wBAqFV,OACE,cAACgB,GAAa5O,SAAd,CACEC,MAAO,CACL+O,SArFW,kBACfC,gBAAuC,CACrC,CACEpC,EACAqC,oBACE,uBAAMC,MAAO,CAAEC,MAAO,eAAtB,oBACS,uBAAOD,MAAO,CAAEC,MAAO,WAAvB,SAAqCb,MAD9C,gBAMJ,CAACb,EAA2BwB,oBAAS,iCACrC,CACEJ,EACAI,oBAAS,uCAEX,CACEH,EACA,WACE,IAAMM,EAAc1O,gBAAKb,EAAc,CACrC8N,KAAM,uBAGR,OACE,iCACGjB,EAAoB0C,EAAYxH,QAAQvJ,MAD3C,wCAON,CACE,iBAA6B,sBAAvBsB,EAAMlB,cACZwQ,oBAAS,0BAEX,CACE,kBAAM3J,EAAQF,iBACd6J,oBACE,iCACE,uBAAOC,MAAO,CAAEC,MAAO,WAAvB,SACGzC,EAAoB/M,EAAMtB,QAF/B,iCAQJ,CACE,iBAA6B,iBAAvBsB,EAAMlB,cACZwQ,oBACE,iCACE,wBAAOC,MAAO,CAAEC,MAAO,WAAvB,UACGzC,EAAoB/M,EAAMtB,MAAqB,OAFpD,gCAQJ,CACE,kBAAMiH,EAAQD,gBAAR,GAAgCC,EAAQD,gBAAR,GACtC4J,oBACE,iCACE,wBAAOC,MAAO,CAAEC,MAAO,WAAvB,UACGzC,EAAoB/M,EAAMtB,MAAqB,OAFpD,kCASJ,CACE,iBAA6B,iBAAvBsB,EAAMlB,cACZwQ,oBACE,iCACE,uBAAOC,MAAO,CAAEC,MAAO,WAAvB,SACGzC,EAAoB/M,EAAMtB,QACpB,IAHX,iCAvEN2Q,MA+EG5P,KAGH,SAKGK,K,oCCnEQ,O,uFA/Cb,SAAM6K,EAAkB+E,GACtB,OAAOC,KACJC,KAAK9R,EAAU,cAAe,CAC7B6M,WACA+E,aAEDxH,MAAK,SAAA2H,GAKJ,OAJIA,EAASC,KAAKC,aAChBC,aAAaC,QAAQ,OAAQC,KAAKC,UAAUN,EAASC,OAGhDD,EAASC,U,oBAItB,WACEE,aAAaI,WAAW,U,sBAG1B,SAASzF,EAAkB0F,EAAeX,EAAkBY,EAAiBtQ,EAAeuQ,EAAgBC,EAAkBzH,GAC5H,OAAO4G,KAAMC,KAAK9R,EAAU,cAAe,CACzC6M,WACA0F,QACAX,WACAY,UACAtQ,QACAuQ,SACAC,WACAzH,SAEDb,MAAK,SAAA2H,GAKJ,OAJIA,EAASC,KAAKC,aAChBC,aAAaC,QAAQ,OAAQC,KAAKC,UAAUN,EAASC,OAGhDD,EAASC,U,4BAIpB,WACE,IAAMW,EAAUT,aAAaU,QAAQ,QACrC,OAAID,EAAgBP,KAAKS,MAAMF,GAExB,S,MCpCMG,GAZA,CACb5I,GADa,SACV6I,EAAeC,GAChBvM,SAASwM,iBAAiBF,GAAO,SAACG,GAAD,OAAOF,EAASE,OAEnDC,SAJa,SAIJJ,EAAef,GACtBvL,SAAS2M,cAAc,IAAIC,YAAYN,EAAO,CAAEO,OAAQtB,MAE1DuB,OAPa,SAONR,EAAeC,GACpBvM,SAAS+M,oBAAoBT,EAAOC,K,QCL7BS,GACD,UAGCC,GAAQC,IAAOC,IAAV,qMAULC,GAAcF,IAAOC,IAAV,6PAuBXE,IAXSH,IAAOC,IAAV,kNAEUH,IASTE,IAAOC,IAAV,oFA0CJG,IApCmBJ,IAAOC,IAAV,sQAEDH,IAUNE,IAAOC,IAAV,4SAeKH,IAGpB,qBAAGO,YACO,4BACWP,GADX,YAKgBE,IAAOC,IAAV,wFC/EdK,IDqFaN,YAAOO,IAAPP,CAAH,oECrFEA,IAAOC,IAAV,gCAGTO,GAAQR,IAAOS,GAAV,iPAUWX,IAGhBK,GAAOH,IAAOC,IAAV,iDASJS,IALYV,IAAO7Q,EAAV,oEAKA6Q,IAAOW,OAAV,sWAIGb,KAgBTc,GAAiBZ,IAAOC,IAAV,mEAKdY,GAAeb,IAAOc,MAAV,2LCjDZC,GAAUf,IAAOgB,MAAV,2fAUElB,ICoCPmB,GApC2B,SAAC,GAOpC,IANLC,EAMI,EANJA,aACAtS,EAKI,EALJA,MACAuS,EAII,EAJJA,SAII,IAHJC,aAGI,MAHI,QAGJ,MAFJ7E,YAEI,MAFG,OAEH,MADJ8E,mBACI,MADU,GACV,EACJ,EAAwC/S,mBACtC4S,GADF,mBAAOI,EAAP,KAAqBC,EAArB,KAIAlL,qBAAU,WACRkL,EAAgB3S,KACf,CAACA,IAWJ,OACE,cAACmS,GAAD,CACExE,KAAMA,EACNuB,MAAO,CAAEsD,SACTC,YAAaA,EACbzS,MAAO0S,GAAgB,GACvBH,SAfiB,SAAC5B,GACpB,IACmBiC,EACfjC,EADFkC,OAAU7S,MAGZ2S,EAAgBC,GAChBL,EAASK,OC+CEE,GAnE8B,WAC3C,MAAyC1G,KAAjCD,EAAR,EAAQA,eAAgBhF,EAAxB,EAAwBA,aAGtBsE,EAIEtE,EAJFsE,eACAG,EAGEzE,EAHFyE,qBACAD,EAEExE,EAFFwE,eACA7C,EACE3B,EADF2B,kBAUIiK,EArBN,CAsBc5L,EAAawE,eAtBrBlD,UAAUtG,MACd,SAACxB,GAAD,YAAevB,IAAPuB,GAA2B,KAAPA,MAqBgB8K,EAa9C,OACE,eAACiG,GAAD,WACE,cAACE,GAAD,8BACA,eAAC,GAAD,WAUE,cAACI,GAAD,UACE,cAAC,GAAD,CACEQ,MAAM,OACNC,YAAY,WACZH,aAAa,GACbtS,MAAO2L,EAAelD,SACtB8J,SAAU,SAACvS,GAAD,OAxCF,SAACgT,EAA2BhT,GAC5C4L,EAAqB,6BAChBD,GADe,mBAEjBqH,EAAMhT,KAqCoBiT,CAAU,WAAYjT,QAG/C,cAACgS,GAAD,CAAgB9C,MAAO,CAAEgE,cAAe,eAAxC,SACE,cAACpB,GAAD,CACE5C,MAAO,CAAEiE,OAAQ,QACjBC,SAAUL,EACVM,QAAS,kBArCF,WACfvK,GAAkB,GAElB,IAAQL,EAAakD,EAAblD,SAER0D,EAAejC,WAEbzB,GA8BqB6K,IAHjB,SAKG7H,EAAiB,WAAa,yBCtE9B8H,GAAanC,YAAOG,GAAPH,CAAH,kGAMVoC,GAAYpC,IAAOC,IAAV,kHAOToC,GAAcrC,IAAOC,IAAV,gKAOpB,qBAAGqC,YAA2B,yBAGrBC,GAAOvC,IAAOC,IAAV,mRAMKH,IAUT0C,GAAcxC,IAAOyC,QAAV,yKAYXC,GAAY1C,IAAOc,MAAV,uICmFP6B,ID3EM3C,IAAOc,MAAV,2FAMEd,IAAOC,IAAV,6BC5B0B,WACzC,MAA0C3R,wBACxCN,GADF,mBAAO4U,EAAP,KAAuBC,EAAvB,KAGA,EAAyC7H,KAAjCD,EAAR,EAAQA,eAAgBhF,EAAxB,EAAwBA,aACxB,EAAgCzH,mBAAS,IAAzC,mBAAO4K,EAAP,KAAiB4J,EAAjB,KAGEnM,EAOEZ,EAPFY,MACAsD,EAMElE,EANFkE,UACAK,EAKEvE,EALFuE,cAGA1B,GAEE7C,EAJF2E,mBAIE3E,EAHF0E,aAGE1E,EAFF6C,kBACAH,EACE1C,EADF0C,MAGFpC,qBAAU,WAIR,OAHAyM,EAAYC,GAAYC,iBAAiB9J,UACzC6B,EAAe1B,WACfxC,QAAQC,KAAKoC,GACN,WACLnD,EAAaW,SAAS,IACtBX,EAAa6C,kBAAiB,GAC9B7C,EAAa6B,cAAS5J,MAEvB,IAEH,IAcMiV,GACF/J,GAAaoB,EAEX4I,OAAyBlV,IAAVyK,OAAsBzK,EA1DrB,SAACyK,GACvB,IAAQC,EAAuBD,EAAvBC,UAAWlC,EAAYiC,EAAZjC,QAEnB,OAAQkC,GACN,IAAK,uBACH,MAAM,yCAAN,OAAgDlC,EAAQa,UAC1D,IAAK,qBACH,MAAM,sBAAN,OAA6Bb,EAAQa,SAArC,sCACF,QACE,MAAO,uBAiD4C8L,CAAgB1K,GAEvE,OACE,eAAC6H,GAAD,WACE,eAACE,GAAD,+BAAyBvG,EAAY,UAAY,aAAjD,OACA,cAACkI,GAAD,UACE,cAACC,GAAD,UACGzL,EAAMpD,KAAI,SAAC6P,GAAD,OACT,eAACf,GAAD,CAA2BC,WAAYM,IAAmBQ,EAAKC,GAA/D,UACE,cAACd,GAAD,CACEN,QAAS,kBACPY,GAAgB,SAACS,GAAD,OACdA,IAAYF,EAAKC,GAAKD,EAAKC,QAAKrV,MAHtC,SAOE,cAACwU,GAAD,UACE,cAACE,GAAD,UAAYU,EAAKG,WAIpBH,EAAKC,KAAOT,GACX,cAACtC,GAAD,UACE,eAAC,GAAD,WAEG4C,GACC,cAACtC,GAAD,UACE,cAACC,GAAD,UAAeqC,MAGnB,cAACtC,GAAD,CAAgB9C,MAAO,CAAEgE,cAAe,eAAxC,SACE,cAACpB,GAAD,CACE5C,MAAO,CAAEiE,OAAQ,QACjBC,SAAUiB,EACVhB,QAAS,kBA5Cf7K,EA4C4BgM,EAAKC,GA3C/CxM,QAAQC,IAAI,iBAAkBM,GAC9BwB,GAAiB,QAEjBmC,EAAe9B,SAAS7B,EAAQ8B,GAJnB,IAAC9B,GAyCI,SAKGkD,EACG,eADU,oBAEG8I,EAAKG,iBA9BhBH,EAAKC,gBChDpBG,GA1ByB,WACrBC,eAAjB,IACA,EAA8CnV,mBAAS,IAAvD,mBAAOoV,EAAP,KAAwBC,EAAxB,KACA,EAAgDrV,wBAC9CN,GADF,6BASA,OALAqI,qBAAU,WACRsN,EAAmBZ,GAAYC,iBAAiB1L,QAC/C,IAID,cAACyI,GAAD,UACE,cAACG,GAAD,UACE,cAACC,GAAD,UACE,cAACC,GAAD,UACwB,eAApBsD,EACF,cAAC,GAAD,IAAmB,cAAC,GAAD,aC3BzBE,GAAO5D,IAAOC,IAAV,6BAEK4D,GARa,kBAC1B,cAACD,GAAD,UACE,cAAC,GAAD,OCJIE,GAAgDhX,EAA1BmE,GAA0BnE,EAoC3CiX,GAAe/D,IAAOC,IAAV,wNAWd,kBAA4B,MAA5B,EAAGpS,OAA+B,QAAU,WAG1CmW,GAAUhE,IAAOC,IAAV,mZAgBhB,gBAAYgE,EAAZ,EAAGC,MAASD,WAAZ,6BACSA,EAAW7C,MAAQ0C,GAD5B,4BAEUG,EAAW7C,MAAQ0C,GAF7B,gBAgBC,gBAhFgBtT,EAgFb2T,EAAH,EAAGA,kBAAmBC,EAAtB,EAAsBA,cAAtB,OACAD,GACAC,GACAC,YAFA,oJAjFgB7T,EAoFW,CACrBhE,KAAM2X,EAAkB3X,KACxBiE,IAAK0T,EAAkB1T,KAtFgB6T,YAA7B,QAAD,uHAKR9T,EAAehE,KAChBgE,EAAeC,MAkFf0T,EAAkB/R,aAKzB,kBACW,MADX,EAAGvE,OACH,sGAIMkW,GAJN,wMASMA,GATN,oHAcI,qBAAGQ,SAEHF,YADO,oNAlGYC,YAAL,QAAD,iSAyGf,gBAAGE,EAAH,EAAGA,iBAA2BP,EAA9B,EAAqBC,MAASD,WAA9B,OACAO,GAAgB,6DAKdP,EAAW7C,MAAQ0C,GAAuB7S,GAL5B,gBAUhB,qBAAGoP,YAEHgE,YADU,mIA1GYC,YAAL,QAAD,oLCwEPG,GAjF2B,SAAC,GAUpC,I3BrBkCC,E2BYvC7W,EASI,EATJA,OACAwE,EAQI,EARJA,OACAsS,EAOI,EAPJA,WACAC,EAMI,EANJA,cAMI,IALJC,oBAKI,SAJJC,EAII,EAJJA,eAII,IAHJC,gBAGI,aAFJR,eAEI,aADJC,wBACI,SACJ,EAA+C5P,KAAvCV,EAAR,EAAQA,QAASC,EAAjB,EAAiBA,cACI6Q,EADrB,EAAgCrQ,WACxB3B,YACAY,EAAoBM,EAApBN,gBACFqR,G3BzBiCP,E2ByBK,CAC1C,CAAEQ,MAAM,EAAMtW,MAAO,WACrB,CAAEsW,UAAiBlX,IAAXH,EAAsBe,MAAOf,GACrC,CAAEqX,KAAMN,EAAehW,MAAO,mBAC9B,CAAEsW,KAAMH,EAAUnW,MAAO,e3B5B3B2E,IAAIjB,IAAOoS,EAAS,CAAEQ,MAAM,IAAS,SAASC,KAAK,M2B+B7CC,EAAuBJ,EAAsB1V,MACjD,SAAC+V,GAAD,YACwBrX,IAArBqX,EAAUhT,QAAwBgT,EAAUhT,SAAWA,GACvDgT,EAAUzT,gBAAkBiT,GAAgBQ,EAAUxX,SAAWA,KAGhEuW,OAAyCpW,IAAzBoX,GAAsCR,EAwBtDU,EACJd,GACCJ,GAAiB9H,QAAO,OAAC8I,QAAD,IAACA,OAAD,EAACA,EAAsBvT,eAE5C0T,GAAmBD,EAEnBjF,EAAauE,IAAgC,OAAfhR,QAAe,IAAfA,OAAA,EAAAA,EAAiB7F,SAAUsE,EAE/D,OACE,cAAC2R,GAAD,CACEwB,UAAWP,EACXQ,YAAalB,EAjCA,SAAChF,GAChB,GAAIgF,EAAS,CACXhF,EAAEmG,kBAEF,IAAQ9R,EAAoBM,EAApBN,gBACF+R,GACW,OAAf/R,QAAe,IAAfA,OAAA,EAAAA,EAAiB7F,SAAUsE,OACvBrE,EADJ,6BAGS4F,GAHT,IAIM7F,WAAkBC,IAAXqE,EAAuB,YAAcA,IAGzCS,SAASb,cAClB,wBAGCc,QACHoB,EAAc,6BAAKD,GAAN,IAAeN,gBAAiB+R,YAeX3X,EAClCH,OAAQA,EACR8W,WAAYA,EACZP,cAAeA,EACfD,kBAAmBiB,EACnBR,cAAeA,EACfL,QAASA,IAAYH,EACrBI,iBAAkBc,EAClBjF,WAAYA,EAVd,SAYGkF,GACC,cAACxB,GAAD,CAAclW,OAAQA,EAAtB,UACIuW,GAAiBU,OCvFrBc,GACN9Y,EAD0B+Y,GAC1B/Y,EADqDgZ,GACrDhZ,EAgEWiZ,GAAgB/F,IAAOC,IAAV,oFAGtB,gBAAYgE,EAAZ,EAAGC,MAASD,WAAZ,2BACOA,EAAW7C,MAAQ0E,GAAoB7B,EAAW7C,MADzD,0BAEQ6C,EAAWlC,OAFnB,YAMSiE,GAAQhG,IAAOC,IAAV,0HAId,gBAAGiE,EAAH,EAAGA,MAAH,6BACSA,EAAMD,WAAW7C,MAD1B,4BAEU8C,EAAMD,WAAWlC,OAF3B,cAMSkE,GAAUjG,IAAOC,IAAV,wMAOhB,mBAxF2B,SAACiG,EAAYjC,GAC1C,OAAQiC,GACN,IAAK,IACH,MAAM,2DAAN,OAGWjC,EAAW7C,MAAQwE,GAH9B,qGAQF,IAAK,IACH,MAAM,kFAAN,OAIY3B,EAAWlC,OAAS6D,GAJhC,aAMF,IAAK,IACH,MAAM,qFAAN,OAIY3B,EAAWlC,OAAS6D,GAJhC,iBAMF,IAAK,IACH,MAAM,sHAAN,OAKW3B,EAAW7C,MAAQwE,GAL9B,wCAQF,IAAK,SACH,MAAM,2DAAN,OAEqB3B,EAAW7C,MAAQyE,GAFxC,kCAGS5B,EAAWlC,OAAS6D,GAH7B,+BAIW3B,EAAW7C,MAAQyE,GAJ9B,4CAKwB5B,EAAWlC,OAAS6D,GAAqB,EALjE,kIAWF,IAAK,UACH,MAAM,oMAAN,OAOW3B,EAAW7C,MAAQ0E,GAAoB,EAPlD,oGAyCmBK,CAArB,EAAGD,KAAH,EAAShC,MAA+CD,eAG/CmC,GAAsBpG,IAAOC,IAAV,oNAMrB,gBAAGiE,EAAH,EAAGA,MAAH,4BACQA,EAAMD,WAAW7C,MAAQwE,GADjC,gBAEJ1B,EAAMD,WAAW7C,MAAQyE,GAA6B,EAFlD,WAIC,gBAAG3B,EAAH,EAAGA,MAAH,4BACOA,EAAMD,WAAWlC,OAAS6D,GAAqB,EADtD,UAGR,gBAAG1B,EAAH,EAAGA,MAAOgC,EAAV,EAAUA,KAAV,gBACGA,EADH,YACWhC,EAAMD,WAAW7C,MAAQwE,GADpC,SAGK,gBAAG1B,EAAH,EAAGA,MAAH,sBACHA,EAAMD,WAAWlC,OAAS6D,GADvB,cAmBIS,IAZWrG,IAAOC,IAAV,yOAYAD,IAAOC,IAAV,mLAWLqG,GAAOtG,IAAOC,IAAV,4M,qBChJJsG,GAAWvG,IAAOC,IAAV,wNAYjB,gBAAGxT,EAAH,EAAGA,YAAH,MACA,CAAC,EAAG,GAAGkM,SAASlM,IAAhB,4C,yCCZIqX,GAAyBhX,EAoBpB0Z,GAAaxG,IAAOC,IAAV,mMAUVwG,GAAWzG,IAAOC,IAAV,+OAMjB,mBAlC6B,SAACyG,GAChC,IAAMC,EAAc,GAcpB,OAZID,EAASE,KAEXD,EAAOE,gBAAkB,YAGzBF,EAAOE,gBAAkB,YAGvB,CAAC,EAAG,GAAGlO,SAAS+N,EAASja,eAC3Bka,EAAOG,UAAP,kBAGKH,EAmBaI,CAAlB,EAAGL,aAGH,qBAAGM,iBACY,0CAMNC,GAAejH,IAAOC,IAAV,iLASrB,gBAAGxT,EAAH,EAAGA,YAAH,MACA,CAAC,EAAG,GAAGkM,SAASlM,GAAhB,4CAII,MAGKya,GAAiBlH,IAAOC,IAAV,0IAChB,qBAAGiE,MAAkBD,WAAW7C,MAAQ0C,MACvC,qBAAGI,MAAkBD,WAAW7C,MAAQ0C,MC8DrCqD,GA9FuB,SAAC,GAAgC,IAA9BC,EAA6B,EAA7BA,UAAW3a,EAAkB,EAAlBA,YAC1C8B,EAAUM,IAAVN,MACAwM,EAAmBC,KAAnBD,eACAmB,EAAkBoB,KAAlBpB,cAER,EAAmCtH,KAA3BV,EAAR,EAAQA,QAASC,EAAjB,EAAiBA,cACTP,EAAqCM,EAArCN,gBAAiBI,EAAoBE,EAApBF,gBACjB5G,GAA2BmB,GAAS,IAApCnB,uBACFia,EAAkBC,KAAG,OAAC/Y,QAAD,IAACA,OAAD,EAACA,EAAOZ,KAAMyZ,GAEnCG,GAA8B,OAAfF,QAAe,IAAfA,OAAA,EAAAA,EAAiBvZ,QAAS,EAEzC0Z,EAAkC,OAAfH,QAAe,IAAfA,KAAiBzZ,QACtC,GACA0F,KAAMiU,GAAcE,MAAM,EArBL,GAuBnB3C,EACJyC,EAxBuB,EAyBnBA,EAzBmB,EAyBiB,OACpCvZ,EAEA+W,EAA4B,IAAjBwC,EAEXhD,EAAUrI,EAAcmL,EAAgBtZ,MAAOsZ,EAAgBxZ,QAE/D6Z,EAAmB,SAAC/C,GAAD,OACvBG,EACmB6C,IAAfhD,EACAA,IAAe6C,EAAiBnP,OAAS,GAEzCuP,EAAyCtY,KAAKlC,EAAwB,CAC1ET,KAAI,OAAEiH,QAAF,IAAEA,OAAF,EAAEA,EAAiB7F,QAGnB8Z,EAA8BjX,EAClCyW,EAAgBtZ,MAChB6Z,GAmBF,OACE,eAACpB,GAAD,CACEnD,GAAE,iBAAY+D,GAEdnF,QAAS,WACP4F,GApBmB,WACvB,IAAMpO,EAAsB,CAC1B9M,KAAI,OAAEiH,QAAF,IAAEA,OAAF,EAAEA,EAAiB7F,MACvBnB,GAAIya,EAAgBtZ,OAGtBoG,EAAc,6BACTD,GADQ,IAEXN,qBAAiB5F,EACjBgG,iBAAiB,KAGnB+G,EAAevB,aAAaC,GAQOqO,IAEjCC,IAAK,SAACA,GAAD,OAAUhZ,EAAQqY,GAAaW,GANtC,UAQE,cAACtB,GAAD,CACEO,gBAAiBa,EACjBnB,SAAU,CACRE,KAAMQ,EAAY,IAAM,EACxB3a,iBAGJ,eAACwa,GAAD,CAAcxa,YAAaA,EAA3B,UACG+a,EAAiBjU,KAAI,SAACoR,GAAD,OACpB,cAAC,GAAD,CAEEA,WAAYA,EACZG,eACiB6C,IAAfhD,EAAwCG,OAAiB9W,EAE3D4W,cAAe8C,EAAiB/C,GAChCI,SAAUA,EACVR,SACGvQ,GAAmBuQ,GAAWmD,EAAiB/C,GAElDtS,OAAQ+U,EACRvZ,OAAQwZ,EAAgBxZ,QAXnB8W,MAcR,cAACuC,GAAD,CAAgB1B,UAAU,yBA9BxB4B,IClEIY,GAV4B,SAAC,GAAgC,IAA9Bvb,EAA6B,EAA7BA,YAAaC,EAAgB,EAAhBA,UACzD,OACE,cAAC6Z,GAAD,CAAU9Z,YAAaA,EAAvB,SACGwb,KAAMvb,EAAUC,KAAMD,EAAUE,IAAI2G,KAAI,SAAC6T,GAAD,OACvC,cAAC,GAAD,CAAqBA,UAAWA,EAAW3a,YAAaA,GAA9C2a,SClBVc,GAAmBpb,EAErBqb,GAAsB7D,YAAH,kIAWZ8D,GAAMpI,IAAOC,IAAV,yOAWJ,gBAAGiE,EAAH,EAAGA,MAAH,gBAAkBA,EAAMD,WAAWlC,OAASmG,GAA5C,SACH,gBAAGhE,EAAH,EAAGA,MAAH,2BACUA,EAAMD,WAAWlC,OAASmG,GAAkB,EADtD,UAIIG,GAAuBrI,IAAOC,IAAV,sIAQpBqI,GAAatI,IAAOW,OAAV,qmBA6BnB,kBAAM0D,YAAL,QAAD,8FACa8D,OCjEJI,GAAgBvI,IAAOC,IAAV,gMCJbuI,IAA6C,IAAIC,KAC3DC,IAAI,EAAG,CAAC,WACRA,IAAI,EAAG,CAAC,KAAM,OACdA,IAAI,EAAG,CAAC,KAAM,SAAU,OACxBA,IAAI,EAAG,CAAC,KAAM,KAAM,KAAM,OAC1BA,IAAI,EAAG,CAAC,KAAM,KAAM,KAAM,KAAM,WAChCA,IAAI,EAAG,CAAC,KAAM,KAAM,IAAK,KAAM,KAAM,MAqBzBC,GAnBiB,CAC9B,QACA,OACA,SACA,MACA,QACA,QAQgDpV,KAAI,SAACqV,EAAMrQ,GAAP,MAAc,CAClEqQ,OACAC,OAAQL,GAAapM,IAAI7D,EAAI,IAAM,OCpB7B2P,GAA+Cpb,EAA/Bgc,GAA+Bhc,EAApBic,GAAoBjc,EAgB1Ckc,GAAa,SAACC,GAAD,OACxBA,EAAmBlH,OAASmG,GAAiBY,IAElCI,GAAe,SAACD,GAAD,OAC1BD,GAAWC,GAAsBF,IAEtBI,GAAkB,SAACF,GAAD,MAAqC,CAClE7H,MAAO4H,GAAWC,GAClBlH,OAAQiH,GAAWC,KAGfG,GAAuB,SAACjW,GAS5B,OARuC,IAAIsV,KACxCC,IAAI,EAAG,kCACPA,IAAI,EAAG,mCACPA,IAAI,EAAG,gDACPA,IAAI,EAAG,iDACPA,IAAI,EAAG,mCACPA,IAAI,EAAG,oCAEOtM,IAAIjJ,IAAQ,IAgGlBkW,GAAQrJ,IAAOC,IAAV,mJAKd,gBAAGiE,EAAH,EAAGA,MAAH,OAAeiF,GAAgBjF,EAAMD,eAG5BqF,GAAMtJ,IAAOC,IAAV,6JASZ,gBAAGiE,EAAH,EAAGA,MAAH,OAAeiF,GAAgBjF,EAAMD,eACrC,gBAAGpH,EAAH,EAAGA,OAAH,YAA2B7O,IAAX6O,GA/FU,SAACA,GAAD,MAAqB,CACjDiK,UAAWsC,GAAqBvM,IA8FU0M,CAAsB1M,MAE9D,gBAAGuH,EAAH,EAAGA,cAAeD,EAAlB,EAAkBA,kBAAlB,OACAC,GACAD,GACAE,YAFA,oHAlHe,SAAC7Q,GAClB,IAAMgW,EAAgB,IAAMhW,EAAgB6E,OACtCoR,EAAmBlW,IACvBC,GACA,SAACL,EAAKuW,GAAN,sBACEA,EAAUF,EADZ,0BAC2CJ,GAAqBjW,GADhE,aASF,OAJ4BmR,YAAH,uCACrBmF,EAAiBtE,KAAjB,KA2GawE,CAAWxF,EAAkB3Q,iBACtC2Q,EAAkB/R,aAKfwX,GAAU5J,IAAOC,IAAV,wTAahB,gBAAGiE,EAAH,EAAGA,MAAH,OAAeiF,GAAgBjF,EAAMD,eACrC,gBAAG2E,EAAH,EAAGA,KAAM1E,EAAT,EAASA,MAAT,OArHkB,SAAC0E,EAAmBiB,GACxC,OAAQjB,GACN,IAAK,QACH,MAAO,CACL9B,UAAU,iCAAD,OAAmC+C,EAAnC,aAEb,IAAK,OACH,MAAO,CACL/C,UAAU,mCAAD,OAAqC+C,EAArC,aAEb,IAAK,QACH,MAAO,CACL/C,UAAU,kCAAD,OAAoC+C,EAApC,aAEb,IAAK,OACH,MAAO,CACL/C,UAAU,mCAAD,OAAqC+C,EAArC,aAEb,IAAK,MACH,MAAO,CACL/C,UAAU,kCAAD,OAAoC+C,EAApC,aAEb,IAAK,SACH,MAAO,CACL/C,UAAU,mCAAD,OAAqC+C,EAArC,cA6FQC,CAAclB,EAAMI,GAAW9E,EAAMD,gBAGjD8F,GAAQ/J,IAAOC,IAAV,4HAKd,gBAAGiE,EAAH,EAAGA,MAAH,MAAgB,CAChB9C,MAAM,GAAD,OAAK8H,GAAahF,EAAMD,YAAxB,MACLlC,OAAO,GAAD,OAAKmH,GAAahF,EAAMD,YAAxB,UAGN,gBAAGC,EAAH,EAAGA,MAAH,OArGe,SAAC8F,EAAyBC,GAC3C,IAAMC,EAAgBD,EAAY,EAElC,OAAQD,GACN,IAAK,KACH,MAAO,CACLxd,KAAK,GAAD,OAAK0d,EAAL,MACJzZ,IAAI,GAAD,OAAKyZ,EAAL,OAGP,IAAK,KACH,MAAO,CACLrd,MAAM,GAAD,OAAKqd,EAAL,MACLzZ,IAAI,GAAD,OAAKyZ,EAAL,OAEP,IAAK,IACH,MAAO,CACLrd,MAAM,GAAD,OAAKqd,EAAL,MACLzZ,IAAI,cAAD,OAAgByZ,EAAhB,QAEP,IAAK,SACH,MAAO,CACL1d,KAAK,cAAD,OAAgB0d,EAAhB,OACJzZ,IAAI,cAAD,OAAgByZ,EAAhB,QAEP,IAAK,KACH,MAAO,CACLrd,MAAM,GAAD,OAAKqd,EAAL,MACLC,OAAO,GAAD,OAAKD,EAAL,OAGV,IAAK,KACH,MAAO,CACL1d,KAAK,GAAD,OAAK0d,EAAL,MACJC,OAAO,GAAD,OAAKD,EAAL,OAEV,IAAK,IACH,MAAO,CACL1d,KAAK,GAAD,OAAK0d,EAAL,MACJzZ,IAAI,cAAD,OAAgByZ,EAAhB,SA+DPE,CADA,EAAUJ,SACWd,GAAahF,EAAMD,gBCzI7BoG,GApCuB,SAAC,GAAgC,IAA9BxN,EAA6B,EAA7BA,OAAQhP,EAAqB,EAArBA,OAAQqF,EAAa,EAAbA,OAC/CyB,EAAeC,KAAfD,WAEF2V,EAAuBhb,KAAKqF,EAAWD,SAAU,CACrDxB,SACArF,WAGIuW,OAAyCpW,IAAzBsc,EAChBnG,EACHC,GAAkBkG,EAEf,CACElY,SAAUkY,EAAqBlY,SAC/BoB,gBAAiB8W,EAAqB9W,sBAHxCxF,EAMN,OACE,cAACqb,GAAD,UACE,cAACC,GAAD,CACElF,cAAeA,EACfD,kBAAmBA,EACnBtH,OAAQA,EAHV,SAKG8L,GAAYpV,KAAI,SAACgX,GAAD,OACf,cAACX,GAAD,CAA+BhB,KAAM2B,EAAW3B,KAAhD,SACG2B,EAAW1B,OAAOtV,KAAI,SAACyW,GAAD,OACrB,cAACD,GAAD,CAAsBC,SAAUA,GAApBA,OAFFO,EAAW3B,cChBpB4B,GAdiC,SAAC,GAAgB,IAAd3c,EAAa,EAAbA,OAG3C4c,GAAajO,EAFSc,KAApBd,iBAE2B3O,GAEnC,OACE,cAAC0a,GAAD,UACGkC,EAAWlX,KAAI,gBAAGsJ,EAAH,EAAGA,OAAQ3J,EAAX,EAAWA,OAAX,OACd,cAAC,GAAD,CAAkBrF,OAAQA,EAAQgP,OAAQA,EAAQ3J,OAAQA,GAAhDA,SCkCHwX,GAtCuB,SAAC,GAAgB,IAAd7c,EAAa,EAAbA,OACvC,EAAmC+G,KAA3BV,EAAR,EAAQA,QAASC,EAAjB,EAAiBA,cACT4G,EAAmBC,KAAnBD,eACR,EACEuC,KADM3B,EAAR,EAAQA,YAAaI,EAArB,EAAqBA,QAASZ,EAA9B,EAA8BA,SAAUE,EAAxC,EAAwCA,wBAGlCsP,EAAS,SAACC,GACdzW,EAAc,6BACTD,GADQ,IAEXL,aAAa,KAGX+W,EACF7P,EAAe5B,gBAIjB4B,EAAe3B,aAGjB,OACE,cAACgP,GAAD,UACE,eAACC,GAAD,WACGxa,IAAWsN,GAAYY,KACtB,cAACuM,GAAD,CAAYrG,QAAS,kBAAM0I,GAAO,IAAlC,kBAED9c,IAAWsN,GAAYQ,KACtB,cAAC2M,GAAD,CAAYtG,UAAWrG,IAAesG,QAAS,kBAAM0I,GAAO,IAA5D,0BAKDtP,EAAwBxN,IAAW,cAAC,GAAD,CAAeA,OAAQA,UCnD3DiW,GAAyBhX,EAEpBoa,GAAiBlH,IAAOC,IAAV,0IAChB,qBAAGiE,MAAkBD,WAAW7C,MAAQ0C,MACvC,qBAAGI,MACLD,WAAWlC,OAAS+B,GAAuB,QAMxC+G,GAAe7K,IAAOC,IAAV,wJCuDVkH,GA3CuB,SAAC,GAAgB,IAAdtZ,EAAa,EAAbA,OAC/BU,EAAUM,IAAVN,MAEA2N,GADmBlB,KAAnBD,eACkBuC,KAAlBpB,eAIFqL,EAFehZ,EAAbd,SAEsBI,GACxB2Z,EAAmBlU,KAAMiU,GAAcE,MAAM,EAd1B,GAgBnB3C,EACJyC,EAjBuB,EAkBnBA,EAlBmB,EAkBiB,OACpCvZ,EAEAuW,EAAUrI,EAAc,YAAarO,GAErC6Z,EAAmB,SAAC/C,GAAD,OACvBG,EACmB6C,IAAfhD,EACAA,IAAe6C,EAAiBnP,OAAS,GAE/C,OACE,eAACwS,GAAD,CAAc9C,IAAK,SAACA,GAAD,OAAU/Y,EAAanB,GAAUka,GAApD,UACGP,EAAiBjU,KAAI,SAACoR,GAAD,OACpB,cAAC,GAAD,CAEEA,WAAYA,EACZC,cAAe8C,EAAiB/C,GAChCJ,QAASA,EACTlS,OAAO,YACPxE,OAAQA,EACRiX,eACiB6C,IAAfhD,EAAwCG,OAAiB9W,EAE3D6W,cAAc,GATTF,MAYT,cAAC,GAAD,CAAgBa,UAAU,wBC7DxB1B,GAAgDhX,EAA1BmE,GAA0BnE,EAe3Coa,GAAiBlH,IAAOC,IAAV,0IAChB,qBAAGiE,MAAkBD,WAAW7C,MAAQ0C,MACvC,qBAAGI,MACLD,WAAWlC,OACjB+B,GACA,KACA7S,MAMS6Z,GAAmB9K,IAAOC,IAAV,snBA0BhB8K,GAAQ/K,IAAOC,IAAV,wTAgBd,qBAAG+G,iBACY,6FAMf,mBA1EuB,SAACgE,GAAD,MACX,MAAdA,EACI,CACElJ,cAAe,SACfmJ,oBAAqB,MACrBC,qBAAsB,OAExB,CACEpJ,cAAe,iBACfqJ,uBAAwB,MACxBC,wBAAyB,OAgEVC,CAAnB,EAAGL,cCiBQM,GA/D2B,SAAC,GAAgB,IAAdzd,EAAa,EAAbA,OACnCU,EAAUM,IAAVN,MACAwM,EAAmBC,KAAnBD,eAER,EAAmCnG,KAA3BV,EAAR,EAAQA,QAASC,EAAjB,EAAiBA,cAGXoT,EAFchZ,EAAZb,QAEqBG,GACvB2Z,EAAmBlU,KAAMiU,GAEzBlV,EAAoB,MAAXxE,GAAkB,EAAI,GAC/B0d,EAA+B,MAAX1d,EAAiB,IAAM,IACzC+F,EAAoBM,EAApBN,gBACAxG,GAA2BmB,GAAS,IAApCnB,uBAEFwa,EAAyCtY,KAAKlC,EAAwB,CAC1ET,KAAI,OAAEiH,QAAF,IAAEA,OAAF,EAAEA,EAAiB7F,QAGnB8Z,EAA8BjX,EAClCyB,EACAuV,GAiBF,OACE,cAACkD,GAAD,CAAkB/C,IAAK,SAACA,GAAD,OAAU9Y,EAAYpB,GAAUka,GAAvD,SACE,eAACgD,GAAD,CACEC,UAAWO,EACXvE,gBAAiBa,EACjB5F,QAAS,kBAAM4F,GAnBI,WACvB,IAAMpO,EAAsB,CAC1B9M,KAAI,OAAEiH,QAAF,IAAEA,OAAF,EAAEA,EAAiB7F,MACvBnB,GAAIyF,GAGN8B,EAAc,6BACTD,GADQ,IAEXN,qBAAiB5F,KAGnB+M,EAAevB,aAAaC,GAQsBqO,IAHhD,UAKGN,EAAiBjU,KAAI,SAACoR,GAAD,OACpB,cAAC,GAAD,CAEEA,WAAYA,EACZC,eAAe,EACfL,SAAS,EACTlS,OAAQA,EACRxE,OAAQA,EACRiX,oBAAgB9W,EAChBwW,kBAAkB,GAPbG,MAUT,cAAC,GAAD,CAAgBa,UAAU,0BpCxF9BgG,GAAY,CAAC,QAAS,WAE1B,SAASC,KAA2Q,OAA9PA,GAAWC,OAAOC,QAAU,SAAUlK,GAAU,IAAK,IAAIlJ,EAAI,EAAGA,EAAIqT,UAAUvT,OAAQE,IAAK,CAAE,IAAIsT,EAASD,UAAUrT,GAAI,IAAK,IAAIqJ,KAAOiK,EAAcH,OAAOI,UAAUC,eAAeC,KAAKH,EAAQjK,KAAQH,EAAOG,GAAOiK,EAAOjK,IAAY,OAAOH,GAAkBgK,GAASQ,MAAMC,KAAMN,WAEhT,SAASO,GAAyBN,EAAQO,GAAY,GAAc,MAAVP,EAAgB,MAAO,GAAI,IAAkEjK,EAAKrJ,EAAnEkJ,EAEzF,SAAuCoK,EAAQO,GAAY,GAAc,MAAVP,EAAgB,MAAO,GAAI,IAA2DjK,EAAKrJ,EAA5DkJ,EAAS,GAAQ4K,EAAaX,OAAOY,KAAKT,GAAqB,IAAKtT,EAAI,EAAGA,EAAI8T,EAAWhU,OAAQE,IAAOqJ,EAAMyK,EAAW9T,GAAQ6T,EAASG,QAAQ3K,IAAQ,IAAaH,EAAOG,GAAOiK,EAAOjK,IAAQ,OAAOH,EAFxM+K,CAA8BX,EAAQO,GAAuB,GAAIV,OAAOe,sBAAuB,CAAE,IAAIC,EAAmBhB,OAAOe,sBAAsBZ,GAAS,IAAKtT,EAAI,EAAGA,EAAImU,EAAiBrU,OAAQE,IAAOqJ,EAAM8K,EAAiBnU,GAAQ6T,EAASG,QAAQ3K,IAAQ,GAAkB8J,OAAOI,UAAUa,qBAAqBX,KAAKH,EAAQjK,KAAgBH,EAAOG,GAAOiK,EAAOjK,IAAU,OAAOH,EAMne,SAASmL,GAASC,EAAMC,GACtB,IAAIC,EAAQF,EAAKE,MACbC,EAAUH,EAAKG,QACfC,EAAQd,GAAyBU,EAAMrB,IAE3C,OAAoB,gBAAoB,MAAOC,GAAS,CACtDyB,MAAO,6BACPnL,OAAQ,GACRoL,QAAS,YACT/L,MAAO,GACP2G,IAAK+E,EACL,kBAAmBE,GAClBC,GAAQF,EAAqB,gBAAoB,QAAS,CAC3D1J,GAAI2J,GACHD,GAAS,KAAM/X,KAAUA,GAAqB,gBAAoB,OAAQ,CAC3EoY,EAAG,gBACHC,KAAM,UACHpY,KAAWA,GAAsB,gBAAoB,OAAQ,CAChEqY,OAAQ,eACRD,KAAM,eACND,EAAG,wDAIP,IqCpCI,GAAO,GrCoCPG,GAA0B,aAAiBX,IqClC3C,IrCmCW,IqCnCC,CAAC,QAAS,YAE1B,SAAS,KAA2Q,OAA9P,GAAWlB,OAAOC,QAAU,SAAUlK,GAAU,IAAK,IAAIlJ,EAAI,EAAGA,EAAIqT,UAAUvT,OAAQE,IAAK,CAAE,IAAIsT,EAASD,UAAUrT,GAAI,IAAK,IAAIqJ,KAAOiK,EAAcH,OAAOI,UAAUC,eAAeC,KAAKH,EAAQjK,KAAQH,EAAOG,GAAOiK,EAAOjK,IAAY,OAAOH,GAAkB,GAASwK,MAAMC,KAAMN,WAEhT,SAAS,GAAyBC,EAAQO,GAAY,GAAc,MAAVP,EAAgB,MAAO,GAAI,IAAkEjK,EAAKrJ,EAAnEkJ,EAEzF,SAAuCoK,EAAQO,GAAY,GAAc,MAAVP,EAAgB,MAAO,GAAI,IAA2DjK,EAAKrJ,EAA5DkJ,EAAS,GAAQ4K,EAAaX,OAAOY,KAAKT,GAAqB,IAAKtT,EAAI,EAAGA,EAAI8T,EAAWhU,OAAQE,IAAOqJ,EAAMyK,EAAW9T,GAAQ6T,EAASG,QAAQ3K,IAAQ,IAAaH,EAAOG,GAAOiK,EAAOjK,IAAQ,OAAOH,EAFxM,CAA8BoK,EAAQO,GAAuB,GAAIV,OAAOe,sBAAuB,CAAE,IAAIC,EAAmBhB,OAAOe,sBAAsBZ,GAAS,IAAKtT,EAAI,EAAGA,EAAImU,EAAiBrU,OAAQE,IAAOqJ,EAAM8K,EAAiBnU,GAAQ6T,EAASG,QAAQ3K,IAAQ,GAAkB8J,OAAOI,UAAUa,qBAAqBX,KAAKH,EAAQjK,KAAgBH,EAAOG,GAAOiK,EAAOjK,IAAU,OAAOH,EAMne,SAAS+L,GAAQX,EAAMC,GACrB,IAAIC,EAAQF,EAAKE,MACbC,EAAUH,EAAKG,QACfC,EAAQ,GAAyBJ,EAAM,IAE3C,OAAoB,gBAAoB,MAAO,GAAS,CACtDK,MAAO,6BACPnL,OAAQ,OACRoL,QAAS,YACT/L,MAAO,OACPiM,KAAM,UACNtF,IAAK+E,EACL,kBAAmBE,GAClBC,GAAQF,EAAqB,gBAAoB,QAAS,CAC3D1J,GAAI2J,GACHD,GAAS,KAAM,KAAU,GAAqB,gBAAoB,OAAQ,CAC3EK,EAAG,gBACHC,KAAM,UACH,KAAW,GAAsB,gBAAoB,OAAQ,CAChEC,OAAQ,eACRD,KAAM,eACND,EAAG,qJAIP,I,yDAAI,GAA0B,aAAiBI,IC1BlCC,ID2BE,IC3BWzN,IAAOC,IAAV,wTAeVyN,GAAc1N,IAAOC,IAAV,6YAepB,qBAAG0N,YACO,uEAOR,qBAAGA,YACH,2EAQOC,GAAY5N,YAAO6N,GAAP7N,CAAH,qDACX,kBAAsC,SAAtC,EAAG8N,YAA4C,OAAS,YAtD7C,wDA0DTC,GAAW/N,YAAOgO,GAAPhO,CAAH,qDACV,kBAAsC,SAAtC,EAAG8N,YAA4C,OAAS,YA3D7C,wDC2DPG,GA9C8B,WAC3C,MAAmCrZ,KAA3BV,EAAR,EAAQA,QAASC,EAAjB,EAAiBA,cACT4G,EAAmBC,KAAnBD,eACR,EAAoCuC,KAA5BrB,EAAR,EAAQA,eAAgBD,EAAxB,EAAwBA,QAoBlBkS,GAAkBlS,IAClBmS,GAAqBlS,IAE3B,OACE,eAACwR,GAAD,WACE,cAACC,GAAD,CACEX,MAAM,OACNY,WAAYO,EACZjM,QAAS,kBAfFnP,SAASb,cAAc,mBAC/Bc,QAEHoB,EAAc,6BAAKD,GAAN,IAAeJ,aAAa,UACzCiH,EAAepB,QAQb,SAKE,cAACoU,GAAD,CAAUD,YAAaM,OAAOF,OAEhC,cAACR,GAAD,CACEX,MAAM,UACNY,WAAYQ,EACZlM,QAAS,kBAhCFnP,SAASb,cAClB,sBAECc,QAEHoB,EAAc,6BAAKD,GAAN,IAAeH,gBAAgB,UAC5CgH,EAAerB,eAuBb,SAKE,cAACkU,GAAD,CAAWE,YAAaM,OAAOD,WCjCjCE,GAAwB,CAAC,IAAK,IAAK,IAAK,IAAK,UA2DpCC,GAzDyB,WACtC,MAA6BhR,KAArBlC,EAAR,EAAQA,SAAUI,EAAlB,EAAkBA,OASlB,OAPAnF,qBAAU,WACJmF,KACS1I,SAASb,cAAc,aAC/Bc,UAEJ,CAACyI,MAGF,eAACwK,GAAD,WACE,eAACD,GAAD,WACGsI,GAAc9a,KAAI,SAAC2S,GAAD,OACjB,cAACD,GAAD,CAAoBC,KAAMA,EAA1B,SACY,WAATA,GACC,qCACE,cAAC,GAAD,CAAUrY,OAAO,MAChBuN,GAAY,cAAC,GAAD,IACb,cAAC,GAAD,CAAUvN,OAAO,UALTqY,MAUhB,cAACG,GAAD,UACE,cAACC,GAAD,MAEF,eAACF,GAAD,CAAqBF,KAAK,OAA1B,UACG3Z,EAAiBC,KAAK+G,KAAI,SAACgb,GAAD,OACzB,cAAC,GAAD,CAEE9hB,YAAa8hB,EAAO9hB,YACpBC,UAAW6hB,EAAO7hB,WAFb6hB,EAAO9hB,gBAKhB,cAAC,GAAD,CAAKoB,OAAO,SAEd,eAACuY,GAAD,CAAqBF,KAAK,QAA1B,UACG3Z,EAAiBM,MAAM0G,KAAI,SAACgb,GAAD,OAC1B,cAAC,GAAD,CAEE9hB,YAAa8hB,EAAO9hB,YACpBC,UAAW6hB,EAAO7hB,WAFb6hB,EAAO9hB,gBAKhB,cAAC,GAAD,CAAKoB,OAAO,YAGhB,eAACoY,GAAD,CAASC,KAAK,UAAd,UACE,cAAC,GAAD,CAASrY,OAAO,MAChB,cAAC,GAAD,CAASA,OAAO,aCzDX2gB,GAAaxO,IAAOC,IAAV,qPAYVwO,GAAiBzO,IAAOC,IAAV,0HAMdyO,GAAQ1O,IAAOC,IAAV,6SAcL0O,GAAgB3O,IAAOC,IAAV,kWAgBb2O,GAAa5O,IAAOC,IAAV,uQAgBV4O,GAAU7O,IAAOC,IAAV,wJASP6O,GAAQ9O,IAAOC,IAAV,8xCAlFSqE,YAAL,QAAD,0FAkJRyK,GAAU/O,IAAOC,IAAV,mRA3JDqE,YAAL,QAAD,kHAuKA0K,GAAehP,IAAOC,IAAV,4HChCVgP,GA3G8B,WAE3C,IAAMvZ,EAAUC,eAERgI,EnC2FQ7O,qBAAWyO,ImC3FnBI,SACR,EAAuD3C,KAA/CpF,EAAR,EAAQA,aAAcG,EAAtB,EAAsBA,aAAcgF,EAApC,EAAoCA,eACpC,EACEuC,KADM7B,EAAR,EAAQA,oBAAqBC,EAA7B,EAA6BA,4BAGrB3D,EAAsChC,EAAtCgC,kCAEFmX,EAA4C,YAAxBtZ,EAAa4B,OAE/BA,EAAsD5B,EAAtD4B,OAAQD,EAA8C3B,EAA9C2B,aAAcI,EAAgC/B,EAAhC+B,cAAeL,EAAiB1B,EAAjB0B,KAAMF,EAAWxB,EAAXwB,OAkCnD,OAZAf,qBAAU,WAKR,YAJ8BrI,IAA1B4H,EAAayB,WACfvE,SAASia,MAAT,qBAA+BnX,EAAayB,WAGvC,WACLvE,SAASia,MAAQ,gBAElB,CAACnX,EAAayB,WAKf,eAACmX,GAAD,YACIU,GACA,eAACP,GAAD,WACE,qEACA,cAACI,GAAD,OAGHG,GACC,qCACE,eAACR,GAAD,WACE,eAACE,GAAD,CAAY9Q,MAAO,CAAEqR,YAAa,qBAAlC,UACE,cAAC,GAAD,CACEvK,eAAe,EACfD,WAAY,EACZ9W,OAAO,IACP0W,SAAS,EACTQ,UAAU,EACVD,oBAAgB9W,IAElB,gCAAQuJ,OAEV,cAACsX,GAAD,UAAUlR,MACV,eAACiR,GAAD,CAAY9Q,MAAO,CAAEsR,WAAY,qBAAjC,UACE,cAAC,GAAD,CACExK,eAAe,EACfD,WAAY,EACZ9W,OAAO,IACP0W,SAAS,EACTQ,UAAU,EACVD,oBAAgB9W,IAElB,gCAAQ2J,UAIZ,cAAC8W,GAAD,UACE,cAAC,GAAD,MAEDhT,KACC,cAACiF,GAAD,CAAQuB,QAxEM,WACtBlK,GAAkC,GAClCgD,EAAenB,yBAsEP,gCAED8B,KACC,eAACoT,GAAD,WACE,gEACA,sBAAKtJ,UAAU,UAAf,UACE,cAAC9E,GAAD,CAAQuB,QAzEY,WAChClH,EAAelB,2BAwEH,oBACA,cAAC6G,GAAD,CAAQuB,QAtEa,WACjClH,EAAejB,4BAqEH,8BAMV,cAACkV,GAAD,UACE,qBAAKK,IAAO,iBAAkBpN,QAzEb,WACrBpL,QAAQC,IAAI,sDACZiE,EAAehB,aAAavC,EAAQJ,EAASE,EAAOC,EAAeI,GACnEjC,EAAQmC,KAAK,kBCjDX+L,GAAO5D,IAAOC,IAAV,6BAEKqP,GARkB,kBAC/B,cAAC,GAAD,UACE,cAAC,GAAD,O,kBCGEC,GAASvP,IAAOC,IAAV,wMAuGGuP,GA5FgB,SAAC,GAAiB,IAAf9Z,EAAc,EAAdA,QAChC,EAA8BpH,oBAAkB,GAAhD,mBAAOmhB,EAAP,KAAgBC,EAAhB,KACA,EAA8BphB,mBAAiB,IAA/C,mBAAOqhB,EAAP,KAAgBC,EAAhB,KAQMC,EAAmBC,OAAaC,MAAM,CAC1C7W,SAAU4W,OAAaE,SAAS,2BAChC/R,SAAU6R,OAAaE,SAAS,6BAuBlC,OACE,cAACT,GAAD,UAEE,qBAAK/J,UAAU,YAAf,SACE,sBAAKA,UAAU,sBAAf,UACE,qBACE6J,IAAI,8CACJY,IAAI,cACJzK,UAAU,qBAEZ,cAAC,KAAD,CACE0K,cAxCN,CACFhX,SAAU,GACV+E,SAAU,IAuCF4R,iBAAkBA,EAClBM,SAlCU,SAACC,GACnB,IAAQlX,EAAuBkX,EAAvBlX,SAAU+E,EAAamS,EAAbnS,SAClB2R,EAAW,IACXF,GAAW,GACX3M,GAAYsN,MAAMnX,EAAU+E,GAAUxH,MACpC,WACEf,EAAQmC,KAAK,SACb/C,OAAOC,SAASub,YAElB,SAAC7X,GACC,IAAM8X,EACH9X,EAAM2F,UACL3F,EAAM2F,SAASC,MACf5F,EAAM2F,SAASC,KAAKsR,SACtBlX,EAAMkX,SACNlX,EAAM9I,WACR+f,GAAW,GACXE,EAAWW,OAcT,SAKE,eAAC,KAAD,WACE,sBAAK/K,UAAU,aAAf,UACE,uBAAOgL,QAAQ,WAAf,sBACA,cAAC,KAAD,CAAOjN,KAAK,WAAWhH,KAAK,OAAOiJ,UAAU,iBAC7C,cAAC,KAAD,CACEjC,KAAK,WACLkN,UAAU,MACVjL,UAAU,0BAGd,sBAAKA,UAAU,aAAf,UACE,uBAAOgL,QAAQ,WAAf,sBACA,cAAC,KAAD,CAAOjN,KAAK,WAAWhH,KAAK,WAAWiJ,UAAU,iBACjD,cAAC,KAAD,CACEjC,KAAK,WACLkN,UAAU,MACVjL,UAAU,0BAGd,qBAAKA,UAAU,aAAf,SACE,yBAAQjJ,KAAK,SAASiJ,UAAU,4BAA4BxD,SAAUyN,EAAtE,UACGA,GACC,sBAAMjK,UAAU,qCAElB,8CAGHmK,GACC,qBAAKnK,UAAU,aAAf,SACE,qBAAKA,UAAU,qBAAqBlO,KAAK,QAAzC,SACGqY,mBCxFfJ,GAASvP,IAAOC,IAAV,0LAwOGyQ,GA9NY,WACzB,IAAMhb,EAAUC,eAChB,EAAoCrH,oBAAkB,GAAtD,mBAAOqiB,EAAP,KAAmBC,EAAnB,KACA,EAA8BtiB,mBAAiB,IAA/C,mBAAOqhB,EAAP,KAAgBC,EAAhB,KACA,EAAkCthB,oBAAS,GAA3C,mBAAOuiB,EAAP,KAAkBC,EAAlB,KACA,EAAwCxiB,mBAAS,4BAAjD,mBAAOyiB,EAAP,KAAqBC,EAArB,KAUMnB,EAAmBC,OAAaC,MAAM,CAC1C7W,SAAU4W,OACPmB,KACC,MACA,qDACA,SAACC,GAAD,OACEA,GACAA,EAAIvhB,WAAW0I,QAAU,GACzB6Y,EAAIvhB,WAAW0I,QAAU,MAE5B2X,SAAS,2BACZpR,MAAOkR,OACJlR,MAAM,8BACNoR,SAAS,2BACZ/R,SAAU6R,OACPmB,KACC,MACA,qDACA,SAACC,GAAD,OACEA,GACAA,EAAIvhB,WAAW0I,QAAU,GACzB6Y,EAAIvhB,WAAW0I,QAAU,MAE5B2X,SAAS,6BA0Cd,OACE,cAAC,GAAD,UACE,qBAAKxK,UAAU,YAAf,SACE,sBAAKA,UAAU,sBAAf,UACE,qBACE6J,IAAI,8CACJY,IAAI,cACJzK,UAAU,qBAEZ,cAAC,KAAD,CACE0K,cApFmB,CAC3BhX,SAAU,GACV0F,MAAO,GACPX,SAAU,GACVY,QAAS,2BACTtQ,MAAM,WACNuQ,OAAQ,OACRC,SAAU,IA8EF8Q,iBAAkBA,EAClBM,SApDa,SAACC,GACtB,IAAQlX,EAAuDkX,EAAvDlX,SAAU0F,EAA6CwR,EAA7CxR,MAAOX,EAAsCmS,EAAtCnS,SAAU1P,EAA4B6hB,EAA5B7hB,MAAOuQ,EAAqBsR,EAArBtR,OAAQC,EAAaqR,EAAbrR,SAClDlI,QAAQC,IAAIvI,GACZ,IAAMsQ,EAAUkS,EACZzZ,EAAO,OACM,oBAAb4B,IACF5B,EAAO,QACPT,QAAQC,IAAIQ,IAGdyL,GAAYoO,SAASjY,EAAW0F,EAAQX,EAAWY,EAAUtQ,EAAQuQ,EAASC,EAAWzH,GAAMb,MAC7F,SAAC2H,GACCwR,EAAWxR,EAASuR,SACpBiB,GAAc,GACdlb,EAAQmC,KAAK,SACb/C,OAAOC,SAASub,YAElB,SAAC7X,GACC,IAAM8X,EACH9X,EAAM2F,UACL3F,EAAM2F,SAASC,MACf5F,EAAM2F,SAASC,KAAKsR,SACtBlX,EAAMkX,SACNlX,EAAM9I,WACRigB,EAAWW,GACXK,GAAc,OAwBZ,SAKE,eAAC,KAAD,YACID,GACA,gCACE,sBAAKnL,UAAU,aAAf,UACE,uBAAOgL,QAAQ,WAAf,wBACA,cAAC,KAAD,CAAOjN,KAAK,WAAWhH,KAAK,OAAOiJ,UAAU,iBAC7C,cAAC,KAAD,CACEjC,KAAK,WACLkN,UAAU,MACVjL,UAAU,0BAGd,sBAAKA,UAAU,aAAf,UACE,uBAAOgL,QAAQ,QAAf,qBACA,cAAC,KAAD,CAAOjN,KAAK,QAAQhH,KAAK,QAAQiJ,UAAU,iBAC3C,cAAC,KAAD,CACEjC,KAAK,QACLkN,UAAU,MACVjL,UAAU,0BAGd,sBAAKA,UAAU,aAAf,UACE,uBAAOgL,QAAQ,WAAf,wBACA,cAAC,KAAD,CACEjN,KAAK,WACLhH,KAAK,WACLiJ,UAAU,iBAEZ,cAAC,KAAD,CACEjC,KAAK,WACLkN,UAAU,MACVjL,UAAU,0BAId,sBAAKA,UAAU,aAAf,UACE,uBAAOgL,QAAQ,UAAf,uBACA,eAAC,KAAD,CACEjN,KAAK,UACL6N,GAAG,SACH5L,UAAU,eACV5W,MAAOmiB,EACP5P,SAjEE,SAAC/B,GACrBvI,QAAQC,IAAIsI,EAAMiS,cAAcziB,OAChCoiB,EAAgB5R,EAAMiS,cAAcziB,OACH,6BAA9BwQ,EAAMiS,cAAcziB,MACrBkiB,GAAa,GAEVA,GAAa,IAsDF,UAOE,wBAAQliB,MAAM,2BAAd,sCACA,wBAAQA,MAAM,iBAAd,4BACA,wBAAQA,MAAM,QAAd,mBACA,wBAAQA,MAAM,SAAd,oBACA,wBAAQA,MAAM,SAAd,oBACA,wBAAQA,MAAM,UAAd,wBAEF,cAAC,KAAD,CACE2U,KAAK,UACLkN,UAAU,MACVjL,UAAU,0BAIbqL,EACD,sBAAKrL,UAAU,aAAf,UACE,uBAAOgL,QAAQ,QAAf,qBACA,eAAC,KAAD,CACEjN,KAAK,QACL6N,GAAG,SACH5L,UAAU,eAHZ,UAKE,wBAAQ5W,MAAM,WAAd,sBACA,wBAAQA,MAAM,UAAd,qBACA,wBAAQA,MAAM,aAAd,wBACA,wBAAQA,MAAM,SAAd,uBAEF,cAAC,KAAD,CACE2U,KAAK,UACLkN,UAAU,MACVjL,UAAU,0BAGd,KAEA,sBAAKA,UAAU,aAAf,UACE,uBAAOgL,QAAQ,SAAf,sBACA,eAAC,KAAD,CAAOY,GAAG,SAAS7N,KAAK,SAASiC,UAAU,eAA3C,UACE,wBAAQ5W,MAAM,OAAd,kBACA,wBAAQA,MAAM,SAAd,uBAEF,cAAC,KAAD,CACE2U,KAAK,SACLkN,UAAU,MACVjL,UAAU,0BAGd,sBAAKA,UAAU,aAAf,UACE,uBAAOgL,QAAQ,WAAf,wBACA,cAAC,KAAD,CACEjN,KAAK,WACLhH,KAAK,OACLiJ,UAAU,iBAEZ,cAAC,KAAD,CACEjC,KAAK,WACLkN,UAAU,MACVjL,UAAU,0BAGd,qBAAKA,UAAU,aAAf,SACE,wBAAQjJ,KAAK,SAASiJ,UAAU,4BAAhC,0BAILmK,GACC,qBAAKnK,UAAU,aAAf,SACE,qBACEA,UACEmL,EAAa,sBAAwB,qBAEvCrZ,KAAK,QAJP,SAMGqY,mB,OC7MrB,IAAM/L,GAAO5D,IAAOC,IAAV,yLAWKqR,GApCf,WACI,MAA8BhjB,qBAA9B,mBAeA,OAfA,UAiBI,cAAC,GAAD,UACI,wBAAQkX,UAAU,YAAlB,SACI,oBAAIA,UAAY,uBAAhB,wCCGD+L,GA1BW,WACxB,IAAMC,EAAczO,GAAYC,iBAChC,OACE,sBAAKwC,UAAU,YAAf,UACE,wBAAQA,UAAU,YAAlB,SACE,+BACE,iCAASgM,EAAYtY,WADvB,gBAIF,8BACE,4CADF,IAC2BsY,EAAYlT,YAAYmT,UAAU,EAAG,IADhE,OACyE,IACtED,EAAYlT,YAAY1O,OAAO4hB,EAAYlT,YAAYjG,OAAS,OAEnE,8BACE,yCADF,IACwBmZ,EAAYnO,MAEpC,8BACE,4CADF,IAC2BmO,EAAY5S,SAEvC,gDACA,6BACG4S,EAAYla,W,kBCjBJ,SAASoa,KAKtB,IACE,IAAMC,EAAWpT,aAAaU,QAAQ,QAEtC,GAAwB,kBAAb0S,EAAuB,MAAM,IAAIC,MAAM,uBAGlD,IAAOtT,EAAeG,KAAKS,MAAMyS,GAA1BrT,YAGP,KAA6B,kBAAhBA,GAA4BA,EAAYjG,QAXhC,GAYnB,MAAM,IAAIuZ,MAAM,6BAOlB,MAAO,CAAC,iBAAkBtT,GAE5B,SAEE,MAAO,I,OCKE,O,kGAxBb,WACE,OAAOJ,KAAM9B,IAAI/P,EAAU,S,0BAG7B,WACE,OAAO6R,KAAM9B,IAAI/P,EAAU,OAAQ,CAAEwlB,QAASH,S,2BAGhD,WACE,OAAOxT,KAAM9B,IAAI/P,EAAU,QAAS,CAAEwlB,QAASH,S,yBAGjD,WACE,OAAOxT,KAAM9B,IAAI/P,EAAU,QAAS,CAAEwlB,QAASH,S,wBAGjD,SAAWI,GACT,IAAIzT,EAAO,CACTyT,WAAYA,GAEd,OAAO5T,KAAMC,KAAK9R,EAAU,SAAUgS,EAAM,CAAEwT,QAASH,W,MCtBtCK,G,oDACnB,WAAY9E,GAAe,IAAD,+BACxB,cAAMA,IAED1e,MAAQ,CACXyjB,QAAS,IAJa,E,sDAQ1B,WAAqB,IAAD,OAClBC,GAAYC,eAAezb,MACzB,SAAA2H,GACE,EAAK+T,SAAS,CACZH,QAAS5T,EAASC,UAGtB,SAAA5F,GACE,EAAK0Z,SAAS,CACZH,QACGvZ,EAAM2F,UACL3F,EAAM2F,SAASC,MACf5F,EAAM2F,SAASC,KAAKsR,SACtBlX,EAAMkX,SACNlX,EAAM9I,aAGN8I,EAAM2F,UAAsC,MAA1B3F,EAAM2F,SAAS5G,QACnC4a,GAAS5S,SAAS,e,oBAM1B,WACE,OACE,qBAAKgG,UAAU,YAAf,SACE,wBAAQA,UAAU,YAAlB,SACE,6BAAK0G,KAAK3d,MAAMyjB,kB,GArCaK,aCAjC9C,GAASvP,IAAOC,IAAV,6jBAiGGqS,I,GAAAA,GA9Df,WACE,MAAyCtX,KAAjCD,EAAR,EAAQA,eAGN/D,EAHF,EAAwBjB,aAGtBiB,SAGFX,qBAAU,WACR0E,EAAezB,gBACd,IAGH,IAAMwY,EAAa,SAAC1S,GAClBvI,QAAQC,IAAIsI,EAAMiS,cAAcziB,OAChCmM,EAAe/B,WAAWoG,EAAMiS,cAAcziB,QAShD,OACE,cAAC,GAAD,UACE,kCACE,gCACE,+BACE,yCACA,2CACA,4CACA,8CACA,+CACA,sDACA,uDACA,6CAGJ,gCAEGoI,EAASzD,KAAI,SAACgf,EAAMha,GAAP,OACZ,+BACE,+BAAQA,IACR,6BAAMga,EAAKhP,OACX,8BA3BUiP,EA2BSja,EA1BxBvB,EAASwb,EAAE,GAAGjb,aACXP,EAASwb,EAAE,GAAGjb,eAAkBP,EAASwb,EAAE,GAAG7a,cAAuB,EACjE,EAF6B,KA2B/B,6BAAM4a,EAAKhb,eACX,6BAAMgb,EAAK5a,gBACX,6BAAM4a,EAAKE,cACX,6BAAMF,EAAKG,eACX,6BACE,wBAAQ9jB,MAAO2jB,EAAKlP,GAAIpB,QAAS6P,EAAjC,wBATOvZ,GAxBA,IAACia,aCxDlBjD,GAASvP,IAAOC,IAAV,6jBAsJG0S,IC3DAC,GA3EA,CACb,CACEvP,GAAI,YACJwP,KAAM,IACNpC,UAAWa,GACXwB,SAAS,GAEX,CACEzP,GAAI,QACJwP,KAAM,SACNpC,UAAWjB,GACXsD,SAAS,GAEX,CACEzP,GAAI,WACJwP,KAAM,YACNpC,UAAWC,GACXoC,SAAS,GAEX,CACEzP,GAAI,UACJwP,KAAM,WACNpC,UAAWc,GACXuB,SAAS,GAEX,CACEzP,GAAI,YACJwP,KAAM,aACNpC,UAAWsB,GACXe,SAAS,GAEX,CACEzP,GAAI,WACJwP,KAAM,cACNpC,UAAW6B,GACXQ,SAAS,GAEX,CACEzP,GAAI,WACJwP,KAAM,SACNpC,UDpBJ,WAEE,MAA4BniB,mBAAqB,IAAjD,mBAAQykB,EAAR,KAAeC,EAAf,KACA,EAA4B1kB,mBAAS,IAArC,mBAAesJ,GAAf,WAGAvB,qBAAU,WAER4c,GAAY1Z,cAAc9C,MACtB,SAAA2H,GACIvH,QAAQC,IAAIsH,EAASC,MACrB2U,EAAS5U,EAASC,SAEtB,SAAA5F,GACQb,EAEKa,EAAM2F,UACH3F,EAAM2F,SAASC,MACf5F,EAAM2F,SAASC,KAAKsR,SACpBlX,EAAMkX,SACNlX,EAAM9I,YAId8I,EAAM2F,UAAsC,MAA1B3F,EAAM2F,SAAS5G,QACnC4a,GAAS5S,SAAS,eAI3B,IACH,IAAMsS,EAAa,SAAC1S,GAClB6T,GAAYC,WAAW9T,EAAMiS,cAAcziB,OAAO6H,MAChD,SAAA2H,GACEvH,QAAQC,IAAIsH,EAASC,MACrB2U,EAAS5U,EAASC,SAEpB,SAAA5F,GACEb,EAEKa,EAAM2F,UACH3F,EAAM2F,SAASC,MACf5F,EAAM2F,SAASC,KAAKsR,SACpBlX,EAAMkX,SACNlX,EAAM9I,YAIR8I,EAAM2F,UAAsC,MAA1B3F,EAAM2F,SAAS5G,QACnC4a,GAAS5S,SAAS,aAI1B3I,QAAQC,IAAIsI,EAAMiS,cAAcziB,QASlC,OACE,cAAC,GAAD,UACE,kCACE,gCACE,+BACE,oCACA,sCACA,uCACA,yCACA,wCACA,0CACA,2CACA,4CACA,8CACA,iDACA,6CAIJ,gCACGmkB,EAAMxf,KAAI,SAAC4f,EAAM5a,GAAP,OACT,+BACE,+BAAQA,IACR,6BAAM4a,EAAKja,WACX,6BAAMia,EAAKvU,QACTuU,EAAK5kB,MACP,+BAAM4kB,EAAKtU,QAAX,IAAsBsU,EAAK5kB,SAC3B,6BAAM4kB,EAAKtU,UAEX,6BAAMsU,EAAKrU,SACX,6BAAMqU,EAAKpU,WACX,6BAAMoU,EAAKC,WACX,6BAAMD,EAAKE,YACX,6BAAMF,EAAKG,eACX,6BAAMH,EAAKI,kBACX,6BACE,wBAAQ3kB,MAAOukB,EAAKvU,MAAOqD,QAAS6P,EAApC,wBAfOvZ,cC7DnBua,SAAS,GAEX,CACEzP,GAAI,QACJwP,KAAM,QACNpC,UAAW5M,GACXiP,SAAS,GAEX,CACEzP,GAAI,QACJwP,KAAM,eACNpC,UAAW5M,GACXiP,SAAS,GAEX,CACEzP,GAAI,QACJwP,KAAM,aACNpC,UAAW5M,GACXiP,SAAS,GAEX,CACEzP,GAAI,QACJwP,KAAM,SACNpC,UAAW5M,GACXiP,SAAS,GAEX,CACEzP,GAAI,aACJwP,KAAM,YACNpC,UAAWnB,GACXwD,SAAS,IC+CEU,GAjIQ,WAErB,IACM5d,EADiBoF,KACapF,aACpC,EAAsCtH,oBAAS,GAA/C,mBAAQmlB,EAAR,KAAoBC,EAApB,KACA,EAAwCplB,qBAAxC,mBAAQkjB,EAAR,KAAqBmC,EAArB,KACA,EAA8CrlB,oBAAS,GAAvD,mBAAQslB,EAAR,KAAwBC,EAAxB,KACA,EAA4CvlB,mBAAS,GAArD,6BA2BA,SAASwlB,IACP/Q,GAAYgR,SACZJ,OAAe3lB,GACf6lB,GAAkB,GAGpB,OA/BAxd,qBAAU,WACR,IAAM8c,EAAOpQ,GAAYC,iBACzB,GAAImQ,EAMF,OALAQ,EAAeR,GAEfU,EAAgC,cAAbV,EAAK7b,MACxB8a,GAAS7b,GAAG,SAAUud,GAEf,WACL1B,GAASxS,OAAO,SAAUkU,MAI7B,IAEHzd,qBAAU,WACmB,YAAxBT,EAAa4B,QAAgD,sBAAxB5B,EAAa4B,OAAgCkc,GAAc,GAC9FA,GAAc,KAClB,CAAC9d,IAcF,sBAAK4P,UAAU,2BAAf,WACMiO,GAEF,sBAAKjO,UAAU,2CAAf,UACI,cAAC,IAAD,CAAM5Y,GAAI,IAAK4Y,UAAU,eAAzB,wBAGA,sBAAKA,UAAU,qBAAf,UACKgM,GACD,oBAAIhM,UAAU,WAAd,SACI,cAAC,IAAD,CAAM5Y,GAAI,QAAS4Y,UAAU,WAA7B,qBAMHoO,GACG,oBAAIpO,UAAU,WAAd,SACA,cAAC,IAAD,CAAM5Y,GAAI,cAAe4Y,UAAU,WAAnC,2BAMHoO,GAEG,oBAAIpO,UAAU,WAAd,SACA,cAAC,IAAD,CAAM5Y,GAAI,SAAU4Y,UAAU,WAA9B,6BAePgM,EACG,qBAAKhM,UAAU,qBAAf,SAIA,oBAAIA,UAAU,WAAd,SACI,mBAAGwO,KAAK,SAASxO,UAAU,WAAWvD,QAAS6R,EAA/C,wBAMJ,sBAAKtO,UAAU,qBAAf,UACA,oBAAIA,UAAU,WAAd,SACI,cAAC,IAAD,CAAM5Y,GAAI,SAAU4Y,UAAU,WAA9B,qBAKJ,oBAAIA,UAAU,WAAd,SACI,cAAC,IAAD,CAAM5Y,GAAI,YAAa4Y,UAAU,WAAjC,6BASZ,qBAAKA,UAAU,YAAf,SACA,cAAC,KAAD,UACKoN,GAAOrf,KAAI,SAAC0gB,GAAD,OAEZ,cAAC,KAAD,CAEAC,MAAOD,EAAMnB,QACbD,KAAMoB,EAAMpB,KACZpC,UAAWwD,EAAMxD,WAHZwD,EAAM5Q,eC5DR8Q,GApDiB,WAI9B,MAAsC7lB,oBAAS,GAA/C,mBACA,GADA,UACwCA,sBAAxC,mBAAqBqlB,GAArB,WACA,EAA8CrlB,oBAAS,GAAvD,mBAAwBulB,GAAxB,WAuBA,SAASC,IACP/Q,GAAYgR,SACZJ,OAAe3lB,GACf6lB,GAAkB,GAGpB,OA3BAxd,qBAAU,WAGR,IAAM8c,EAAOpQ,GAAYC,iBACzB,GAAImQ,EAKF,OAJAQ,EAAeR,GACfU,EAAgC,cAAbV,EAAK7b,MACxB8a,GAAS7b,GAAG,SAAUud,GAEf,WACL1B,GAASxS,OAAO,SAAUkU,MAI7B,IAcD,cAAC,IAAD,UACE,cAAC,EAAD,UACE,cAAC,GAAD,UACE,cAAC,GAAD,UACE,cAAC,GAAD,UACE,cAAC,GAAD,UACE,cAAC,GAAD,iBCmEDM,GA/GO,WACpB,MAAwC9lB,mBAAiBwG,OAAOuf,YAAhE,mBAAOC,EAAP,KAAqBC,EAArB,KACA,EAA0CjmB,mBACxCwG,OAAO0f,aADT,mBAAOC,EAAP,KAAsBC,EAAtB,KAIA,EAAmBC,YAAS,2BAArBC,EAAP,oBACA,EAAkBD,YAAS,0BAApBE,EAAP,oBACA,EAAuBF,YAAS,2BAAzBG,EAAP,oBACA,EAA4BH,YAAS,qCAA9BI,EAAP,oBACA,EAAsBJ,YAAS,mCAAxBjb,EAAP,oBACA,EAAmBib,YAAS,2BAArBK,EAAP,oBACA,EAAkBL,YAAS,0BAApBM,EAAP,oBAEA5e,qBAAU,WACR,IAAM6e,EAAW,WACf,MAAoCpgB,OAA5Buf,EAAR,EAAQA,WAAYG,EAApB,EAAoBA,YAUpBD,EAAgBF,GAChBK,EAAiBF,IAKnB,OAFA1f,OAAOwK,iBAAiB,SAAU4V,GAE3B,kBAAMpgB,OAAO+K,oBAAoB,SAAUqV,MACjD,IAEH,IAAMhR,EAAQ,CACZD,WAAY,CACV7C,MAAO3R,KAAK0lB,IAAI,IAAqB,GAAfb,GACtBvS,OAAQtS,KAAK0lB,IAAI,IAAsB,GAAhBV,KAI3B,OACE,qBAAK3W,MAAO,CAACiE,OAAQ,SAArB,SAEE,eAAC,IAAD,CAAemC,MAAOA,EAAtB,UACE,cAAC,GAAD,IACA,wBACEpG,MAAO,CAAEsX,QAAS,QAClBnT,QAAS,kBAAM2S,KACfvR,GAAG,YAHL,kBAOA,wBACEvF,MAAO,CAAEsX,QAAS,QAClBnT,QAAS,kBAAM4S,KACfxR,GAAG,WAHL,iBAOA,wBACEvF,MAAO,CAAEsX,QAAS,QAClBnT,QAAS,kBAAM6S,KACfzR,GAAG,kBAHL,wBAQA,wBACEvF,MAAO,CAAEsX,QAAS,QAClBnT,QAAS,kBAAM8S,KACf1R,GAAG,sBAHL,4BAQA,wBACEvF,MAAO,CAAEsX,QAAS,QAClBnT,QAAS,kBAAMvI,KACf2J,GAAG,oBAHL,0BAOA,wBACEvF,MAAO,CAAEsX,QAAS,QAClBnT,QAAS,kBAAM+S,KACf3R,GAAG,iBAHL,uBAOA,wBACEvF,MAAO,CAAEsX,QAAS,QAClBnT,QAAS,kBAAMgT,KACf5R,GAAG,WAHL,uBC5FOgS,GAZS,SAACC,GACnBA,GAAeA,aAAuBC,UACxC,8BAAqB9e,MAAK,YAAkD,IAA/C+e,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOF,GACPG,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAQN,OCHdO,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,GAAD,MAEFjjB,SAASkjB,eAAe,SAM1BX,O","file":"static/js/main.8732fa1c.chunk.js","sourcesContent":["let hostname = window.location.hostname;\r\nlet API_URL: string, SOCKET_URL: string;\r\nif(hostname === 'localhost') {\r\n    API_URL = 'http://' + hostname + ':3001/api/';\r\n    SOCKET_URL = 'ws://' + hostname + ':3001';\r\n}\r\nelse {\r\n    API_URL = 'https://' + hostname + '/api/';\r\n    SOCKET_URL = 'wss://' + hostname;\r\n}\r\n\r\nexport {\r\n    API_URL, \r\n    SOCKET_URL\r\n}","import { GameState, PlayerType } from \"../types\";\r\n\r\nexport const QUADRANT_CONFIGS = {\r\n  left: [\r\n    {\r\n      quadrantNum: 1,\r\n      pipsRange: {\r\n        from: 6,\r\n        to: 12,\r\n      },\r\n    },\r\n    {\r\n      quadrantNum: 2,\r\n      pipsRange: {\r\n        from: 12,\r\n        to: 18,\r\n      },\r\n    },\r\n  ],\r\n\r\n  right: [\r\n    {\r\n      quadrantNum: 0,\r\n      pipsRange: {\r\n        from: 0,\r\n        to: 6,\r\n      },\r\n    },\r\n    {\r\n      quadrantNum: 3,\r\n      pipsRange: {\r\n        from: 18,\r\n        to: 24,\r\n      },\r\n    },\r\n  ],\r\n};\r\n\r\nexport const DIMENSIONS_CONFIG = {\r\n  BAR_TICKNESS_RATIO: 0.03,\r\n  CENTER_BAR_TICKNESS_RATIO: 0.07,\r\n  BEAROFF_BAR_RATIO: 0.09,\r\n  ACTIVE_CHECKER_RATIO: 0.05,\r\n  CHECKERS_SPACE_RATIO: 0.0095,\r\n  CHECKER_STACKING_FACTOR: 0.7,\r\n  BEAROFF_CHECKER_RATIO: 0.25,\r\n  CONTROLS_RATIO: 0.1,\r\n  DIE_RATIO: 0.6,\r\n  DIE_POINT_RATIO: 0.19,\r\n};\r\n\r\nexport type PlayerAlias = \"Black\" | \"White\";\r\n\r\nexport const PlayerTypeEnum: Record<PlayerAlias, PlayerType> = {\r\n  Black: \"B\",\r\n  White: \"W\",\r\n};\r\n\r\nexport const PlayerNameEnum: Record<PlayerType, PlayerAlias> = {\r\n  W: \"White\",\r\n  B: \"Black\",\r\n};\r\n\r\nexport const INITIAL_STATE: GameState = {\r\n  turn: \"W\",\r\n  diceRolled: [4, 3],\r\n  plyRoll: [4, 3],\r\n  // pipMovesSequences: [],\r\n  positionTransitionsMap: [],\r\n  stateMachine: \"PENDING_ROLL\",\r\n  initDiceRolled: {\r\n    W: 0,\r\n    B: 0,\r\n  },\r\n  hitSpace: {\r\n    W: 0,\r\n    B: 0,\r\n  },\r\n  bearOff: {\r\n    W: 3,\r\n    B: 0,\r\n  },\r\n  pips: [\r\n    { isEmpty: false, player: PlayerTypeEnum.Black, count: 2, pipId: 0 },\r\n    { isEmpty: true, player: undefined, count: 0, pipId: 1 },\r\n    { isEmpty: true, player: undefined, count: 0, pipId: 2 },\r\n    { isEmpty: true, player: undefined, count: 0, pipId: 3 },\r\n    { isEmpty: true, player: undefined, count: 0, pipId: 4 },\r\n    { isEmpty: false, player: PlayerTypeEnum.White, count: 5, pipId: 5 },\r\n    { isEmpty: true, player: undefined, count: 0, pipId: 6 },\r\n    { isEmpty: false, player: PlayerTypeEnum.White, count: 3, pipId: 7 },\r\n    { isEmpty: true, player: undefined, count: 0, pipId: 8 },\r\n    { isEmpty: true, player: undefined, count: 0, pipId: 9 },\r\n    { isEmpty: true, player: undefined, count: 0, pipId: 10 },\r\n    { isEmpty: false, player: PlayerTypeEnum.Black, count: 5, pipId: 11 },\r\n    { isEmpty: false, player: PlayerTypeEnum.White, count: 5, pipId: 12 },\r\n    { isEmpty: true, player: undefined, count: 0, pipId: 13 },\r\n    { isEmpty: true, player: undefined, count: 0, pipId: 14 },\r\n    { isEmpty: true, player: undefined, count: 0, pipId: 15 },\r\n    { isEmpty: false, player: PlayerTypeEnum.Black, count: 3, pipId: 16 },\r\n    { isEmpty: true, player: undefined, count: 0, pipId: 17 },\r\n    { isEmpty: false, player: PlayerTypeEnum.Black, count: 5, pipId: 18 },\r\n    { isEmpty: true, player: undefined, count: 0, pipId: 19 },\r\n    { isEmpty: true, player: undefined, count: 0, pipId: 20 },\r\n    { isEmpty: true, player: undefined, count: 0, pipId: 21 },\r\n    { isEmpty: true, player: undefined, count: 0, pipId: 22 },\r\n    { isEmpty: false, player: PlayerTypeEnum.White, count: 2, pipId: 23 },\r\n  ],\r\n};\r\n\r\nexport const ANIMATION_DURATION = 0.4; //s\r\n","import React, { useContext, useState, createContext } from \"react\";\r\nimport { GameState, Consequence } from \"../../types\";\r\nimport { INITIAL_STATE } from \"../../components/constants\";\r\n\r\nexport interface GameStateContextValue {\r\n  state: GameState;\r\n  consequences: Consequence[];\r\n  updateGameState: (state: GameState) => void;\r\n  updateConsequences: (consequences: Consequence[]) => void;\r\n}\r\n\r\nexport const GameStateContext = createContext({} as GameStateContextValue);\r\n\r\nexport const GameStateProvider: React.FC = ({ children }) => {\r\n  const [state, updateGameState] =\r\n    useState<GameState | undefined>(INITIAL_STATE);\r\n\r\n  const [consequences, updateConsequences] = useState<Consequence[]>([]);\r\n\r\n  return (\r\n    <GameStateContext.Provider\r\n      value={{\r\n        state: state as GameState,\r\n        consequences,\r\n        updateGameState,\r\n        updateConsequences,\r\n      }}\r\n    >\r\n      {children}\r\n    </GameStateContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useGameState = (): GameStateContextValue => {\r\n  const context = useContext(GameStateContext);\r\n  return context;\r\n};\r\n","import { PlayerType } from \"./types\";\r\n\r\nexport let checkerRefs: any = [];\r\nexport let pipRefs: any = [];\r\nexport let hitSpaceRefs: Record<PlayerType, any> = {\r\n  W: null,\r\n  B: null,\r\n};\r\n\r\nexport let bearOffRefs: Record<PlayerType, any> = {\r\n  W: null,\r\n  B: null,\r\n};\r\n","import map from \"lodash/map\";\r\nimport filter from \"lodash/filter\";\r\n\r\nimport { Position, PlayerType, ConditionalEntry } from \"../types\";\r\n\r\nexport const getOpponent = (p: PlayerType): PlayerType =>\r\n  p === \"W\" ? \"B\" : \"W\";\r\n\r\nexport const getConditionalClassnames = (entries: ConditionalEntry[]) =>\r\n  map(filter(entries, { when: true }), \"value\").join(\" \");\r\n\r\nexport const coalesce = (arr: any[]): any => arr.find((it) => it !== null);\r\n\r\nexport const getUniqueId = () => \"_\" + Math.random().toString(36).substr(2, 9);\r\n\r\nexport const wait = (ms: number) =>\r\n  new Promise((resolve) => setTimeout(resolve, ms));\r\n\r\nexport const calculateTranslatingPosition = (\r\n  sourceElement: HTMLDivElement,\r\n  targetElement: HTMLDivElement,\r\n  offset = 0\r\n): Position | undefined => {\r\n  const sourcePosition = sourceElement.getBoundingClientRect();\r\n  const targetPosition = targetElement?.getBoundingClientRect();\r\n\r\n  if (\r\n    sourcePosition?.left === undefined ||\r\n    sourcePosition.top === undefined ||\r\n    targetPosition?.left === undefined ||\r\n    targetPosition.top === undefined\r\n  ) {\r\n    return;\r\n  }\r\n\r\n  return {\r\n    left: targetPosition.left - sourcePosition.left,\r\n    top: targetPosition.top - sourcePosition.top + offset,\r\n  };\r\n};\r\n","import some from \"lodash/some\";\r\n\r\nimport { PlayerType, PositionTransitionEntry } from \"../types\";\r\n\r\nimport { NetworkRole } from \"../game-manager/network-manager/types\";\r\nimport { PlayerNameEnum } from \"../components/constants\";\r\n\r\nexport const isFacingNorth = (player: PlayerType) => player === \"W\";\r\n\r\nexport const getBearOffPosition = (player: PlayerType) =>\r\n  isFacingNorth(player) ? -1 : 24;\r\n\r\nexport const whoAmI = (role: NetworkRole): PlayerType =>\r\n  role === \"HOST\" ? \"W\" : \"B\";\r\n\r\nexport const getNetworkRoleByPlayer = (player: PlayerType): NetworkRole =>\r\n  player === \"W\" ? \"HOST\" : \"GUEST\";\r\n\r\nexport const isThereMoveOnPipPosition = (\r\n  pipPosition: number,\r\n  positionTranslations: PositionTransitionEntry | undefined\r\n) => {\r\n  if (positionTranslations === undefined) {\r\n    return false;\r\n  }\r\n\r\n  const isThereMove = some(positionTranslations.to, (n) => n === pipPosition);\r\n\r\n  return isThereMove;\r\n};\r\n\r\nexport const getPlayerTypeName = (player: PlayerType | undefined) =>\r\n  player === undefined ? \"\" : PlayerNameEnum[player];\r\n","import { useState } from \"react\";\r\nimport {\r\n  ANIMATION_DURATION,\r\n  DIMENSIONS_CONFIG,\r\n} from \"../../../components/constants\";\r\nimport { pipRefs, hitSpaceRefs, bearOffRefs } from \"../../../dom-refs\";\r\nimport { PlayerType } from \"../../../types\";\r\n\r\nimport {\r\n  wait,\r\n  calculateTranslatingPosition,\r\n  getOpponent,\r\n  coalesce,\r\n  getUniqueId,\r\n} from \"../../../utils\";\r\n\r\nimport { isFacingNorth, getBearOffPosition } from \"../../../utils/backgammon\";\r\n\r\nimport { AnimationHandler, AnimationMetadata } from \"../index\";\r\n\r\nconst { BEAROFF_CHECKER_RATIO } = DIMENSIONS_CONFIG;\r\n\r\nexport interface AnimationMoveCheckerMetadata extends AnimationMetadata {\r\n  left: number;\r\n  top: number;\r\n  pipNum: number | undefined;\r\n  isHitSpaceMove: boolean;\r\n  isBearOffMove: boolean;\r\n  player: PlayerType;\r\n}\r\n\r\ninterface Result {\r\n  animationHandler: AnimationHandler;\r\n  animationsMetadata: AnimationMoveCheckerMetadata[];\r\n}\r\n\r\nconst useMoveChecker = (): Result => {\r\n  const [animationsMetadata, setAnimationsMetadata] = useState<\r\n    AnimationMoveCheckerMetadata[]\r\n  >([]);\r\n\r\n  let currentAnimations: AnimationMoveCheckerMetadata[] = [];\r\n\r\n  const animationHandler = {\r\n    commit: async (\r\n      fromPosition: number | \"hit-space\",\r\n      toPosition: number | \"hit-space\",\r\n      player: PlayerType,\r\n      shouldDispose = true\r\n    ) => {\r\n      const animationUniqueId = getUniqueId();\r\n      const isHitSpaceMove = fromPosition === \"hit-space\";\r\n      const isBearOffMove = toPosition === getBearOffPosition(player);\r\n\r\n      const sourceParent =\r\n        fromPosition === \"hit-space\"\r\n          ? hitSpaceRefs[player]\r\n          : pipRefs[fromPosition];\r\n\r\n      const targetParent =\r\n        toPosition === \"hit-space\"\r\n          ? hitSpaceRefs[player]\r\n          : isBearOffMove\r\n          ? bearOffRefs[player]\r\n          : pipRefs[toPosition];\r\n\r\n      const sourcePip = sourceParent.querySelector(\".checker.can-be-selected\");\r\n\r\n      const targetPip = coalesce([\r\n        targetParent.querySelector(`.can-be-hit.${getOpponent(player)}`),\r\n        targetParent.querySelector(\".position-handle\"),\r\n      ]);\r\n\r\n      const offset =\r\n        isBearOffMove && !isFacingNorth(player)\r\n          ? -BEAROFF_CHECKER_RATIO * 100\r\n          : 0;\r\n      const transformedPosition = calculateTranslatingPosition(\r\n        sourcePip,\r\n        targetPip,\r\n        offset\r\n      );\r\n\r\n      if (transformedPosition === undefined) {\r\n        return animationUniqueId;\r\n      }\r\n\r\n      // We store metadata for the animation\r\n      currentAnimations = [\r\n        ...currentAnimations,\r\n        {\r\n          animationUniqueId,\r\n          left: transformedPosition.left,\r\n          top: transformedPosition.top,\r\n          duration: ANIMATION_DURATION,\r\n          pipNum: isHitSpaceMove\r\n            ? undefined\r\n            : typeof fromPosition === \"number\"\r\n            ? fromPosition\r\n            : undefined,\r\n          isHitSpaceMove,\r\n          isBearOffMove,\r\n          player,\r\n        },\r\n      ];\r\n      setAnimationsMetadata(currentAnimations);\r\n\r\n      // We wait for the configured duration period of the animation\r\n      await wait(ANIMATION_DURATION * 1000);\r\n\r\n      // We dispose the animation metadata\r\n      // Or we don't, then it's up to the consumer to dispose it whenever fits the usage\r\n      if (shouldDispose) {\r\n        currentAnimations = currentAnimations.filter(\r\n          (it) => it.animationUniqueId !== animationUniqueId\r\n        );\r\n        setAnimationsMetadata(currentAnimations);\r\n      }\r\n\r\n      return animationUniqueId;\r\n    },\r\n    dispose: async (animationUniqueId: string) => {\r\n      currentAnimations = currentAnimations.filter(\r\n        (it) => it.animationUniqueId !== animationUniqueId\r\n      );\r\n      setAnimationsMetadata(currentAnimations);\r\n    },\r\n  };\r\n\r\n  return {\r\n    animationHandler,\r\n    animationsMetadata,\r\n  };\r\n};\r\n\r\nexport default useMoveChecker;\r\n","import { Move } from \"../../../types\";\r\nimport { getOpponent } from \"../../../utils\";\r\n\r\nimport { AnimationService } from \"../index\";\r\n\r\ninterface Result {\r\n  handleMoveAnimation: (move: Move) => Promise<unknown>;\r\n}\r\n\r\ninterface Params {\r\n  animationService: AnimationService;\r\n}\r\n\r\nconst useHandleMoveAnimation = (params: Params): Result => {\r\n  const { animationService } = params;\r\n\r\n  const handleMoveAnimation = async (move: Move) => {\r\n    const { from, to, player, isHit } = move;\r\n\r\n    if (isHit) {\r\n      // This is because whenever we have a hit we have an atomic move\r\n      // but the nature of the animations is not atomic cause it is represented as\r\n      // 2 separate animations (hitter checker moves to position, then hit checker moves to hit-space)\r\n      // therefore we basically execute  these animations in sequence\r\n      // and then dispose the one started first.\r\n\r\n      //TODO: sound\r\n      (document.querySelector(\"#play-move\") as HTMLButtonElement).click();\r\n\r\n      const animationDisposeId = await animationService.moveChecker.commit(\r\n        from,\r\n        to,\r\n        player,\r\n        false\r\n      );\r\n\r\n      (document.querySelector(\"#play-hit\") as HTMLButtonElement).click();\r\n\r\n      await animationService.moveChecker.commit(\r\n        to,\r\n        \"hit-space\",\r\n        getOpponent(player)\r\n      );\r\n\r\n      await animationService.moveChecker.dispose(animationDisposeId);\r\n    } else {\r\n      (document.querySelector(\"#play-move\") as HTMLButtonElement).click();\r\n\r\n      await animationService.moveChecker.commit(from, to, player);\r\n      // stop();\r\n    }\r\n\r\n    return;\r\n  };\r\n\r\n  return {\r\n    handleMoveAnimation,\r\n  };\r\n};\r\n\r\nexport default useHandleMoveAnimation;\r\n","import { useState } from \"react\";\r\nimport random from \"lodash/random\";\r\nimport times from \"lodash/times\";\r\nimport { PlayerType } from \"../../../types\";\r\n\r\nimport { wait, getUniqueId } from \"../../../utils\";\r\n\r\nimport { AnimationHandler, AnimationMetadata } from \"../index\";\r\n\r\nexport const ROLL_DICE_ANIMATION_DURATION = 1;\r\n\r\nexport interface AnimationRollDiceMetadata extends AnimationMetadata {\r\n  dieFaceSequence: number[];\r\n  player: PlayerType;\r\n  nthDie: number;\r\n}\r\n\r\ninterface Result {\r\n  animationHandler: AnimationHandler;\r\n  animationsMetadata: AnimationRollDiceMetadata[];\r\n}\r\n\r\nconst useMoveChecker = (): Result => {\r\n  const [animationsMetadata, setAnimationsMetadata] = useState<\r\n    AnimationRollDiceMetadata[]\r\n  >([]);\r\n\r\n  let currentAnimations: AnimationRollDiceMetadata[] = [];\r\n\r\n  const animationHandler = {\r\n    commit: async (\r\n      player: PlayerType,\r\n      nthDie: number,\r\n      die: number,\r\n      shouldDispose = true\r\n    ) => {\r\n      const animationUniqueId = getUniqueId();\r\n\r\n      // GENERATE RANDOM SEQUENCE\r\n      const randomDieFaceSequence = [1]\r\n        .concat(times(random(13, 17)).map(() => random(1, 6)))\r\n        .concat(die);\r\n\r\n      // We store metadata for the animation\r\n      currentAnimations = [\r\n        ...currentAnimations,\r\n        {\r\n          player,\r\n          animationUniqueId,\r\n          duration: ROLL_DICE_ANIMATION_DURATION,\r\n          dieFaceSequence: randomDieFaceSequence,\r\n          nthDie,\r\n        },\r\n      ];\r\n\r\n      setAnimationsMetadata(currentAnimations);\r\n      const element: any = document.querySelector(\"#play-dice-throw\");\r\n      element.click();\r\n\r\n      // We wait for the configured duration period of the animation\r\n      await wait(ROLL_DICE_ANIMATION_DURATION * 1000);\r\n\r\n      // We dispose the animation metadata\r\n      // Or we don't, then it's up to the consumer to dispose it whenever fits the usage\r\n      if (shouldDispose) {\r\n        currentAnimations = currentAnimations.filter(\r\n          (it) => it.animationUniqueId !== animationUniqueId\r\n        );\r\n        setAnimationsMetadata(currentAnimations);\r\n      }\r\n\r\n      return animationUniqueId;\r\n    },\r\n    dispose: async (animationUniqueId: string) => {\r\n      currentAnimations = currentAnimations.filter(\r\n        (it) => it.animationUniqueId !== animationUniqueId\r\n      );\r\n      setAnimationsMetadata(currentAnimations);\r\n    },\r\n  };\r\n\r\n  return {\r\n    animationHandler,\r\n    animationsMetadata,\r\n  };\r\n};\r\n\r\nexport default useMoveChecker;\r\n","import React, { useContext, createContext, useState } from \"react\";\r\n\r\nimport { Move, PlayerType } from \"../../types\";\r\n\r\n//animation hooks\r\nimport useMoveCheckerAnimation, {\r\n  AnimationMoveCheckerMetadata,\r\n} from \"./hooks/useMoveCheckerAnimation\";\r\n\r\nimport useHandleMoveAnimation from \"./hooks/useHandleMoveAnimation\";\r\nimport useRollDiceAnimation, {\r\n  AnimationRollDiceMetadata,\r\n} from \"./hooks/useRollDiceAnimation\";\r\n\r\nexport interface UIState {\r\n  selectedChecker: undefined | SelectedCheckerMetadata;\r\n  pressedRoll: boolean;\r\n  pressedUndo: boolean;\r\n  pressedConfirm: boolean;\r\n  isExecutingMove: boolean;\r\n  isExecutingRoll: Record<PlayerType, boolean>;\r\n}\r\n\r\ntype AnimationID = \"moveChecker\" | \"rollDice\";\r\n\r\nexport interface AnimationHandler {\r\n  commit: (...args: any) => Promise<string>;\r\n  dispose: (animationUniqueId: string) => Promise<unknown>;\r\n}\r\n\r\nexport type AnimationService = Record<AnimationID, AnimationHandler>;\r\n\r\nexport interface AnimationMetadata {\r\n  animationUniqueId: string;\r\n  duration: number;\r\n}\r\n\r\ninterface AnimationMetadataMap {\r\n  moveChecker: AnimationMoveCheckerMetadata[];\r\n  rollDice: AnimationRollDiceMetadata[];\r\n}\r\n\r\nexport interface GameUIContextValue {\r\n  animationService: AnimationService;\r\n  animations: AnimationMetadataMap;\r\n  uiState: UIState;\r\n  updateUiState: (uiState: UIState) => void;\r\n  handleMoveAnimation: (move: Move) => Promise<unknown>;\r\n}\r\n\r\nexport interface SelectedCheckerMetadata {\r\n  pipId: number | \"hit-space\";\r\n}\r\n\r\nexport const GameUIContext = createContext({} as GameUIContextValue);\r\n\r\nexport const GameUIProvider: React.FC = ({ children }) => {\r\n  const [uiState, updateUiState] = useState<UIState>({\r\n    selectedChecker: undefined,\r\n    pressedRoll: false,\r\n    pressedUndo: false,\r\n    pressedConfirm: false,\r\n    isExecutingMove: false,\r\n    isExecutingRoll: {\r\n      W: false,\r\n      B: false,\r\n    },\r\n  });\r\n\r\n  // Move Checker\r\n  const {\r\n    animationHandler: moveCheckerHandler,\r\n    animationsMetadata: moveCheckerAnimationsMetadata,\r\n  } = useMoveCheckerAnimation();\r\n\r\n  // Roll Dice\r\n  const {\r\n    animationHandler: rollDiceHandler,\r\n    animationsMetadata: rollDiceAnimationsMetadata,\r\n  } = useRollDiceAnimation();\r\n\r\n  const animationService: AnimationService = {\r\n    moveChecker: moveCheckerHandler,\r\n    rollDice: rollDiceHandler,\r\n  };\r\n\r\n  const { handleMoveAnimation } = useHandleMoveAnimation({ animationService });\r\n\r\n  return (\r\n    <GameUIContext.Provider\r\n      value={{\r\n        uiState,\r\n        updateUiState,\r\n        handleMoveAnimation,\r\n        animationService,\r\n        animations: {\r\n          moveChecker: moveCheckerAnimationsMetadata,\r\n          rollDice: rollDiceAnimationsMetadata,\r\n        },\r\n      }}\r\n    >\r\n      {children}\r\n    </GameUIContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useGameUI = (): GameUIContextValue => {\r\n  const context = useContext(GameUIContext);\r\n  return context;\r\n};\r\n","import { io } from \"socket.io-client\";\r\nimport { SOCKET_URL } from \"../../../config\";\r\n\r\nconst socket = io(SOCKET_URL);\r\n// const socket = io(\"wss://backgammoncloud.com\");\r\nexport default socket;\r\n","var _path, _path2;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgCheck(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    height: 24,\n    viewBox: \"0 0 24 24\",\n    width: 24,\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M0 0h24v24H0z\",\n    fill: \"none\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    stroke: \"currentColor\",\n    fill: \"currentColor\",\n    d: \"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z\"\n  })));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgCheck);\nexport default __webpack_public_path__ + \"static/media/check.2176769c.svg\";\nexport { ForwardRef as ReactComponent };","import { ErrorType } from \"./types\";\r\n\r\nexport const Actions = {\r\n  ALL_USERS_FETCHED: \"ALL_USERS_FETCHED\",\r\n  ALL_ROOMS_FETCHED: \"ALL_ROOMS_FETCHED\",\r\n  ROOMS_FETCHED: \"ROOMS_FETCHED\",\r\n  ROOM_CREATED: \"ROOM_CREATED\",\r\n  ROOM_JOINED: \"ROOM_JOINED\",\r\n  GAME_STARTED: \"GAME_STARTED\",\r\n  SYNC_STATE: \"SYNC_STATE\",\r\n  EXECUTE_MOVE: \"EXECUTE_MOVE\",\r\n  EXECUTE_ROLL: \"EXECUTE_ROLL\",\r\n  NO_AVAILABLE_MOVES: \"NO_AVAILABLE_MOVES\",\r\n  ERROR_OCCURRED: \"ERROR_OCCURRED\",\r\n  SYNC_NETWORK_STATUS: \"SYNC_NETWORK_STATUS\",\r\n  REMATCH_INVITATION_SENT: \"REMATCH_INVITATION_SENT\",\r\n  REMATCH_INVITATION_DECLINED: \"REMATCH_INVITATION_DECLINED\",\r\n  PLAYER_OUT: \"PLAYER_OUT\",\r\n  NO_PLAYER: \"NO_PLAYER\",\r\n\r\n  // Emitters\r\n  GET_ALL_USERS: \"GET_ALL_USERS\",\r\n  GET_ALL_ROOMS: \"GET_ALL_ROOMS\",\r\n  GET_ROOMS: \"GET_ROOMS\",\r\n  CREATE_ROOM: \"CREATE_ROOM\",\r\n  JOIN_ROOM: \"JOIN_ROOM\",\r\n  INIT_ROLL: \"INIT_ROLL\",\r\n  ROLL: \"ROLL\",\r\n  MOVE: \"MOVE\",\r\n  UNDO_MOVE: \"UNDO_MOVE\",\r\n  CONFIRM_MOVE: \"CONFIRM_MOVE\",\r\n  INVITE_FOR_REMATCH: \"INVITE_FOR_REMATCH\",\r\n  ACCEPT_REMATCH: \"ACCEPT_REMATCH\",\r\n  DECLINE_REMATCH: \"DECLINE_REMATCH\",\r\n  QUIT_FROM_GAME: \"QUIT_FROM_GAME\",\r\n  DELETE_ROOM: \"DELETE_ROOM\"\r\n};\r\n\r\nexport const JOIN_ROOM_ERRORS: ErrorType[] = [\r\n  \"PASSWORD_NOT_VALID\",\r\n  \"PASSWORD_NOT_PRESENT\",\r\n];\r\n","import { useEffect } from \"react\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport map from \"lodash/map\";\r\n\r\nimport IO from \"../io\";\r\nimport { Actions, JOIN_ROOM_ERRORS } from \"../constants\";\r\nimport { useGameState } from \"../../game-state\";\r\nimport { UIState, useGameUI } from \"../../game-ui\";\r\nimport { RoomsService } from \"./useRooms\";\r\nimport { Consequence, GameState, MoveTransactionEntry } from \"../../../types\";\r\nimport { NetworkState, ExecuteRollPayload, IError, ErrorType } from \"../types\";\r\nimport { wait } from \"../../../utils\";\r\nimport { UndoIcon } from \"../../../components/bar-actions/styles\";\r\n\r\ninterface Result {}\r\n\r\ninterface StatePayload {\r\n  state: GameState;\r\n  finalState: GameState;\r\n}\r\n\r\ninterface Params {\r\n  networkState: NetworkState;\r\n  updateNetworkState: (networkState: NetworkState) => void;\r\n  roomsService: RoomsService;\r\n}\r\n\r\nconst useListeners = (params: Params): Result => {\r\n  const {\r\n    state,\r\n    consequences,\r\n    updateGameState: syncUpdateGameState,\r\n    updateConsequences: syncUpdateConsequences,\r\n  } = useGameState();\r\n\r\n  const {\r\n    uiState,\r\n    updateUiState: syncUpdateUiState,\r\n    handleMoveAnimation,\r\n    animationService,\r\n  } = useGameUI();\r\n\r\n  const history = useHistory();\r\n\r\n  const {\r\n    networkState,\r\n    updateNetworkState: syncUpdateNetworkState,\r\n    roomsService,\r\n  } = params;\r\n\r\n  let currentNetworkState = { ...networkState };\r\n  let currentGameState = { ...state };\r\n  let currentConsequences = [...consequences];\r\n  let currentUiState = { ...uiState };\r\n\r\n  const updateGameState = (newState: GameState) => {\r\n    currentGameState = { ...newState };\r\n    syncUpdateGameState(currentGameState);\r\n  };\r\n\r\n  const updateConsequences = (consequences: Consequence[]) => {\r\n    currentConsequences = [...consequences];\r\n    syncUpdateConsequences(currentConsequences);\r\n  };\r\n\r\n  const updateNetworkState = (newState: NetworkState) => {\r\n    currentNetworkState = { ...newState };\r\n    syncUpdateNetworkState(currentNetworkState);\r\n  };\r\n\r\n  const updateUiState = (newState: UIState) => {\r\n    currentUiState = { ...newState };\r\n    syncUpdateUiState(currentUiState);\r\n  };\r\n\r\n  useEffect(() => {\r\n    IO.on(Actions.ROOMS_FETCHED, (payload: any) => {\r\n      wait(200).then(() => {\r\n        roomsService.setRooms(payload.rooms);\r\n        roomsService.setIsLoading(false);\r\n      });\r\n    });\r\n\r\n    IO.on(Actions.ALL_ROOMS_FETCHED, (payload: any) => {\r\n      console.log(\"all_rooms_fetched\");\r\n      wait(200).then(() => {\r\n        roomsService.setAllRooms(payload.allRooms);\r\n        roomsService.setIsLoadingAll(false);\r\n        console.log(\"all rooms fetched\");\r\n        console.log(payload.allRooms);\r\n      });\r\n    });\r\n\r\n    IO.on(Actions.ALL_USERS_FETCHED, (payload: any) => {\r\n      wait(200).then(() => {\r\n        roomsService.setAllUsers(payload.allUsers);\r\n        roomsService.setIsLoadingAll(false);\r\n      });\r\n    });\r\n\r\n    IO.on(Actions.ROOM_CREATED, (payload: any) => {\r\n      const { roomId, roomName, role, hostUsername, status } = payload;\r\n      console.log(Actions.ROOM_CREATED, payload);\r\n\r\n      currentNetworkState = {\r\n        ...currentNetworkState,\r\n        status,\r\n        roomId,\r\n        roomName,\r\n        role,\r\n        hostUsername\r\n      };\r\n\r\n      updateNetworkState(currentNetworkState);\r\n\r\n      wait(500).then(() => {\r\n        roomsService.initCreateForm();\r\n        roomsService.setIsCreatingRoom(false);\r\n      });\r\n\r\n      \r\n    });\r\n\r\n    IO.on(Actions.SYNC_NETWORK_STATUS, (payload: any) => {\r\n      console.log(Actions.SYNC_NETWORK_STATUS, payload);\r\n\r\n      const { roomId, role, hostUsername, guestUsername, status } = payload;\r\n\r\n      currentNetworkState = {\r\n        ...currentNetworkState,\r\n        status,\r\n        roomId,\r\n        role,\r\n        hostUsername,\r\n        guestUsername,\r\n      };\r\n\r\n      updateNetworkState(currentNetworkState);\r\n    });\r\n\r\n    IO.on(Actions.ROOM_JOINED, (payload: any) => {\r\n      console.log(Actions.ROOM_JOINED, payload);\r\n      const { roomId, roomName, role, hostUsername, guestUsername, status } =\r\n        payload;\r\n\r\n      console.log(\"joining\");\r\n\r\n      currentNetworkState = {\r\n        ...currentNetworkState,\r\n        roomId,\r\n        roomName,\r\n        role,\r\n        hostUsername,\r\n        guestUsername,\r\n        status,\r\n      };\r\n\r\n      updateNetworkState(currentNetworkState);\r\n      roomsService.setError(undefined);\r\n      history.push(`/game/${roomId}`);\r\n    });\r\n\r\n    IO.on(Actions.GAME_STARTED, (payload: any) => {\r\n      console.log(Actions.GAME_STARTED, payload);\r\n      const { initState } = payload;\r\n\r\n      updateGameState({\r\n        ...initState,\r\n      });\r\n\r\n      roomsService.setIsSendRematchInvitationLoading(false);\r\n      roomsService.setHasPendingRematchInvitation(false);\r\n\r\n      currentNetworkState = {\r\n        ...currentNetworkState,\r\n        status: \"STARTED\",\r\n      };\r\n      updateNetworkState(currentNetworkState);\r\n    });\r\n\r\n    IO.on(Actions.SYNC_STATE, (payload: any) => {\r\n      console.log(Actions.SYNC_STATE, payload);\r\n      const { state, finalState } = payload;\r\n\r\n      updateGameState({\r\n        ...state,\r\n      });\r\n\r\n      if (finalState) {\r\n        wait(1500).then(() => {\r\n          updateGameState({\r\n            ...finalState,\r\n          });\r\n        });\r\n      }\r\n\r\n      updateNetworkState({ ...currentNetworkState, status: \"STARTED\" });\r\n\r\n      const pressedButtonsState = {\r\n        pressedRoll: false,\r\n        pressedUndo: false,\r\n        pressedConfirm: false,\r\n      };\r\n\r\n      updateUiState({\r\n        ...currentUiState,\r\n        ...pressedButtonsState,\r\n      });\r\n    });\r\n\r\n    IO.on(Actions.EXECUTE_ROLL, async (payload: ExecuteRollPayload) => {\r\n      console.log(Actions.EXECUTE_ROLL, payload);\r\n\r\n      const { diceRolledMetadata, consequences, state } = payload;\r\n\r\n      const animationsToExecute = map(\r\n        diceRolledMetadata,\r\n        ({ player, nthDie, die }) =>\r\n          animationService.rollDice.commit(player, nthDie, die)\r\n      );\r\n\r\n      const player = diceRolledMetadata[0].player;\r\n\r\n      /* The pattern goes as follows:\r\n           1. We first execute animations for given dice\r\n           2. Then update the consequences if there are some\r\n           3. Await consequences to be shown for some amount of time\r\n           4. Invalidate them\r\n           5. Update GameState\r\n      */\r\n\r\n      updateUiState({\r\n        ...currentUiState,\r\n        isExecutingRoll: {\r\n          ...currentUiState.isExecutingRoll,\r\n          [player]: true,\r\n        },\r\n      });\r\n\r\n      await Promise.all(animationsToExecute);\r\n\r\n      if (consequences.length > 0) {\r\n        updateConsequences(consequences);\r\n        await wait(1500);\r\n        updateConsequences([]);\r\n      }\r\n\r\n      updateGameState(state);\r\n      updateUiState({\r\n        ...currentUiState,\r\n        isExecutingRoll: {\r\n          ...currentUiState.isExecutingRoll,\r\n          [player]: false,\r\n        },\r\n      });\r\n    });\r\n\r\n    IO.on(Actions.INIT_ROLL, (payload: any) => {\r\n      console.log(Actions.INIT_ROLL, payload);\r\n      const { state } = payload;\r\n\r\n      updateGameState({\r\n        ...state,\r\n      });\r\n\r\n      currentNetworkState = { ...currentNetworkState, status: \"STARTED\" };\r\n      updateNetworkState(currentNetworkState);\r\n    });\r\n\r\n    IO.on(Actions.EXECUTE_MOVE, async (payload: any) => {\r\n      console.log(Actions.EXECUTE_MOVE, \"EXECUTING\", payload);\r\n\r\n      const transactionEntries: MoveTransactionEntry[] =\r\n        payload.transactionEntries;\r\n\r\n      updateUiState({\r\n        ...currentUiState,\r\n        isExecutingMove: true,\r\n      });\r\n\r\n      for (let i = 0; i < transactionEntries.length; i++) {\r\n        const move = transactionEntries[i].move;\r\n        const updatedState = transactionEntries[i].state;\r\n\r\n        await handleMoveAnimation(move);\r\n        updateGameState(updatedState);\r\n      }\r\n\r\n      const { finalState } = payload;\r\n\r\n      if (finalState !== undefined) {\r\n        // The upper state update is mostly regarding positions and\r\n        // here we get turn switch and things like that\r\n        updateGameState(finalState);\r\n      }\r\n\r\n      updateUiState({\r\n        ...currentUiState,\r\n        isExecutingMove: false,\r\n      });\r\n    });\r\n\r\n    IO.on(Actions.REMATCH_INVITATION_SENT, () => {\r\n      roomsService.setHasPendingRematchInvitation(true);\r\n    });\r\n\r\n    IO.on(Actions.REMATCH_INVITATION_DECLINED, () => {\r\n      roomsService.setIsSendRematchInvitationLoading(false);\r\n      roomsService.setHasPendingRematchInvitation(false);\r\n      history.push(\"/\");\r\n    });\r\n    \r\n    IO.on(Actions.ERROR_OCCURRED, async (error: IError) => {\r\n      console.log(Actions.ERROR_OCCURRED, \"ERROR\", error);\r\n      \r\n      const { errorType } = error;\r\n      \r\n      if (JOIN_ROOM_ERRORS.includes(errorType)) {\r\n        roomsService.setError(error);\r\n        roomsService.setIsJoiningRoom(false);\r\n      }\r\n    });\r\n\r\n    IO.on(Actions.PLAYER_OUT, (role) => {\r\n      console.log(role);\r\n\r\n      if(role.role === \"HOST\") {\r\n        console.log(\"======4. host player jumped out=========\");\r\n        \r\n        if(currentNetworkState.role === \"HOST\") {\r\n          currentNetworkState.status = \"NOT_STARTED\";\r\n          currentNetworkState.role = undefined;\r\n          currentNetworkState.hostUsername = undefined;\r\n          currentNetworkState.guestUsername = undefined;\r\n          currentNetworkState.roomId = undefined;\r\n          currentNetworkState.roomName = undefined;\r\n        } \r\n        else {\r\n          currentNetworkState.status = \"WAITING_FOR_GUEST\";\r\n          currentNetworkState.role = \"HOST\";\r\n          currentNetworkState.hostUsername = currentNetworkState.guestUsername;\r\n          currentNetworkState.guestUsername = undefined;\r\n        } \r\n        updateNetworkState(currentNetworkState);\r\n      }\r\n      if(role.role === \"GUEST\") {\r\n        console.log(\"======4. GUEST player jumped out=========\");\r\n        if(currentNetworkState.role === \"HOST\") {\r\n          currentNetworkState.status = \"WAITING_FOR_GUEST\";\r\n          currentNetworkState.guestUsername = undefined;\r\n        } \r\n        else {\r\n          currentNetworkState.status = \"NOT_STARTED\";\r\n          currentNetworkState.role = undefined;\r\n          currentNetworkState.hostUsername = undefined;\r\n          currentNetworkState.guestUsername = undefined;\r\n          currentNetworkState.roomId = undefined;\r\n          currentNetworkState.roomName = undefined;\r\n        } \r\n        updateNetworkState(currentNetworkState);\r\n      }\r\n      // networkState.status = \"NOT_STARTED\";\r\n    });\r\n    \r\n    IO.on(Actions.NO_PLAYER, () => {\r\n      console.log(\"======4.there is no player=========\");\r\n      currentNetworkState.status = \"NOT_STARTED\";\r\n      currentNetworkState.role = undefined;\r\n      currentNetworkState.hostUsername = undefined;\r\n      currentNetworkState.guestUsername = undefined;\r\n      currentNetworkState.roomId = undefined;\r\n      currentNetworkState.roomName = undefined;\r\n      updateNetworkState(currentNetworkState);\r\n      console.log(\"\")\r\n    })\r\n    \r\n  }, []);\r\n  \r\n  return {};\r\n};\r\n\r\n\r\nexport default useListeners;\r\n","import IO from \"../io\";\r\nimport { Actions } from \"../constants\";\r\nimport { NetworkState } from \"../types\";\r\nimport { PositionTransition } from \"../../../types\";\r\nimport { RoomsService } from \"./useRooms\";\r\n\r\nexport type VoidEmitter = () => void;\r\n\r\nexport interface EmitterService {\r\n  createRoom: (roomName: string) => void;\r\n  deleteRoom: (roomId: string) => void;\r\n  joinRoom: (roomId: string, username: string) => void;\r\n  pressInitRoll: VoidEmitter;\r\n  pressRoll: VoidEmitter;\r\n  getRooms: VoidEmitter;\r\n  getAllRooms: VoidEmitter;\r\n  getAllUsers: VoidEmitter;\r\n  selectToMove: (positionTranslation: PositionTransition) => void;\r\n  confirmMove: VoidEmitter;\r\n  undo: VoidEmitter;\r\n  sendRematchInvitation: VoidEmitter;\r\n  acceptRematchInvitation: VoidEmitter;\r\n  declineRematchInvitation: VoidEmitter;\r\n  quitFromGame: (status: string, roomId: string, role: string, hostUsername: string, guestUsername: string) => void;\r\n}\r\n\r\ninterface Params {\r\n  networkState: NetworkState;\r\n  updateNetworkState: (networkState: NetworkState) => void;\r\n  roomsService: RoomsService;\r\n}\r\n\r\nconst useEmitters = (params: Params): EmitterService => {\r\n  const { roomsService } = params;\r\n\r\n  const getAllUsers = () => {\r\n    roomsService.setIsLoadingAll(true);\r\n    IO.emit(Actions.GET_ALL_USERS, \"\");\r\n  };\r\n\r\n  const getAllRooms = () => {\r\n    console.log(\"call getallrooms function\");\r\n    roomsService.setIsLoadingAll(true);\r\n    IO.emit(Actions.GET_ALL_ROOMS, \"\");\r\n  };\r\n\r\n  const getRooms = () => {\r\n    roomsService.setIsLoading(true);\r\n    IO.emit(Actions.GET_ROOMS, \"\");\r\n  };\r\n\r\n  const createRoom = (roomName: string) => {\r\n    IO.emit(Actions.CREATE_ROOM, {\r\n      roomName,\r\n    });\r\n  };\r\n\r\n  const deleteRoom = (roomId: string) => {\r\n    console.log(\"deleteRoom\");\r\n    IO.emit(Actions.DELETE_ROOM, {\r\n      roomId,\r\n    });\r\n  };\r\n\r\n  const joinRoom = (roomId: string, username: string) => {\r\n    IO.emit(Actions.JOIN_ROOM, {\r\n      roomId,\r\n      username,\r\n    });\r\n  };\r\n\r\n  const pressInitRoll = () => {\r\n    IO.emit(Actions.INIT_ROLL, \"\");\r\n  };\r\n\r\n  const pressRoll = () => {\r\n    IO.emit(Actions.ROLL, \"\");\r\n  };\r\n\r\n  const selectToMove = (positionTranslation: PositionTransition) => {\r\n\r\n    IO.emit(Actions.MOVE, positionTranslation);\r\n  };\r\n  \r\n  const confirmMove = () => {\r\n    IO.emit(Actions.CONFIRM_MOVE, \"\");\r\n  };\r\n  \r\n  const undo = () => {\r\n    IO.emit(Actions.UNDO_MOVE, \"\");\r\n  };\r\n\r\n  // Rematch logic\r\n  const sendRematchInvitation = () => {\r\n    IO.emit(Actions.INVITE_FOR_REMATCH, \"\");\r\n  };\r\n\r\n  const acceptRematchInvitation = () => {\r\n    IO.emit(Actions.ACCEPT_REMATCH, \"\");\r\n  };\r\n\r\n  const declineRematchInvitation = () => {\r\n    IO.emit(Actions.DECLINE_REMATCH, \"\");\r\n  };\r\n\r\n  const quitFromGame = (status: string, roomId: string, role: string, hostUsername: string, guestUsername: string) => {\r\n    console.log(\"===========2.IO.emit called==============\");\r\n    IO.emit(Actions.QUIT_FROM_GAME, {status, roomId, role, hostUsername, guestUsername});\r\n  };\r\n\r\n  return {\r\n    createRoom,\r\n    deleteRoom,\r\n    joinRoom,\r\n    pressInitRoll,\r\n    pressRoll,\r\n    getRooms,\r\n    getAllRooms,\r\n    getAllUsers,\r\n    selectToMove,\r\n    confirmMove,\r\n    undo,\r\n    sendRematchInvitation,\r\n    acceptRematchInvitation,\r\n    declineRematchInvitation,\r\n    quitFromGame\r\n  };\r\n};\r\n\r\nexport default useEmitters;\r\n","import { useState } from \"react\";\r\n\r\nimport { Room, RoomInfo, UserInfo, IError } from \"../types\";\r\n\r\nexport interface CreateRoomForm {\r\n  roomName: string | undefined;\r\n  // roomNumber: string | undefined;\r\n}\r\n\r\nexport interface JoinRoomForm {\r\n  roomId: string | undefined;\r\n  username: string | undefined;\r\n}\r\n\r\nexport interface RoomsService {\r\n  isLoading: boolean;\r\n  setIsLoading: (isLoading: boolean) => void;\r\n  isLoadingAll: boolean;\r\n  setIsLoadingAll: (isLoadingAll: boolean) => void;\r\n  isSendRematchInvitationLoading: boolean;\r\n  hasPendingRematchInvitation: boolean;\r\n  setHasPendingRematchInvitation: (hasIt: boolean) => void;\r\n  setIsSendRematchInvitationLoading: (isLoading: boolean) => void;\r\n  rooms: Room[];\r\n  setRooms: (rooms: Room[]) => void;\r\n  allRooms: RoomInfo[];\r\n  setAllRooms: (allRooms: RoomInfo[]) => void;\r\n  allUsers: UserInfo[];\r\n  setAllUsers: (allUsers: UserInfo[]) => void;\r\n  createRoomForm: CreateRoomForm;\r\n  joinRoomForm: JoinRoomForm;\r\n  isCreatingRoom: boolean;\r\n  isJoiningRoom: boolean;\r\n  error: IError | undefined;\r\n  setError: (error: IError | undefined) => void;\r\n  updateCreateRoomForm: (form: CreateRoomForm) => void;\r\n  updateJoinRoomForm: (form: JoinRoomForm) => void;\r\n  setIsJoiningRoom: (isJoiningRoom: boolean) => void;\r\n  setIsCreatingRoom: (isCreatingRoom: boolean) => void;\r\n  initCreateForm: () => void;\r\n  initJoinForm: () => void;\r\n}\r\n\r\ninterface Params {}\r\n\r\nconst initCreateRoomForm = () => ({\r\n  roomName: undefined\r\n  // roomNumber: undefined\r\n});\r\n\r\nconst initJoinRoomForm = () => ({\r\n  roomId: undefined,\r\n  username: undefined,\r\n});\r\n\r\nconst useRoomsService = (params: Params): RoomsService => {\r\n  const [isLoading, setIsLoading] = useState<boolean>(false);\r\n  const [isLoadingAll, setIsLoadingAll] = useState<boolean>(false);\r\n  const [isSendRematchInvitationLoading, setIsSendRematchInvitationLoading] =\r\n    useState<boolean>(false);\r\n\r\n  const [hasPendingRematchInvitation, setHasPendingRematchInvitation] =\r\n    useState<boolean>(false);\r\n\r\n  const [rooms, setRooms] = useState<Room[]>([]);\r\n  const [allRooms, setAllRooms] = useState<RoomInfo[]>([]);\r\n  const [allUsers, setAllUsers] = useState<UserInfo[]>([]);\r\n  const [isCreatingRoom, setIsCreatingRoom] = useState<boolean>(false);\r\n  const [isJoiningRoom, setIsJoiningRoom] = useState<boolean>(false);\r\n\r\n  const [createRoomForm, updateCreateRoomForm] = useState<CreateRoomForm>(\r\n    initCreateRoomForm()\r\n  );\r\n\r\n  const [joinRoomForm, updateJoinRoomForm] = useState<JoinRoomForm>(\r\n    initJoinRoomForm()\r\n  );\r\n\r\n  const [error, setError] = useState<IError | undefined>(undefined);\r\n\r\n  const initCreateForm = () => {\r\n    updateCreateRoomForm(initCreateRoomForm());\r\n  };\r\n\r\n  const initJoinForm = () => {\r\n    updateJoinRoomForm(initJoinRoomForm());\r\n  };\r\n\r\n  return {\r\n    isLoading,\r\n    setIsLoading,\r\n    rooms,\r\n    setRooms,\r\n    isLoadingAll,\r\n    setIsLoadingAll,\r\n    allRooms,\r\n    setAllRooms,\r\n    allUsers,\r\n    setAllUsers,\r\n    createRoomForm,\r\n    isCreatingRoom,\r\n    setIsCreatingRoom,\r\n    updateCreateRoomForm,\r\n    initCreateForm,\r\n    isJoiningRoom,\r\n    setIsJoiningRoom,\r\n    updateJoinRoomForm,\r\n    joinRoomForm,\r\n    initJoinForm,\r\n    error,\r\n    setError,\r\n    isSendRematchInvitationLoading,\r\n    setIsSendRematchInvitationLoading,\r\n    hasPendingRematchInvitation,\r\n    setHasPendingRematchInvitation,\r\n  };\r\n};\r\n\r\nexport default useRoomsService;\r\n","import React, { useContext, useState, useEffect, createContext } from \"react\";\r\nimport { NetworkState, Room } from \"./types\";\r\nimport useListeners from \"./hooks/useListeners\";\r\nimport useEmitters, { EmitterService } from \"./hooks/useEmitters\";\r\nimport useRooms, { RoomsService } from \"./hooks/useRooms\";\r\n\r\nexport interface NetworkManagerContextValue {\r\n  networkState: NetworkState;\r\n  roomsService: RoomsService;\r\n  emitterService: EmitterService;\r\n}\r\n\r\nexport const NetworkManagerContext = createContext(\r\n  {} as NetworkManagerContextValue\r\n);\r\n\r\nexport const NetworkManagerProvider: React.FC = ({ children }) => {\r\n  const [networkState, updateNetworkState] = useState<NetworkState>({\r\n    status: \"NOT_STARTED\",\r\n    roomId: undefined,\r\n    roomName: undefined,\r\n    hostUsername: undefined,\r\n    guestUsername: undefined,\r\n    role: undefined,\r\n  });\r\n\r\n  const roomsService = useRooms({});\r\n\r\n  useListeners({ networkState, updateNetworkState, roomsService });\r\n\r\n  const emitterService = useEmitters({\r\n    networkState,\r\n    updateNetworkState,\r\n    roomsService,\r\n  });\r\n\r\n  return (\r\n    <NetworkManagerContext.Provider\r\n      value={{\r\n        networkState,\r\n        roomsService,\r\n        emitterService,\r\n      }}\r\n    >\r\n      {children}\r\n    </NetworkManagerContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useNetworkManager = (): NetworkManagerContextValue => {\r\n  const context = useContext(NetworkManagerContext);\r\n  return context;\r\n};\r\n","import React, { useContext, createContext } from \"react\";\r\nimport { get, find, every, map, times, maxBy, identity } from \"lodash\";\r\n\r\nimport { useNetworkManager } from \"../network-manager\";\r\nimport { NetworkRole } from \"../network-manager/types\";\r\n\r\nimport { useGameState } from \"../game-state\";\r\nimport { useGameUI } from \"../game-ui\";\r\n\r\nimport { getNetworkRoleByPlayer, whoAmI } from \"../../utils/backgammon\";\r\n\r\nimport { getOpponent } from \"../../utils\";\r\nimport { PlayerType } from \"../../types\";\r\nimport { PlayerTypeEnum } from \"../../components/constants\";\r\n\r\ntype PredicateCheck = () => boolean;\r\n\r\ninterface DieContainerMetadata {\r\n  nthDie: number;\r\n  dieNum: number;\r\n}\r\n\r\nexport interface InferenceContextValue {\r\n  isMyTurn: boolean;\r\n  myPlayer: PlayerType;\r\n  canInitRoll: PredicateCheck;\r\n  canRoll: PredicateCheck;\r\n  canUndo: PredicateCheck;\r\n  canConfirmMove: PredicateCheck;\r\n  getHasPipMove: (\r\n    pipId: number | \"hit-space\",\r\n    player: PlayerType | undefined\r\n  ) => boolean;\r\n  getUsernameByPlayer: (player: PlayerType) => string;\r\n  hasWin: PredicateCheck;\r\n  whoWon: () => string | undefined;\r\n  areThereNonAvailableMoves: PredicateCheck;\r\n  shouldShowDiceContainer: (player: PlayerType) => boolean;\r\n  getDiceMetadata: (player: PlayerType) => DieContainerMetadata[];\r\n  shouldShowRematchInvitation: PredicateCheck;\r\n  canInviteForRematch: PredicateCheck;\r\n}\r\n\r\nexport const InferenceContext = createContext({} as InferenceContextValue);\r\n\r\nexport const InferenceProvider: React.FC = ({ children }) => {\r\n  const { networkState, roomsService } = useNetworkManager();\r\n  const { state, consequences } = useGameState();\r\n  const { uiState } = useGameUI();\r\n\r\n  const myPlayer: PlayerType = whoAmI(networkState.role as NetworkRole);\r\n  const isMyTurn = state.turn === myPlayer;\r\n\r\n  const getHasPipMove = (\r\n    pipId: number | \"hit-space\",\r\n    player: PlayerType | undefined\r\n  ) => {\r\n    const { positionTransitionsMap } = state;\r\n\r\n    const hasPossibleMove =\r\n      get(find(positionTransitionsMap, { from: pipId }), \"to.length\", 0) > 0;\r\n\r\n    const isFromMyHitSpace = pipId === \"hit-space\" && player === myPlayer;\r\n\r\n    if (pipId === \"hit-space\") {\r\n      return isMyTurn && isFromMyHitSpace && hasPossibleMove;\r\n    }\r\n\r\n    return isMyTurn && hasPossibleMove;\r\n  };\r\n\r\n  const canInitRoll = () => {\r\n    const { pressedRoll, isExecutingRoll } = uiState;\r\n    const { stateMachine, initDiceRolled } = state;\r\n    const checks = [\r\n      !isExecutingRoll[myPlayer],\r\n      stateMachine === \"PENDING_INIT_ROLL\",\r\n      initDiceRolled[myPlayer] === -1,\r\n      !pressedRoll,\r\n    ];\r\n\r\n    return every(checks, identity);\r\n  };\r\n\r\n  const canRoll = () => {\r\n    const { stateMachine, diceRolled } = state;\r\n    const { pressedRoll, isExecutingRoll } = uiState;\r\n\r\n    const checks = [\r\n      isMyTurn,\r\n      !isExecutingRoll[myPlayer],\r\n      stateMachine === \"PENDING_ROLL\",\r\n      diceRolled.length === 0,\r\n      !pressedRoll,\r\n    ];\r\n    return every(checks, identity);\r\n  };\r\n\r\n  const canConfirmMove = () => {\r\n    const { pressedConfirm } = uiState;\r\n    const { stateMachine, diceRolled, positionTransitionsMap } = state;\r\n    const checks = [\r\n      isMyTurn,\r\n      !pressedConfirm,\r\n      stateMachine === \"PENDING_MOVE\",\r\n      diceRolled.length === 0 || positionTransitionsMap.length === 0,\r\n    ];\r\n\r\n    return every(checks, identity);\r\n  };\r\n\r\n  const canUndo = () => {\r\n    const { isExecutingMove, pressedUndo } = uiState;\r\n    const { stateMachine, diceRolled, plyRoll } = state;\r\n\r\n    const hasPlayedAtLeast1AtomicMove = plyRoll.length > diceRolled.length;\r\n\r\n    const checks = [\r\n      hasPlayedAtLeast1AtomicMove,\r\n      !pressedUndo,\r\n      isMyTurn,\r\n      stateMachine === \"PENDING_MOVE\",\r\n      !isExecutingMove,\r\n    ];\r\n\r\n    return every(checks, identity);\r\n  };\r\n\r\n  const areThereNonAvailableMoves = () => {\r\n    const nonAvailableMovesConsequence = Boolean(\r\n      find(consequences, {\r\n        type: \"NON_AVAILABLE_MOVES\",\r\n      })\r\n    );\r\n\r\n    return nonAvailableMovesConsequence;\r\n  };\r\n\r\n  const shouldShowDiceContainer = (player: PlayerType) => {\r\n    const { stateMachine, turn, initDiceRolled, diceRolled } = state;\r\n    const { isExecutingRoll } = uiState;\r\n\r\n    const isRolling = isExecutingRoll[player];\r\n\r\n    const check =\r\n      isRolling ||\r\n      stateMachine === \"PENDING_MOVE\" ||\r\n      (stateMachine === \"PENDING_INIT_ROLL\" && initDiceRolled[player] !== -1);\r\n\r\n    return check;\r\n  };\r\n\r\n  const getDiceMetadata = (player: PlayerType): DieContainerMetadata[] => {\r\n    const canShowDice = shouldShowDiceContainer(player);\r\n\r\n    if (!canShowDice) {\r\n      return [];\r\n    }\r\n\r\n    const { stateMachine, turn, initDiceRolled, diceRolled } = state;\r\n    const { isExecutingRoll } = uiState;\r\n\r\n    const isRolling = isExecutingRoll[player];\r\n    const nonAvailableMovesConsequence = find(consequences, {\r\n      type: \"NON_AVAILABLE_MOVES\",\r\n    });\r\n\r\n    if (stateMachine === \"PENDING_INIT_ROLL\") {\r\n      const sameRollConsequence = find(consequences, {\r\n        type: \"SAME_DIE_ROLLED\",\r\n      });\r\n\r\n      const finishedInitRollConsequence = find(consequences, {\r\n        type: \"FINISHED_INIT_ROLL\",\r\n      });\r\n\r\n      if (sameRollConsequence !== undefined) {\r\n        const { rolledDie } = sameRollConsequence.payload;\r\n\r\n        return [\r\n          {\r\n            nthDie: 0,\r\n            dieNum: rolledDie as number,\r\n          },\r\n        ];\r\n      }\r\n\r\n      if (finishedInitRollConsequence !== undefined) {\r\n        const { initDiceRolled } = finishedInitRollConsequence.payload;\r\n\r\n        const dieForPlayer = initDiceRolled[player];\r\n\r\n        return [\r\n          {\r\n            nthDie: 0,\r\n            dieNum: dieForPlayer,\r\n          },\r\n        ];\r\n      }\r\n\r\n      const initDie = initDiceRolled[player];\r\n      const hasInitRolled = initDie !== -1;\r\n      const dieMetadata: DieContainerMetadata = hasInitRolled\r\n        ? { nthDie: 0, dieNum: initDie }\r\n        : { nthDie: 0, dieNum: 1 }; // We just provide some starting num, it doesn't matter\r\n\r\n      return [dieMetadata];\r\n    }\r\n\r\n    if (isRolling) {\r\n      const resultingRoll =\r\n        nonAvailableMovesConsequence !== undefined\r\n          ? (nonAvailableMovesConsequence.payload.rolledDice as number[])\r\n          : times(2);\r\n\r\n      const diceMetadata: DieContainerMetadata[] = map(\r\n        resultingRoll,\r\n        (dieNum, nthDie) => ({\r\n          nthDie,\r\n          dieNum, // We just provide some starting num, it doesn't matter\r\n        })\r\n      );\r\n\r\n      return diceMetadata;\r\n    }\r\n\r\n    if (player === turn) {\r\n      const nonAvailableMovesConsequence = find(consequences, {\r\n        type: \"NON_AVAILABLE_MOVES\",\r\n      });\r\n\r\n      const resultingRoll =\r\n        nonAvailableMovesConsequence !== undefined\r\n          ? (nonAvailableMovesConsequence.payload.rolledDice as number[])\r\n          : diceRolled;\r\n\r\n      const diceMetadata: DieContainerMetadata[] = map(\r\n        resultingRoll,\r\n        (dieNum, nthDie) => ({\r\n          nthDie,\r\n          dieNum,\r\n        })\r\n      );\r\n\r\n      return diceMetadata;\r\n    }\r\n\r\n    return [];\r\n  };\r\n\r\n  const getUsernameByPlayer = (player: PlayerType) => {\r\n    const role = getNetworkRoleByPlayer(player);\r\n    const username =\r\n      role === \"HOST\" ? networkState.hostUsername : networkState.guestUsername;\r\n\r\n    return username || \"\";\r\n  };\r\n\r\n  const hasWin = () => {\r\n    const { stateMachine } = state;\r\n    return stateMachine === \"WIN\";\r\n  };\r\n\r\n  const whoWon = (): undefined | string => {\r\n    if (!hasWin()) {\r\n      return undefined;\r\n    }\r\n\r\n    const winningPlayer = maxBy(\r\n      map(\r\n        [PlayerTypeEnum.White, PlayerTypeEnum.Black],\r\n        (player: PlayerType) => ({\r\n          playerName: getUsernameByPlayer(player),\r\n          bearOffRank: state.bearOff[player],\r\n        })\r\n      ),\r\n      \"bearOffRank\"\r\n    )?.playerName;\r\n\r\n    return winningPlayer;\r\n  };\r\n\r\n  const shouldShowRematchInvitation = () => {\r\n    if (!hasWin()) {\r\n      return false;\r\n    }\r\n\r\n    const { hasPendingRematchInvitation } = roomsService;\r\n    return hasPendingRematchInvitation;\r\n  };\r\n\r\n  const canInviteForRematch = () => {\r\n    if (!hasWin()) {\r\n      return false;\r\n    }\r\n\r\n    const { isSendRematchInvitationLoading, hasPendingRematchInvitation } =\r\n      roomsService;\r\n\r\n    return !isSendRematchInvitationLoading && !hasPendingRematchInvitation;\r\n  };\r\n\r\n  return (\r\n    <InferenceContext.Provider\r\n      value={{\r\n        myPlayer,\r\n        isMyTurn,\r\n        canInviteForRematch,\r\n        shouldShowRematchInvitation,\r\n        canInitRoll,\r\n        canRoll,\r\n        canUndo,\r\n        canConfirmMove,\r\n        getHasPipMove,\r\n        getUsernameByPlayer,\r\n        areThereNonAvailableMoves: areThereNonAvailableMoves,\r\n        shouldShowDiceContainer,\r\n        getDiceMetadata,\r\n        hasWin,\r\n        whoWon,\r\n      }}\r\n    >\r\n      {children}\r\n    </InferenceContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useGameInference = (): InferenceContextValue => {\r\n  const context = useContext(InferenceContext);\r\n  return context;\r\n};\r\n","import React, { useContext, createContext, ReactElement } from \"react\";\r\nimport { find, some, cond, constant } from \"lodash\";\r\n\r\nimport { useGameState } from \"../game-state\";\r\nimport { useGameUI } from \"../game-ui\";\r\nimport { useGameInference } from \"../inference\";\r\n\r\nimport { Consequence, PlayerType } from \"../../types\";\r\n\r\nexport interface StatsContextValue {\r\n  inferLog: () => ReactElement | string;\r\n}\r\n\r\nexport const StatsContext = createContext({} as StatsContextValue);\r\n\r\nexport const StatsProvider: React.FC = ({ children }) => {\r\n  const { state, consequences } = useGameState();\r\n  const { uiState } = useGameUI();\r\n  const { areThereNonAvailableMoves, getUsernameByPlayer, hasWin, whoWon } =\r\n    useGameInference();\r\n\r\n  const hasSameDieRolledConsequence = () =>\r\n    some(consequences, {\r\n      type: \"SAME_DIE_ROLLED\",\r\n    });\r\n\r\n  const hasFinishedInitRollConsequence = () =>\r\n    some(consequences, {\r\n      type: \"FINISHED_INIT_ROLL\",\r\n    });\r\n\r\n  const inferLog = () =>\r\n    cond<undefined, string | ReactElement>([\r\n      [\r\n        hasWin,\r\n        constant(\r\n          <span style={{ color: \"greenyellow\" }}>\r\n            Player <label style={{ color: \"#ffd17a\" }}>{whoWon()}</label> has\r\n            won\r\n          </span>\r\n        ),\r\n      ],\r\n      [areThereNonAvailableMoves, constant(\"There are no moves available\")],\r\n      [\r\n        hasSameDieRolledConsequence,\r\n        constant(\"Same Die Rolled, please Roll Again\"),\r\n      ],\r\n      [\r\n        hasFinishedInitRollConsequence,\r\n        () => {\r\n          const consequence = find(consequences, {\r\n            type: \"FINISHED_INIT_ROLL\",\r\n          }) as Consequence;\r\n\r\n          return (\r\n            <span>\r\n              {getUsernameByPlayer(consequence.payload.turn)} had bigger roll,\r\n              he plays first\r\n            </span>\r\n          );\r\n        },\r\n      ],\r\n      [\r\n        () => state.stateMachine === \"PENDING_INIT_ROLL\",\r\n        constant(\"Waiting for init roll\"),\r\n      ],\r\n      [\r\n        () => uiState.isExecutingMove,\r\n        constant(\r\n          <span>\r\n            <label style={{ color: \"#ffd17a\" }}>\r\n              {getUsernameByPlayer(state.turn as PlayerType)}\r\n            </label>\r\n            's turn: Currently moving\r\n          </span>\r\n        ),\r\n      ],\r\n      [\r\n        () => state.stateMachine === \"PENDING_MOVE\",\r\n        constant(\r\n          <span>\r\n            <label style={{ color: \"#ffd17a\" }}>\r\n              {getUsernameByPlayer(state.turn as PlayerType)}{\" \"}\r\n            </label>\r\n            's turn: Waiting to move\r\n          </span>\r\n        ),\r\n      ],\r\n      [\r\n        () => uiState.isExecutingRoll[\"B\"] || uiState.isExecutingRoll[\"W\"],\r\n        constant(\r\n          <span>\r\n            <label style={{ color: \"#ffd17a\" }}>\r\n              {getUsernameByPlayer(state.turn as PlayerType)}{\" \"}\r\n            </label>\r\n            's turn: Currently rolling\r\n          </span>\r\n        ),\r\n      ],\r\n\r\n      [\r\n        () => state.stateMachine === \"PENDING_ROLL\",\r\n        constant(\r\n          <span>\r\n            <label style={{ color: \"#ffd17a\" }}>\r\n              {getUsernameByPlayer(state.turn as PlayerType)}\r\n            </label>{\" \"}\r\n            's turn: Waiting to roll\r\n          </span>\r\n        ),\r\n      ],\r\n    ])(undefined);\r\n\r\n  return (\r\n    <StatsContext.Provider\r\n      value={{\r\n        inferLog,\r\n      }}\r\n    >\r\n      {children}\r\n    </StatsContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useGameStats = (): StatsContextValue => {\r\n  const context = useContext(StatsContext);\r\n  return context;\r\n};\r\n","import axios from \"axios\";\r\nimport { API_URL } from \"../config\";\r\n// const API_URL = \"https://backgammoncloud-z3qxp.ondigitalocean.app/api/\";\r\n\r\nclass AuthService {\r\n  login(username: string, password: string) {\r\n    return axios\r\n      .post(API_URL + \"auth/signin\", {\r\n        username,\r\n        password\r\n      })\r\n      .then(response => {\r\n        if (response.data.accessToken) {\r\n          localStorage.setItem(\"user\", JSON.stringify(response.data));\r\n        }\r\n\r\n        return response.data;\r\n      });\r\n    }\r\n\r\n  logout() {\r\n    localStorage.removeItem(\"user\");\r\n  }\r\n\r\n  register(username: string, email: string, password: string, country: string, state: string, gender: string, birthday: string, role: string) {\r\n    return axios.post(API_URL + \"auth/signup\", {\r\n      username,\r\n      email,\r\n      password,\r\n      country,\r\n      state,\r\n      gender,\r\n      birthday, \r\n      role,\r\n    })\r\n    .then(response => {\r\n      if (response.data.accessToken) {\r\n        localStorage.setItem(\"user\", JSON.stringify(response.data));\r\n      }\r\n  \r\n      return response.data;\r\n    });\r\n  }\r\n\r\n  getCurrentUser() {\r\n    const userStr = localStorage.getItem(\"user\");\r\n    if (userStr) return JSON.parse(userStr);\r\n\r\n    return null;\r\n  }\r\n}\r\n\r\nexport default new AuthService();\r\n","const eventBus = {\r\n    on(event: string, callback: EventListener) {\r\n      document.addEventListener(event, (e) => callback(e));\r\n    },\r\n    dispatch(event: string, data?: any) {\r\n      document.dispatchEvent(new CustomEvent(event, { detail: data }));\r\n    },\r\n    remove(event: string, callback: EventListener) {\r\n      document.removeEventListener(event, callback);\r\n    },\r\n  };\r\n  \r\n  export default eventBus;\r\n  ","import styled from \"styled-components\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nexport const colors = {\r\n  brown300: \"#7f512f\",\r\n};\r\n\r\nexport const Lobby = styled.div`\r\n  background-image: url(/wood-texture.png);\r\n  height: calc(100vh - 56px);\r\n  padding: 10px;\r\n\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n`;\r\n\r\nexport const OptionsForm = styled.div`\r\n  box-shadow: 5px -3px 16px black;\r\n  background-image: url(/wood-board.jpg);\r\n  border-radius: 4px;\r\n  min-width: 500px;\r\n  max-width: 900px;\r\n  width: 30%;\r\n  height: 500px;\r\n  display: flex;\r\n  flex-direction: column;\r\n`;\r\n\r\nexport const Header = styled.div`\r\n  height: 40px;\r\n  border-bottom: 1px solid ${colors.brown300};\r\n  font-size: 19px;\r\n  font-style: italic;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  color: white;\r\n`;\r\n\r\nexport const Body = styled.div`\r\n  display: flex;\r\n  height: 100%;\r\n  opacity: 0.7;\r\n`;\r\n\r\nexport const OptionsContainer = styled.div`\r\n  box-sizing: border-box;\r\n  border-right: 1px solid ${colors.brown300};\r\n  border-radius: 4px;\r\n  border-top-right-radius: 0px;\r\n  border-bottom-right-radius: 0px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  width: 30%;\r\n  min-width: 170px;\r\n`;\r\n\r\nexport const Option = styled.div<{ isSelected: boolean }>`\r\n  height: 40px;\r\n  font-size: 13px;\r\n\r\n  color: white;\r\n  padding: 0px 15px;\r\n  display: flex;\r\n\r\n  align-items: center;\r\n\r\n  transition: background-color 0.3s ease-out;\r\n  user-select: none;\r\n  cursor: pointer;\r\n\r\n  &:hover {\r\n    background-color: ${colors.brown300};\r\n  }\r\n\r\n  ${({ isSelected }) =>\r\n    isSelected &&\r\n    `background-color: ${colors.brown300};\r\n  `}\r\n`;\r\n\r\nexport const RightContainer = styled.div`\r\n  flex: 1;\r\n  height: 100%;\r\n  box-sizing: border-box;\r\n`;\r\n\r\nexport const StyledLink = styled(Link)`\r\n  text-decoration: none !important;\r\n`;\r\n","import styled from \"styled-components\";\r\nimport { colors } from \"../styles\";\r\n\r\nexport const Container = styled.div`\r\n`;\r\n\r\nexport const Title = styled.h3`\r\n  color: white;\r\n  height: 32px;\r\n  font-size: 1rem;\r\n  margin: 0px;\r\n  padding: 0px;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  font-weight: 600;\r\n  border-bottom: 1px solid ${colors.brown300};\r\n`;\r\n\r\nexport const Body = styled.div`\r\n  padding: 10px;\r\n`;\r\n\r\nexport const Paragraph = styled.p`\r\n  font-size: 13px;\r\n  color: white;\r\n`;\r\n\r\nexport const Button = styled.button`\r\n  border-radius: 4px;\r\n  border: none;\r\n  outlone: none;\r\n  background-color: ${colors.brown300};\r\n  color: white;\r\n  border: 2px solid black;\r\n  cursor: pointer;\r\n  transition: backround-color 0.5s ease-in;\r\n\r\n  &:hover:not(:disabled) {\r\n    background-color: orange;\r\n  }\r\n\r\n  &:disabled {\r\n    cursor: not-allowed;\r\n    opacity: 0.7;\r\n  }\r\n`;\r\n\r\nexport const ControlWrapper = styled.div`\r\n  display: flex;\r\n  padding: 10px;\r\n`;\r\n\r\nexport const ErrorWrapper = styled.label`\r\n  background-color: #fa4f4f;\r\n  font-size: 13px;\r\n  color: white;\r\n  border-radius: 4px;\r\n  padding: 8px 16px;\r\n  font-weight: 700;\r\n  font-style: italic;\r\n`;\r\n","import styled from \"styled-components\";\r\n\r\nimport { colors } from \"../../styles\";\r\n\r\nexport const TextBox = styled.input`\r\n  outline: none;\r\n  border: none;\r\n  padding: 0px;\r\n  margin: 0px;\r\n  box-sizing: border-box;\r\n  border: 1px solid transparent;\r\n  border-radius: 4px;\r\n  display: block;\r\n  color: white;\r\n  background-color: ${colors.brown300};\r\n  height: 30px;\r\n  padding: 4px 8px;\r\n  transition: opacity, border-color 0.3s ease-in;\r\n  opacity: 1;\r\n\r\n  &::placeholder {\r\n    color: #8fe6d6;\r\n    font-style: italic;\r\n    opacity: 1;\r\n  }\r\n\r\n  &:focus {\r\n    border: 1px solid white;\r\n    opacity: 0.9;\r\n  }\r\n`;\r\n","import React, { useState, useEffect } from \"react\";\r\n\r\n//styles\r\nimport { TextBox } from \"./styles\";\r\n\r\ninterface Props {\r\n  width?: string;\r\n  defaultValue?: string | undefined;\r\n  value?: string | undefined;\r\n  type?: any;\r\n  placeholder?: string;\r\n  onChange: (value: string) => void;\r\n}\r\n\r\nconst TextBoxComponent: React.FC<Props> = ({\r\n  defaultValue,\r\n  value,\r\n  onChange,\r\n  width = \"250px\",\r\n  type = \"text\",\r\n  placeholder = \"\",\r\n}) => {\r\n  const [currentValue, setCurrentValue] = useState<string | undefined>(\r\n    defaultValue\r\n  );\r\n\r\n  useEffect(() => {\r\n    setCurrentValue(value);\r\n  }, [value]);\r\n\r\n  const handleChange = (e: any) => {\r\n    const {\r\n      target: { value: newValue },\r\n    } = e;\r\n\r\n    setCurrentValue(newValue);\r\n    onChange(newValue);\r\n  };\r\n\r\n  return (\r\n    <TextBox\r\n      type={type}\r\n      style={{ width }}\r\n      placeholder={placeholder}\r\n      value={currentValue || \"\"}\r\n      onChange={handleChange}\r\n    />\r\n  );\r\n};\r\n\r\nexport default TextBoxComponent;\r\n","import React from \"react\";\r\nimport { useNetworkManager } from \"../../../game-manager/network-manager\";\r\nimport { CreateRoomForm } from \"../../../game-manager/network-manager/hooks/useRooms\";\r\n//styles\r\nimport { Container, Title, Body, Button, ControlWrapper } from \"../ui/styles\";\r\n\r\n//components\r\nimport TextBox from \"../ui/textbox\";\r\n\r\ninterface Props {}\r\n\r\nconst isFormValid = (form: CreateRoomForm): boolean =>\r\n  [form.roomName].some(\r\n    (it) => it === undefined || it === \"\"\r\n  );\r\n\r\nconst CreateGameComponent: React.FC<Props> = () => {\r\n  const { emitterService, roomsService } = useNetworkManager();\r\n\r\n  const {\r\n    isCreatingRoom,\r\n    updateCreateRoomForm,\r\n    createRoomForm,\r\n    setIsCreatingRoom,\r\n  } = roomsService;\r\n\r\n  const syncField = (key: keyof CreateRoomForm, value: string) => {\r\n    updateCreateRoomForm({\r\n      ...createRoomForm,\r\n      [key]: value,\r\n    });\r\n  };\r\n\r\n  const isCreateDisabled =\r\n    isFormValid(roomsService.createRoomForm) || isCreatingRoom;\r\n\r\n  const onCreate = () => {\r\n    setIsCreatingRoom(true);\r\n\r\n    const { roomName } = createRoomForm;\r\n\r\n    emitterService.createRoom(\r\n      // roomNumber as string,\r\n      roomName as string\r\n    );\r\n  };\r\n\r\n  return (\r\n    <Container>\r\n      <Title>Create New Game</Title>\r\n      <Body>\r\n        {/* <ControlWrapper>\r\n          <TextBox\r\n            width=\"100%\"\r\n            placeholder=\"Room Number\"\r\n            defaultValue=\"\"\r\n            value={createRoomForm.roomNumber}\r\n            onChange={(value) => syncField(\"roomNumber\", value)}\r\n          />\r\n        </ControlWrapper> */}\r\n        <ControlWrapper>\r\n          <TextBox\r\n            width=\"100%\"\r\n            placeholder=\"Roomname\"\r\n            defaultValue=\"\"\r\n            value={createRoomForm.roomName}\r\n            onChange={(value) => syncField(\"roomName\", value)}\r\n          />\r\n        </ControlWrapper>\r\n        <ControlWrapper style={{ flexDirection: \"row-reverse\" }}>\r\n          <Button\r\n            style={{ height: \"32px\" }}\r\n            disabled={isCreateDisabled}\r\n            onClick={() => onCreate()}\r\n          >\r\n            {isCreatingRoom ? \"Creating\" : \"Create Game\"}\r\n          </Button>\r\n        </ControlWrapper>\r\n      </Body>\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default CreateGameComponent;\r\n","import styled from \"styled-components\";\r\nimport { Body } from \"../ui/styles\";\r\n\r\nimport { colors } from \"../styles\";\r\n\r\nexport const StyledBody = styled(Body)`\r\n  display: flex;\r\n  flex-direction: column;\r\n  max-height: 300px;\r\n`;\r\n\r\nexport const GameItems = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n  height: 100%;\r\n  overflow-y: auto;\r\n`;\r\n\r\nexport const ItemWrapper = styled.div<{ isExpanded: boolean }>`\r\n  margin-bottom: 20px;\r\n  padding: 4px;\r\n  border: 1px solid transparent;\r\n\r\n  transition: border-color 0.3s ease-out;\r\n\r\n  ${({ isExpanded }) => isExpanded && `border-color: gray;`}\r\n`;\r\n\r\nexport const Item = styled.div`\r\n  box-shadow: 5px -3px 16px black;\r\n  height: 28px;\r\n  border-radius: 4px;\r\n  padding: 0px 8px;\r\n  user-select: none;\r\n  background-color: ${colors.brown300};\r\n  margin-bottom: 4px;\r\n  display: flex;\r\n\r\n  &:hover {\r\n    opacity: 0.7;\r\n  }\r\n  cursor: pointer;\r\n`;\r\n\r\nexport const ItemSection = styled.section`\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  flex: 1;\r\n\r\n  & input {\r\n    height: 90%;\r\n    width: 100%;\r\n  }\r\n`;\r\n\r\nexport const ItemLabel = styled.label`\r\n  display: inline-block;\r\n  font-size: 13px;\r\n  font-weight: 700;\r\n  min-width: 80px;\r\n  color: white;\r\n`;\r\n\r\nexport const Badge = styled.label`\r\n  color: #9de7ec;\r\n  font-size: 13px;\r\n  font-weight: 600;\r\n`;\r\n\r\nexport const Form = styled.div``;\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { useNetworkManager } from \"../../../game-manager/network-manager\";\r\nimport { JoinRoomForm } from \"../../../game-manager/network-manager/hooks/useRooms\";\r\nimport AuthService from \"../../../../services/auth.service\";\r\n\r\nimport {\r\n  Container,\r\n  Title,\r\n  Body,\r\n  Button,\r\n  ControlWrapper,\r\n  ErrorWrapper,\r\n} from \"../ui/styles\";\r\n\r\nimport {\r\n  StyledBody,\r\n  GameItems,\r\n  ItemWrapper,\r\n  Item,\r\n  ItemSection,\r\n  ItemLabel,\r\n} from \"./styles\";\r\n\r\n//components\r\nimport { IError } from \"../../../game-manager/network-manager/types\";\r\n\r\ninterface Props {}\r\n\r\n\r\nconst getErrorMessage = (error: IError) => {\r\n  const { errorType, payload } = error;\r\n\r\n  switch (errorType) {\r\n    case \"PASSWORD_NOT_PRESENT\":\r\n      return `There was no password for room named: ${payload.roomName}`;\r\n    case \"PASSWORD_NOT_VALID\":\r\n      return `Password for room '${payload.roomName}' was not valid. Please try again.`;\r\n    default:\r\n      return \"Some error happened\";\r\n  }\r\n};\r\n\r\nconst JoinGameComponent: React.FC<Props> = () => {\r\n  const [expandedRoomId, setExpandedRoom] = useState<string | undefined>(\r\n    undefined\r\n  );\r\n  const { emitterService, roomsService } = useNetworkManager();\r\n  const [username, setUsername] = useState(\"\");\r\n\r\n  const {\r\n    rooms,\r\n    isLoading,\r\n    isJoiningRoom,\r\n    updateJoinRoomForm,\r\n    joinRoomForm,\r\n    setIsJoiningRoom,\r\n    error,\r\n  } = roomsService;\r\n\r\n  useEffect(() => {\r\n    setUsername(AuthService.getCurrentUser().username);\r\n    emitterService.getRooms();\r\n    console.log(!username);\r\n    return () => {\r\n      roomsService.setRooms([]);\r\n      roomsService.setIsJoiningRoom(false);\r\n      roomsService.setError(undefined);\r\n    };\r\n  }, []);\r\n\r\n  const syncField = (key: keyof JoinRoomForm, value: string) => {\r\n    updateJoinRoomForm({\r\n      ...joinRoomForm,\r\n      [key]: value,\r\n    });\r\n  };\r\n\r\n  const onJoin = (roomId: string) => {\r\n    console.log(\"trying to join\", roomId);\r\n    setIsJoiningRoom(true);\r\n\r\n    emitterService.joinRoom(roomId, username as string);\r\n  };\r\n\r\n  const isJoinDisabled =\r\n    (!username) || isJoiningRoom;\r\n\r\n  const errorMessage = error === undefined ? undefined : getErrorMessage(error);\r\n\r\n  return (\r\n    <Container>\r\n      <Title>Available Rooms ({isLoading ? \"Loading\" : \"Up to date\"})</Title>\r\n      <StyledBody>\r\n        <GameItems>\r\n          {rooms.map((game) => (\r\n            <ItemWrapper key={game.id} isExpanded={expandedRoomId === game.id}>\r\n              <Item\r\n                onClick={() =>\r\n                  setExpandedRoom((current) =>\r\n                    current !== game.id ? game.id : undefined\r\n                  )\r\n                }\r\n              >\r\n                <ItemSection>\r\n                  <ItemLabel>{game.name}</ItemLabel>\r\n                </ItemSection>\r\n              </Item>\r\n\r\n              {game.id === expandedRoomId && (\r\n                <Container>\r\n                  <Body>\r\n\r\n                    {errorMessage && (\r\n                      <ControlWrapper>\r\n                        <ErrorWrapper>{errorMessage}</ErrorWrapper>\r\n                      </ControlWrapper>\r\n                    )}\r\n                    <ControlWrapper style={{ flexDirection: \"row-reverse\" }}>\r\n                      <Button\r\n                        style={{ height: \"32px\" }}\r\n                        disabled={isJoinDisabled}\r\n                        onClick={() => onJoin(game.id)}\r\n                      >\r\n                        {isJoiningRoom\r\n                          ? \"Joining Room\"\r\n                          : `Join Room ${game.name}`}\r\n                      </Button>\r\n                    </ControlWrapper>\r\n                  </Body>\r\n                </Container>\r\n              )}\r\n            </ItemWrapper>\r\n          ))}\r\n        </GameItems>\r\n      </StyledBody>\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default JoinGameComponent;\r\n","import React, { useState, useEffect } from \"react\";\r\nimport { useLocation } from \"react-router-dom\";\r\nimport AuthService from \"../../../services/auth.service\";\r\n\r\nimport {\r\n  Lobby,\r\n  OptionsForm,\r\n  Header,\r\n  Body,\r\n  OptionsContainer,\r\n  Option,\r\n  RightContainer,\r\n  StyledLink,\r\n} from \"./styles\";\r\n\r\n//components\r\nimport CreateGame from \"./create-game\";\r\nimport JoinGame from \"./join-game\";\r\n\r\ninterface Props {}\r\n\r\nconst LobbyComponent: React.FC<Props> = () => {\r\n  const location = useLocation();\r\n  const [currentUserRole, setCurrentUserRole] = useState(\"\");\r\n  const [selectedOptionId, setSelectedOptionId] = useState<string | undefined>(\r\n    undefined\r\n  );\r\n\r\n  useEffect(() => {\r\n    setCurrentUserRole(AuthService.getCurrentUser().role);\r\n  }, []);\r\n\r\n\r\n  return (\r\n    <Lobby>\r\n      <OptionsForm>\r\n        <Body>\r\n          <RightContainer>\r\n            {(currentUserRole === \"ROLE_ADMIN\") ? (\r\n            <CreateGame />) : (<JoinGame />)}\r\n          </RightContainer>\r\n        </Body>\r\n      </OptionsForm>\r\n    </Lobby>\r\n  );\r\n};\r\n\r\nexport default LobbyComponent;\r\n","import React from \"react\";\r\n\r\nimport styled from \"styled-components\";\r\n\r\nimport Lobby from \"../../game/components/lobby\";\r\n\r\nconst LobbyPage: React.FC = () => (\r\n  <Page>\r\n    <Lobby />\r\n  </Page>\r\n);\r\n\r\nconst Page = styled.div``;\r\n\r\nexport default LobbyPage;\r\n","import styled, { keyframes, css } from \"styled-components\";\r\nimport { DIMENSIONS_CONFIG } from \"../constants\";\r\nimport { Position } from \"../../types\";\r\n\r\nconst { ACTIVE_CHECKER_RATIO, BEAROFF_CHECKER_RATIO } = DIMENSIONS_CONFIG;\r\n\r\nconst animateMove = (targetPosition: Position) => keyframes`\r\n  0% {\r\n    z-index: 2;\r\n  }\r\n  100% {\r\n    left: ${targetPosition.left}px;\r\n    top: ${targetPosition.top}px;\r\n    z-index: 2;\r\n  }\r\n`;\r\n\r\nconst blinkChecker = () => keyframes`\r\n  0% {\r\n    background: linear-gradient(-30deg, rgb(22 206 122), rgb(116 125 133));\r\n    // background: linear-gradient(-30deg, rgb(0 206 55), rgb(16 25 133));\r\n  }\r\n  100% {\r\n  \r\n    background: linear-gradient(-30deg, rgb(22 206 122), rgb(116 125 133));\r\n  }\r\n`;\r\n\r\nconst bounceChecker = () => keyframes`\r\n  0% {\r\n    transform: scale(1);\r\n    // border: 2px solid white;\r\n  }\r\n  100% {\r\n  \r\n    transform: scale(1.1);\r\n    // border: 2px solid orange;\r\n  }\r\n`;\r\n\r\nexport const CheckerInner = styled.div<{ player: any }>`\r\n  border-radius: 50%;\r\n  width: 80%;\r\n  height: 80%;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n\r\n  font-size: 24px;\r\n  font-weight: bold;\r\n\r\n  color: ${({ player }) => (player === \"W\" ? \"black\" : \"white\")};\r\n`;\r\n\r\nexport const Checker = styled.div<{\r\n  animationMetadata?: any;\r\n  player: any;\r\n  checkerNum: number;\r\n  shouldAnimate: boolean;\r\n  canBeSelected: boolean;\r\n  hasMove: boolean;\r\n  isBearOffChecker: boolean;\r\n  isSelected: boolean;\r\n}>`\r\n  z-index: 1;\r\n  border-radius: 50%; \r\n  transition: background 1s ease-in;\r\n  box-sizing: border-box;\r\n\r\n\r\n  ${({ theme: { dimensions } }) => `\r\n    width: ${dimensions.width * ACTIVE_CHECKER_RATIO}px;\r\n    height: ${dimensions.width * ACTIVE_CHECKER_RATIO}px;\r\n    `};\r\n\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  position: relative;\r\n \r\n  left: 0px;\r\n  top: 0px;\r\n\r\n  margin: auto;\r\n  margin-top: 0px;\r\n  margin-bottom: 0px;\r\n   ${({ animationMetadata, shouldAnimate }) =>\r\n     animationMetadata &&\r\n     shouldAnimate &&\r\n     css`\r\n       animation: ${animateMove({\r\n           left: animationMetadata.left,\r\n           top: animationMetadata.top,\r\n         })}\r\n         ${animationMetadata.duration}s cubic-bezier(0.91, 1, 0.61, 0.95);\r\n       animation-fill-mode: forwards;\r\n     `};}\r\n\r\n  \r\n  ${({ player }) =>\r\n    player === \"W\"\r\n      ? ` \r\n \r\n      background: linear-gradient(-30deg, rgb(0, 0, 0), rgb(200, 230, 255));\r\n      & ${CheckerInner} {\r\n        background: linear-gradient(0deg, rgb(196 219 237) 0%, rgb(39 23 12 / 79%) 100%);\r\n      }`\r\n      : `\r\n      background: linear-gradient(13deg ,rgb(9 10 10),rgb(116 125 133));\r\n      & ${CheckerInner} {\r\n       background: linear-gradient(235deg, rgb(25 26 27 / 91%) 0%,rgb(160 155 151 / 79%) 100%);\r\n      }}`}\r\n\r\n\r\n      ${({ hasMove }) =>\r\n        hasMove &&\r\n        css`\r\n          animation: ${blinkChecker()} 0.5s ease-out infinite alternate;\r\n          // background: linear-gradient(-30deg, rgb(22 206 122), rgb(116 125 133));\r\n          cursor: pointer;\r\n        `}\r\n   \r\n    ${({ isBearOffChecker, theme: { dimensions } }) =>\r\n      isBearOffChecker &&\r\n      `\r\n      border-radius: 4px;\r\n      \r\n      height: ${\r\n        dimensions.width * ACTIVE_CHECKER_RATIO * BEAROFF_CHECKER_RATIO\r\n      }px;\r\n    `}\r\n  \r\n\r\n    ${({ isSelected }) =>\r\n      isSelected &&\r\n      css`\r\n        border: 1px solid black;\r\n        // animation: ${bounceChecker()} 0.3s ease-out infinite alternate;\r\n      `}\r\n\r\n`;\r\n","import React from \"react\";\r\nimport { Checker, CheckerInner } from \"./styles\";\r\n\r\nimport { useGameUI, SelectedCheckerMetadata } from \"../../game-manager/game-ui\";\r\nimport { PlayerType } from \"../../types\";\r\nimport { getConditionalClassnames } from \"../../utils\";\r\n\r\ninterface Props {\r\n  player: PlayerType;\r\n  pipNum?: number | \"hit-space\";\r\n  checkerNum: number;\r\n  isHitChecker?: boolean;\r\n  isBearOffChecker?: boolean;\r\n  canBeHit?: boolean;\r\n  canBeSelected: boolean;\r\n  hasMove: boolean;\r\n  countIndicator: number | undefined;\r\n}\r\n\r\nconst CheckerComponent: React.FC<Props> = ({\r\n  player,\r\n  pipNum,\r\n  checkerNum,\r\n  canBeSelected,\r\n  isHitChecker = false,\r\n  countIndicator,\r\n  canBeHit = false,\r\n  hasMove = false,\r\n  isBearOffChecker = false,\r\n}) => {\r\n  const { uiState, updateUiState, animations } = useGameUI();\r\n  const { moveChecker: moveCheckerAnimations } = animations;\r\n  const { selectedChecker } = uiState;\r\n  const classNames = getConditionalClassnames([\r\n    { when: true, value: \"checker\" },\r\n    { when: player !== undefined, value: player },\r\n    { when: canBeSelected, value: \"can-be-selected\" },\r\n    { when: canBeHit, value: \"can-be-hit\" },\r\n  ]);\r\n\r\n  const moveCheckerAnimation = moveCheckerAnimations.find(\r\n    (animation) =>\r\n      (animation.pipNum !== undefined && animation.pipNum === pipNum) ||\r\n      (animation.isHitSpaceMove && isHitChecker && animation.player === player)\r\n  );\r\n\r\n  const shouldAnimate = moveCheckerAnimation !== undefined && canBeSelected;\r\n\r\n  const onSelect = (e: any) => {\r\n    if (hasMove) {\r\n      e.stopPropagation();\r\n\r\n      const { selectedChecker } = uiState;\r\n      const nextSelectedChecker: SelectedCheckerMetadata | undefined =\r\n        selectedChecker?.pipId === pipNum\r\n          ? undefined\r\n          : {\r\n              ...selectedChecker,\r\n              pipId: pipNum === undefined ? \"hit-space\" : pipNum,\r\n            };\r\n\r\n      const el = document.querySelector(\r\n        \"#play-select-checker\"\r\n      ) as HTMLButtonElement;\r\n\r\n      el.click();\r\n      updateUiState({ ...uiState, selectedChecker: nextSelectedChecker });\r\n    }\r\n  };\r\n\r\n  const shouldTransformToBearOffChecker =\r\n    isBearOffChecker ||\r\n    (shouldAnimate && Boolean(moveCheckerAnimation?.isBearOffMove));\r\n\r\n  const shouldShowInner = !shouldTransformToBearOffChecker;\r\n\r\n  const isSelected = canBeSelected && selectedChecker?.pipId === pipNum;\r\n\r\n  return (\r\n    <Checker\r\n      className={classNames}\r\n      onMouseDown={hasMove ? onSelect : undefined}\r\n      player={player}\r\n      checkerNum={checkerNum}\r\n      shouldAnimate={shouldAnimate}\r\n      animationMetadata={moveCheckerAnimation}\r\n      canBeSelected={canBeSelected}\r\n      hasMove={hasMove && !shouldAnimate}\r\n      isBearOffChecker={shouldTransformToBearOffChecker}\r\n      isSelected={isSelected}\r\n    >\r\n      {shouldShowInner && (\r\n        <CheckerInner player={player}>\r\n          {!shouldAnimate && countIndicator}\r\n        </CheckerInner>\r\n      )}\r\n    </Checker>\r\n  );\r\n};\r\n\r\nexport default CheckerComponent;\r\n","import styled from \"styled-components\";\r\nimport { Dimensions } from \"../../types\";\r\nimport { DIMENSIONS_CONFIG } from \"../constants\";\r\n\r\nexport type Side = \"W\" | \"S\" | \"E\" | \"N\" | \"CENTER\" | \"BEAROFF\";\r\n\r\nconst { BAR_TICKNESS_RATIO, CENTER_BAR_TICKNESS_RATIO, BEAROFF_BAR_RATIO } =\r\n  DIMENSIONS_CONFIG;\r\n\r\nconst calculateWoodBoxStyles = (side: Side, dimensions: Dimensions): string => {\r\n  switch (side) {\r\n    case \"W\":\r\n      return `\r\n        left: 0px;\r\n        top: 0px;\r\n        width: ${dimensions.width * BAR_TICKNESS_RATIO}px;\r\n        height: 100%;\r\n        box-shadow: 9px 3px 8px #2c1c1c;\r\n        z-index: 1;\r\n      `;\r\n    case \"N\":\r\n      return `\r\n        left: 0px;\r\n        top: 0px;\r\n        width: 100%;\r\n        height: ${dimensions.height * BAR_TICKNESS_RATIO}px;\r\n    `;\r\n    case \"S\":\r\n      return `\r\n        left: 0px;\r\n        bottom: 0px;\r\n        width: 100%;\r\n        height: ${dimensions.height * BAR_TICKNESS_RATIO}px;\r\n        `;\r\n    case \"E\":\r\n      return `\r\n        border-right: none;\r\n        border-radius: 0px;\r\n        right: 0px;\r\n        top: 0px;\r\n        width: ${dimensions.width * BAR_TICKNESS_RATIO}px;\r\n        height: 100%;\r\n        `;\r\n    case \"CENTER\":\r\n      return `\r\n        border-radius: 0px;\r\n        left: calc(50% - ${dimensions.width * CENTER_BAR_TICKNESS_RATIO}px / 2);\r\n        top: ${dimensions.height * BAR_TICKNESS_RATIO}px;\r\n        width: ${dimensions.width * CENTER_BAR_TICKNESS_RATIO}px;\r\n        height: calc(100% - ${dimensions.height * BAR_TICKNESS_RATIO * 2}px);\r\n        border-bottom: none;\r\n        border-top: none;\r\n        display: flex;\r\n        flex-direction: column;\r\n      `;\r\n    case \"BEAROFF\":\r\n      return `\r\n        border: none;\r\n        // border-right: 1px solid black;\r\n        // border-top: 1px solid black;\r\n        border-radius: 0px;\r\n        right: 0px;\r\n        top: 0px;\r\n        width: ${dimensions.width * BEAROFF_BAR_RATIO - 0}px;\r\n        height: 100%;\r\n        display: flex;\r\n        flex-direction: column;\r\n          `;\r\n  }\r\n};\r\n\r\nexport const ActiveSection = styled.div`\r\n  border-radius: 4px;\r\n  position: relative;\r\n  ${({ theme: { dimensions } }) => `\r\n  width: ${dimensions.width - BEAROFF_BAR_RATIO * dimensions.width}px;\r\n  height: ${dimensions.height}px;\r\n`}\r\n`;\r\n\r\nexport const Board = styled.div`\r\n  border-radius: 4px;\r\n  position: relative;\r\n  box-shadow: 10px -8px 18px black;\r\n  ${({ theme }) => `\r\n    width: ${theme.dimensions.width}px;\r\n    height: ${theme.dimensions.height}px;\r\n  `};\r\n`;\r\n\r\nexport const WoodBar = styled.div<{ side: Side }>`\r\n  background-image: url(/wood-board.jpg);\r\n  position: absolute;\r\n  border: 1px solid black;\r\n  border: none;\r\n  border-radius: 4px;\r\n  box-sizing: border-box;\r\n  ${({ side, theme }) => calculateWoodBoxStyles(side, theme.dimensions)};\r\n`;\r\n\r\nexport const PlaygroundContainer = styled.div<{\r\n  side: \"left\" | \"right\";\r\n}>`\r\n  position: absolute;\r\n  box-sizing: border-box;\r\n  background-color: #1dc6dc;\r\n  width: ${({ theme }) =>\r\n    `calc(50% - (${theme.dimensions.width * BAR_TICKNESS_RATIO}px + ${\r\n      (theme.dimensions.width * CENTER_BAR_TICKNESS_RATIO) / 2\r\n    }px))`};\r\n  height: ${({ theme }) =>\r\n    `calc(100% - ${theme.dimensions.height * BAR_TICKNESS_RATIO * 2}px)`};\r\n\r\n  ${({ theme, side }) =>\r\n    `${side}:${theme.dimensions.width * BAR_TICKNESS_RATIO}px`};\r\n\r\n  top: ${({ theme }) => `\r\n    ${theme.dimensions.height * BAR_TICKNESS_RATIO}px;\r\n  `};\r\n  display: flex;\r\n  flex-direction: column;\r\n`;\r\n\r\nexport const Cylinder = styled.div`\r\n  box-shadow: -10px -8px 22px black;\r\n  border: 1px solid black;\r\n  border-radius: 4px;\r\n  box-sizing: border-box;\r\n  background-color: #0200006b;\r\n\r\n  height: 40%;\r\n  width: 90%;\r\n  margin-top: 20px;\r\n`;\r\n\r\nexport const Ruler = styled.div`\r\n  width: 2px;\r\n  height: 100%;\r\n\r\n  position: absolute;\r\n  top: 0px;\r\n  left: calc(50% - 1px);\r\n  background-color: black;\r\n  position: relative;\r\n`;\r\n\r\nexport const Pips = styled.div`\r\n  // background-image: url(/wood-board.jpg);\r\n\r\n  // width: 700%;\r\n  // height: 10%;\r\n  // position: absolute;\r\n  // top: 10%;\r\n  // left: -350%;\r\n  // border-radius: 4px;\r\n`;\r\n","import styled from \"styled-components\";\r\n\r\nexport const Quadrant = styled.div<{ quadrantNum: number }>`\r\n  background-image: url(/wood-t.jpg);\r\n\r\n  width: 100%;\r\n  height: 50%;\r\n  display: flex;\r\n  box-sizing: border-box;\r\n\r\n  &:nth-child(even) {\r\n    align-items: flex-end;\r\n  }\r\n\r\n  ${({ quadrantNum }) =>\r\n    [0, 1].includes(quadrantNum) &&\r\n    `\r\n    flex-direction: row-reverse;\r\n  `}\r\n`;\r\n","import styled from \"styled-components\";\r\nimport { DIMENSIONS_CONFIG } from \"../constants\";\r\n\r\nconst { ACTIVE_CHECKER_RATIO } = DIMENSIONS_CONFIG;\r\n\r\nexport const renderPipTriangle = (metadata: any) => {\r\n  const styles: any = {};\r\n\r\n  if (metadata.even) {\r\n    // styles.backgroundColor = \"#c1a47fa1\";\r\n    styles.backgroundColor = \"#533713a1\";\r\n  } else {\r\n    // styles.backgroundColor = \"#75502a8c\";\r\n    styles.backgroundColor = \"#211b26a1\";\r\n  }\r\n\r\n  if ([0, 1].includes(metadata.quadrantNum)) {\r\n    styles.transform = `rotate(180deg)`;\r\n  }\r\n\r\n  return styles;\r\n};\r\n\r\nexport const PipWrapper = styled.div`\r\n  border-radius: 4px;\r\n  transition: background 0.7s ease-out;\r\n  box-sizing: border-box;\r\n  flex: 1;\r\n  height: 88%;\r\n  border-left: none;\r\n  position: relative;\r\n`;\r\n\r\nexport const Triangle = styled.div<{ metadata: any; shouldHighlight: boolean }>`\r\n  clip-path: polygon(50% 0%, 0% 100%, 100% 100%);\r\n  width: 100%;\r\n  height: 100%;\r\n  position: absolute;\r\n  transform: opacity 0.2s ease-out;\r\n  ${({ metadata }) => renderPipTriangle(metadata)};\r\n\r\n  transition: background-color 0.5s ease-out;\r\n  ${({ shouldHighlight }) =>\r\n    shouldHighlight &&\r\n    `\r\n    background-color: #7db53c;\r\n  `}\r\n`;\r\n\r\nexport const CheckerStack = styled.div<{ quadrantNum: number }>`\r\n  background-color: transparent;\r\n  width: 100%;\r\n  height: 100%;\r\n  position: relative;\r\n\r\n  display: flex;\r\n  flex-direction: column;\r\n\r\n  ${({ quadrantNum }) =>\r\n    [2, 3].includes(quadrantNum)\r\n      ? `\r\n    flex-direction: column-reverse;\r\n  `\r\n      : \"\"}\r\n`;\r\n\r\nexport const PositionHandle = styled.div`\r\n  width: ${({ theme }) => theme.dimensions.width * ACTIVE_CHECKER_RATIO}px;\r\n  height: ${({ theme }) => theme.dimensions.width * ACTIVE_CHECKER_RATIO}px;\r\n  background-color: black;\r\n  margin: 0px auto;\r\n  visibility: hidden;\r\n`;\r\n","import React from \"react\";\r\nimport times from \"lodash/times\";\r\nimport nth from \"lodash/nth\";\r\nimport find from \"lodash/find\";\r\n\r\n//types\r\nimport {\r\n  Pip,\r\n  PlayerType,\r\n  PositionTransitionEntry,\r\n  PositionTransition,\r\n} from \"../../types\";\r\n\r\n//hooks\r\nimport { useGameState } from \"../../game-manager/game-state\";\r\nimport { useNetworkManager } from \"../../game-manager/network-manager\";\r\nimport { useGameUI } from \"../../game-manager/game-ui\";\r\nimport { useGameInference } from \"../../game-manager/inference\";\r\n\r\n//utils\r\nimport { pipRefs } from \"../../dom-refs\";\r\nimport { isThereMoveOnPipPosition } from \"../../utils/backgammon\";\r\n\r\n//styles\r\nimport { PipWrapper, Triangle, CheckerStack, PositionHandle } from \"./styles\";\r\n\r\n//components\r\nimport Checker from \"../checker\";\r\n\r\nconst MAX_CHECKERS_SHOWN = 5;\r\n\r\ninterface Props {\r\n  pipNumber: number;\r\n  quadrantNum: number;\r\n}\r\n\r\nconst PipComponent: React.FC<Props> = ({ pipNumber, quadrantNum }) => {\r\n  const { state } = useGameState();\r\n  const { emitterService } = useNetworkManager();\r\n  const { getHasPipMove } = useGameInference();\r\n\r\n  const { uiState, updateUiState } = useGameUI();\r\n  const { selectedChecker, isExecutingMove } = uiState;\r\n  const { positionTransitionsMap } = state || {};\r\n  const currentPipState = nth(state?.pips, pipNumber) as Pip;\r\n\r\n  const currentCount = currentPipState?.count || 0;\r\n\r\n  const checkersIterator = currentPipState?.isEmpty\r\n    ? []\r\n    : times(currentCount).slice(0, MAX_CHECKERS_SHOWN);\r\n\r\n  const countIndicator =\r\n    currentCount > MAX_CHECKERS_SHOWN\r\n      ? currentCount - MAX_CHECKERS_SHOWN + 1\r\n      : undefined;\r\n\r\n  const canBeHit = currentCount === 1;\r\n\r\n  const hasMove = getHasPipMove(currentPipState.pipId, currentPipState.player);\r\n\r\n  const getCanBeSelected = (checkerNum: number) =>\r\n    countIndicator\r\n      ? checkerNum === MAX_CHECKERS_SHOWN - 1\r\n      : checkerNum === checkersIterator.length - 1;\r\n\r\n  const positionTranslationsForSelectedChecker = find(positionTransitionsMap, {\r\n    from: selectedChecker?.pipId,\r\n  }) as PositionTransitionEntry;\r\n\r\n  const shouldHighlightMovePosition = isThereMoveOnPipPosition(\r\n    currentPipState.pipId,\r\n    positionTranslationsForSelectedChecker\r\n  );\r\n\r\n  // actions\r\n  const onSelectPosition = () => {\r\n    const positionTranslation = {\r\n      from: selectedChecker?.pipId,\r\n      to: currentPipState.pipId,\r\n    };\r\n\r\n    updateUiState({\r\n      ...uiState,\r\n      selectedChecker: undefined,\r\n      isExecutingMove: true,\r\n    });\r\n\r\n    emitterService.selectToMove(positionTranslation as PositionTransition);\r\n  };\r\n\r\n  return (\r\n    <PipWrapper\r\n      id={`PIP_ID_${pipNumber}`}\r\n      key={pipNumber}\r\n      onClick={() => {\r\n        shouldHighlightMovePosition && onSelectPosition();\r\n      }}\r\n      ref={(ref) => (pipRefs[pipNumber] = ref)}\r\n    >\r\n      <Triangle\r\n        shouldHighlight={shouldHighlightMovePosition}\r\n        metadata={{\r\n          even: pipNumber % 2 === 0,\r\n          quadrantNum,\r\n        }}\r\n      />\r\n      <CheckerStack quadrantNum={quadrantNum}>\r\n        {checkersIterator.map((checkerNum) => (\r\n          <Checker\r\n            key={checkerNum}\r\n            checkerNum={checkerNum}\r\n            countIndicator={\r\n              checkerNum === MAX_CHECKERS_SHOWN - 1 ? countIndicator : undefined\r\n            }\r\n            canBeSelected={getCanBeSelected(checkerNum)}\r\n            canBeHit={canBeHit}\r\n            hasMove={\r\n              !isExecutingMove && hasMove && getCanBeSelected(checkerNum)\r\n            }\r\n            pipNum={pipNumber}\r\n            player={currentPipState.player as PlayerType}\r\n          />\r\n        ))}\r\n        {<PositionHandle className=\"position-handle\" />}\r\n      </CheckerStack>\r\n    </PipWrapper>\r\n  );\r\n};\r\n\r\nexport default PipComponent;\r\n","import React from \"react\";\r\nimport range from \"lodash/range\";\r\n\r\nimport { Quadrant } from \"./styles\";\r\n\r\n//components\r\nimport Pip from \"../pip\";\r\n\r\ninterface PipsRange {\r\n  from: number;\r\n  to: number;\r\n}\r\n\r\ninterface Props {\r\n  quadrantNum: number;\r\n  pipsRange: PipsRange;\r\n}\r\n\r\nconst QuadrantComponent: React.FC<Props> = ({ quadrantNum, pipsRange }) => {\r\n  return (\r\n    <Quadrant quadrantNum={quadrantNum}>\r\n      {range(pipsRange.from, pipsRange.to).map((pipNumber) => (\r\n        <Pip key={pipNumber} pipNumber={pipNumber} quadrantNum={quadrantNum} />\r\n      ))}\r\n    </Quadrant>\r\n  );\r\n};\r\n\r\nexport default QuadrantComponent;\r\n","import styled, { keyframes, css } from \"styled-components\";\r\nimport { DIMENSIONS_CONFIG } from \"../constants\";\r\nimport { Dimensions } from \"../../types\";\r\n\r\nconst { CONTROLS_RATIO } = DIMENSIONS_CONFIG;\r\n\r\nconst animateExpandButton = keyframes`\r\n  0% {\r\n    opacity: 0;\r\n    height: 0px;\r\n  }\r\n  100% {\r\n    opacity: 1;\r\n    height: 100%;\r\n  }\r\n`;\r\n\r\nexport const HUD = styled.div`\r\n  // border: 1px solid white;\r\n  box-sizing: border-box;\r\n\r\n  position: absolute;\r\n\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n\r\n  width: 100%;\r\n  height: ${({ theme }) => `${theme.dimensions.height * CONTROLS_RATIO}px`};\r\n  top: ${({ theme }) =>\r\n    `calc(50% - ${(theme.dimensions.height * CONTROLS_RATIO) / 2}px)`};\r\n`;\r\n\r\nexport const ActionButtonsWrapper = styled.div`\r\n  width: 100%;\r\n  height: 100%;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n`;\r\n\r\nexport const RollButton = styled.button`\r\n  outline: none;\r\n  border: none;\r\n\r\n  // border: 1px solid white;\r\n  background-image: linear-gradient(\r\n    to right,\r\n    #603813 0%,\r\n    #b29f94 51%,\r\n    #603813 100%\r\n  );\r\n\r\n  border-radius: 6px;\r\n  box-shadow: 5px -5px 13px black;\r\n  width: 35%;\r\n  height: 100%;\r\n  min-width: 140px;\r\n  max-width: 200px;\r\n  max-height: 35px;\r\n  font-size: 1rem;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  cursor: pointer;\r\n  color: white;\r\n  font-weight: 700;\r\n  font-style: italic;\r\n  font-family: monospace;\r\n\r\n  ${() => css`\r\n    animation: ${animateExpandButton} 0.5s ease-in;\r\n    animation-fill-mode: forwards;\r\n  `}\r\n\r\n  &:hover {\r\n    opacity: 0.9;\r\n  }\r\n`;\r\n","import styled from \"styled-components\";\r\nimport { DIMENSIONS_CONFIG } from \"../constants\";\r\nimport { Dimensions } from \"../../types\";\r\n\r\nconst { CONTROLS_RATIO } = DIMENSIONS_CONFIG;\r\n\r\nexport const DiceContainer = styled.div`\r\n  // border: 1px solid white;\r\n  box-sizing: border-box;\r\n  width: 100%;\r\n  height: 100%;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n`;\r\n","import { PointPosition, DieFaceType } from \"./styles\";\r\n\r\nexport const pointConfigs: Map<number, PointPosition[]> = new Map()\r\n  .set(1, [\"MIDDLE\"])\r\n  .set(2, [\"NW\", \"SE\"])\r\n  .set(3, [\"SW\", \"MIDDLE\", \"NE\"])\r\n  .set(4, [\"NW\", \"NE\", \"SE\", \"SW\"])\r\n  .set(5, [\"NW\", \"NE\", \"SE\", \"SW\", \"MIDDLE\"])\r\n  .set(6, [\"NW\", \"NE\", \"E\", \"SE\", \"SW\", \"W\"]);\r\n\r\nconst dieFaces: DieFaceType[] = [\r\n  \"FRONT\",\r\n  \"LEFT\",\r\n  \"BOTTOM\",\r\n  \"TOP\",\r\n  \"RIGHT\",\r\n  \"BACK\",\r\n];\r\n\r\ninterface FaceConfig {\r\n  face: DieFaceType;\r\n  points: PointPosition[];\r\n}\r\n\r\nexport const faceConfigs: FaceConfig[] = dieFaces.map((face, i) => ({\r\n  face,\r\n  points: pointConfigs.get(i + 1) || [],\r\n}));\r\n\r\nexport default faceConfigs;\r\n","import styled, { keyframes, css } from \"styled-components\";\r\nimport map from \"lodash/map\";\r\n\r\nimport { DIMENSIONS_CONFIG } from \"../constants\";\r\nimport { Dimensions } from \"../../types\";\r\n\r\nconst { CONTROLS_RATIO, DIE_RATIO, DIE_POINT_RATIO } = DIMENSIONS_CONFIG;\r\n\r\nexport type DieFaceType =\r\n  | \"FRONT\"\r\n  | \"BACK\"\r\n  | \"RIGHT\"\r\n  | \"LEFT\"\r\n  | \"TOP\"\r\n  | \"BOTTOM\";\r\nexport type PointPosition = \"NW\" | \"NE\" | \"E\" | \"MIDDLE\" | \"SE\" | \"SW\" | \"W\";\r\n\r\ninterface DieAnimationMetadata {\r\n  duration: number;\r\n  dieFaceSequence: number[];\r\n}\r\n\r\nexport const getDieSize = (viewportDimensions: Dimensions) =>\r\n  viewportDimensions.height * CONTROLS_RATIO * DIE_RATIO;\r\n\r\nexport const getPointSize = (viewportDimensions: Dimensions) =>\r\n  getDieSize(viewportDimensions) * DIE_POINT_RATIO;\r\n\r\nexport const getDieDimension = (viewportDimensions: Dimensions) => ({\r\n  width: getDieSize(viewportDimensions),\r\n  height: getDieSize(viewportDimensions),\r\n});\r\n\r\nconst getRotationForDieNum = (die: number) => {\r\n  const rotations: Map<number, string> = new Map()\r\n    .set(1, \"rotateX(-10deg) rotateY(20deg)\")\r\n    .set(2, \"rotateX(-10deg) rotateY(110deg)\")\r\n    .set(3, \"rotateX(80deg) rotateY(0deg) rotateZ(-20deg)\")\r\n    .set(4, \"rotateX(-100deg) rotateY(0deg) rotateZ(20deg)\")\r\n    .set(5, \"rotateX(-10deg) rotateY(-70deg)\")\r\n    .set(6, \"rotateX(-190deg) rotateY(-20deg)\");\r\n\r\n  return rotations.get(die) || \"\";\r\n};\r\n\r\nconst rotateCube = (dieFaceSequence: number[]) => {\r\n  const stepIntensity = 100 / dieFaceSequence.length;\r\n  const rotationSequence = map(\r\n    dieFaceSequence,\r\n    (die, nthStep) => `\r\n    ${nthStep * stepIntensity}% { transform: ${getRotationForDieNum(die)};}\r\n  `\r\n  );\r\n\r\n  const animationTransition = keyframes`\r\n    ${rotationSequence.join(``)}\r\n`;\r\n\r\n  return animationTransition;\r\n};\r\n\r\nconst faceDieNumFaceUpFront = (dieNum: number) => ({\r\n  transform: getRotationForDieNum(dieNum),\r\n});\r\n\r\nconst styleCubeFace = (face: DieFaceType, cubeSize: number) => {\r\n  switch (face) {\r\n    case \"FRONT\":\r\n      return {\r\n        transform: `rotateY(0deg) translateZ(calc(${cubeSize}px / 2))`,\r\n      };\r\n    case \"BACK\":\r\n      return {\r\n        transform: `rotateY(180deg) translateZ(calc(${cubeSize}px / 2))`,\r\n      };\r\n    case \"RIGHT\":\r\n      return {\r\n        transform: `rotateY(90deg) translateZ(calc(${cubeSize}px / 2))`,\r\n      };\r\n    case \"LEFT\":\r\n      return {\r\n        transform: `rotateY(-90deg) translateZ(calc(${cubeSize}px / 2))`,\r\n      };\r\n    case \"TOP\":\r\n      return {\r\n        transform: `rotateX(90deg) translateZ(calc(${cubeSize}px / 2))`,\r\n      };\r\n    case \"BOTTOM\":\r\n      return {\r\n        transform: `rotateX(-90deg) translateZ(calc(${cubeSize}px / 2))`,\r\n      };\r\n  }\r\n};\r\n\r\nconst stylePoint = (position: PointPosition, pointSize: number) => {\r\n  const halfPointSize = pointSize / 2;\r\n\r\n  switch (position) {\r\n    case \"NW\":\r\n      return {\r\n        left: `${halfPointSize}px`,\r\n        top: `${halfPointSize}px`,\r\n      };\r\n\r\n    case \"NE\":\r\n      return {\r\n        right: `${halfPointSize}px`,\r\n        top: `${halfPointSize}px`,\r\n      };\r\n    case \"E\":\r\n      return {\r\n        right: `${halfPointSize}px`,\r\n        top: `calc(50% - ${halfPointSize}px)`,\r\n      };\r\n    case \"MIDDLE\":\r\n      return {\r\n        left: `calc(50% - ${halfPointSize}px)`,\r\n        top: `calc(50% - ${halfPointSize}px)`,\r\n      };\r\n    case \"SE\":\r\n      return {\r\n        right: `${halfPointSize}px`,\r\n        bottom: `${halfPointSize}px`,\r\n      };\r\n\r\n    case \"SW\":\r\n      return {\r\n        left: `${halfPointSize}px`,\r\n        bottom: `${halfPointSize}px`,\r\n      };\r\n    case \"W\":\r\n      return {\r\n        left: `${halfPointSize}px`,\r\n        top: `calc(50% - ${halfPointSize}px)`,\r\n      };\r\n  }\r\n};\r\n\r\nexport const Scene = styled.div`\r\n  // background-color: white;\r\n  perpsective: 300px;\r\n  perspective-origin: 50% 100%;\r\n  margin-right: 7%;\r\n  ${({ theme }) => getDieDimension(theme.dimensions)};\r\n`;\r\n\r\nexport const Die = styled.div<{\r\n  shouldAnimate: boolean;\r\n  dieNum: number | undefined;\r\n  animationMetadata: DieAnimationMetadata | undefined;\r\n}>`\r\n  position: relative;\r\n  transform-style: preserve-3d;\r\n  transform-origin: center center center;\r\n\r\n  ${({ theme }) => getDieDimension(theme.dimensions)};\r\n  ${({ dieNum }) => dieNum !== undefined && faceDieNumFaceUpFront(dieNum)};\r\n\r\n  ${({ shouldAnimate, animationMetadata }) =>\r\n    shouldAnimate &&\r\n    animationMetadata &&\r\n    css`\r\n      animation: ${rotateCube(animationMetadata.dieFaceSequence)}\r\n        ${animationMetadata.duration}s linear;\r\n      animation-fill-mode: forwards;\r\n    `}\r\n`;\r\n\r\nexport const DieFace = styled.div<{ face: DieFaceType }>`\r\n  border: 1px solid black;\r\n  box-sizing: border-box;\r\n  position: absolute;\r\n\r\n  background-image: url(/dice.jpg);\r\n  border-radius: 4px;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  backface-visibility: hidden;\r\n  user-select: none;\r\n\r\n  ${({ theme }) => getDieDimension(theme.dimensions)}\r\n  ${({ face, theme }) => styleCubeFace(face, getDieSize(theme.dimensions))};\r\n`;\r\n\r\nexport const Point = styled.div<{ position: PointPosition }>`\r\n  position: absolute;\r\n  background-color: white;\r\n  border-radius: 50%;\r\n\r\n  ${({ theme }) => ({\r\n    width: `${getPointSize(theme.dimensions)}px`,\r\n    height: `${getPointSize(theme.dimensions)}px`,\r\n  })};\r\n\r\n  ${({ theme, position }) =>\r\n    stylePoint(position, getPointSize(theme.dimensions))}\r\n`;\r\n","import React from \"react\";\r\n\r\nimport find from \"lodash/find\";\r\n\r\n//types\r\nimport { PlayerType } from \"../../types\";\r\n\r\n//hooks\r\nimport { useGameUI } from \"../../game-manager/game-ui\";\r\n\r\n//utils\r\nimport faceConfigs from \"./config\";\r\n\r\n//styles\r\nimport { Scene, Die, DieFace, Point } from \"./styles\";\r\n\r\n//components\r\ninterface Props {\r\n  dieNum?: number | undefined;\r\n  nthDie: number;\r\n  player: PlayerType;\r\n}\r\n\r\nconst DieComponent: React.FC<Props> = ({ dieNum, player, nthDie }) => {\r\n  const { animations } = useGameUI();\r\n\r\n  const animationForThisDice = find(animations.rollDice, {\r\n    nthDie,\r\n    player,\r\n  });\r\n\r\n  const shouldAnimate = animationForThisDice !== undefined;\r\n  const animationMetadata =\r\n    !shouldAnimate || !animationForThisDice\r\n      ? undefined\r\n      : {\r\n          duration: animationForThisDice.duration,\r\n          dieFaceSequence: animationForThisDice.dieFaceSequence,\r\n        };\r\n\r\n  return (\r\n    <Scene>\r\n      <Die\r\n        shouldAnimate={shouldAnimate}\r\n        animationMetadata={animationMetadata}\r\n        dieNum={dieNum}\r\n      >\r\n        {faceConfigs.map((faceConfig) => (\r\n          <DieFace key={faceConfig.face} face={faceConfig.face}>\r\n            {faceConfig.points.map((position) => (\r\n              <Point key={position} position={position} />\r\n            ))}\r\n          </DieFace>\r\n        ))}\r\n      </Die>\r\n    </Scene>\r\n  );\r\n};\r\n\r\nexport default DieComponent;\r\n","import React from \"react\";\r\n\r\n//types\r\nimport { PlayerType } from \"../../types\";\r\n\r\n//hooks\r\nimport { useGameInference } from \"../../game-manager/inference\";\r\n\r\n//styles\r\nimport { DiceContainer } from \"./styles\";\r\n\r\n//components\r\nimport Die from \"../die\";\r\n\r\ninterface Props {\r\n  player: PlayerType;\r\n}\r\n\r\nconst DiceContainerComponent: React.FC<Props> = ({ player }) => {\r\n  const { getDiceMetadata } = useGameInference();\r\n\r\n  const diceToShow = getDiceMetadata(player);\r\n\r\n  return (\r\n    <DiceContainer>\r\n      {diceToShow.map(({ dieNum, nthDie }) => (\r\n        <Die key={nthDie} player={player} dieNum={dieNum} nthDie={nthDie} />\r\n      ))}\r\n    </DiceContainer>\r\n  );\r\n};\r\n\r\nexport default DiceContainerComponent;\r\n","import React from \"react\";\r\n\r\n//types\r\nimport { PlayerType } from \"../../types\";\r\n\r\n//hooks\r\nimport { useGameUI } from \"../../game-manager/game-ui\";\r\nimport { useGameInference } from \"../../game-manager/inference\";\r\nimport { useNetworkManager } from \"../../game-manager/network-manager\";\r\n\r\n//utils\r\n\r\n//styles\r\nimport { HUD, ActionButtonsWrapper, RollButton } from \"./styles\";\r\n\r\n//components\r\nimport DiceContainer from \"../dice-container\";\r\n\r\ninterface Props {\r\n  player: PlayerType;\r\n}\r\n\r\nconst HUDComponent: React.FC<Props> = ({ player }) => {\r\n  const { uiState, updateUiState } = useGameUI();\r\n  const { emitterService } = useNetworkManager();\r\n  const { canInitRoll, canRoll, myPlayer, shouldShowDiceContainer } =\r\n    useGameInference();\r\n\r\n  const onRoll = (isInit: boolean) => {\r\n    updateUiState({\r\n      ...uiState,\r\n      pressedRoll: true,\r\n    });\r\n\r\n    if (isInit) {\r\n      emitterService.pressInitRoll();\r\n      return;\r\n    }\r\n\r\n    emitterService.pressRoll();\r\n  };\r\n\r\n  return (\r\n    <HUD>\r\n      <ActionButtonsWrapper>\r\n        {player === myPlayer && canRoll() && (\r\n          <RollButton onClick={() => onRoll(false)}>Roll</RollButton>\r\n        )}\r\n        {player === myPlayer && canInitRoll() && (\r\n          <RollButton disabled={!canInitRoll()} onClick={() => onRoll(true)}>\r\n            Roll Initial\r\n          </RollButton>\r\n        )}\r\n\r\n        {shouldShowDiceContainer(player) && <DiceContainer player={player} />}\r\n      </ActionButtonsWrapper>\r\n    </HUD>\r\n  );\r\n};\r\n\r\nexport default HUDComponent;\r\n","import styled from \"styled-components\";\r\nimport { DIMENSIONS_CONFIG } from \"../constants\";\r\n\r\nconst { ACTIVE_CHECKER_RATIO } = DIMENSIONS_CONFIG;\r\n\r\nexport const PositionHandle = styled.div`\r\n  width: ${({ theme }) => theme.dimensions.width * ACTIVE_CHECKER_RATIO}px;\r\n  height: ${({ theme }) =>\r\n    theme.dimensions.height * ACTIVE_CHECKER_RATIO * 1.75}px;\r\n  background-color: black;\r\n  margin: 0px auto;\r\n  visibility: hidden;\r\n`;\r\n\r\nexport const HitContainer = styled.div`\r\n  // border: 5px solid #3e210d;\r\n  box-sizing: border-box;\r\n  width: 90%;\r\n  margin: auto;\r\n  height: calc(50% - 50px);\r\n`;\r\n","import React from \"react\";\r\nimport times from \"lodash/times\";\r\n\r\n//types\r\nimport { GameState, PlayerType } from \"../../types\";\r\n\r\n//hooks\r\nimport { useGameState } from \"../../game-manager/game-state\";\r\nimport { useNetworkManager } from \"../../game-manager/network-manager\";\r\nimport { useGameInference } from \"../../game-manager/inference\";\r\n\r\n//utils\r\nimport { hitSpaceRefs } from \"../../dom-refs\";\r\n\r\n//styles\r\nimport { HitContainer, PositionHandle } from \"./styles\";\r\n\r\n//components\r\nimport Checker from \"../checker\";\r\n\r\nconst MAX_CHECKERS_SHOWN = 3;\r\n\r\ninterface Props {\r\n  player: PlayerType;\r\n}\r\n\r\nconst PipComponent: React.FC<Props> = ({ player }) => {\r\n  const { state } = useGameState();\r\n  const { emitterService } = useNetworkManager();\r\n  const { getHasPipMove } = useGameInference();\r\n\r\n  const { hitSpace } = state;\r\n\r\n  const currentCount = hitSpace[player];\r\n  const checkersIterator = times(currentCount).slice(0, MAX_CHECKERS_SHOWN);\r\n\r\n  const countIndicator =\r\n    currentCount > MAX_CHECKERS_SHOWN\r\n      ? currentCount - MAX_CHECKERS_SHOWN + 1\r\n      : undefined;\r\n\r\n  const hasMove = getHasPipMove(\"hit-space\", player);\r\n\r\n  const getCanBeSelected = (checkerNum: number) =>\r\n    countIndicator\r\n      ? checkerNum === MAX_CHECKERS_SHOWN - 1\r\n      : checkerNum === checkersIterator.length - 1;\r\n\r\n  return (\r\n    <HitContainer ref={(ref) => (hitSpaceRefs[player] = ref)}>\r\n      {checkersIterator.map((checkerNum) => (\r\n        <Checker\r\n          key={checkerNum}\r\n          checkerNum={checkerNum}\r\n          canBeSelected={getCanBeSelected(checkerNum)}\r\n          hasMove={hasMove}\r\n          pipNum=\"hit-space\"\r\n          player={player}\r\n          countIndicator={\r\n            checkerNum === MAX_CHECKERS_SHOWN - 1 ? countIndicator : undefined\r\n          }\r\n          isHitChecker={true}\r\n        />\r\n      ))}\r\n      <PositionHandle className=\"position-handle\" />\r\n    </HitContainer>\r\n  );\r\n};\r\n\r\nexport default PipComponent;\r\n","import styled from \"styled-components\";\r\nimport { DIMENSIONS_CONFIG } from \"../constants\";\r\n\r\nconst { ACTIVE_CHECKER_RATIO, BEAROFF_CHECKER_RATIO } = DIMENSIONS_CONFIG;\r\n\r\nconst getDirectionStyles = (direction: any) =>\r\n  direction === \"S\"\r\n    ? {\r\n        flexDirection: \"column\",\r\n        borderTopLeftRadius: \"0px\",\r\n        borderTopRightRadius: \"0px\",\r\n      }\r\n    : {\r\n        flexDirection: \"column-reverse\",\r\n        borderBottomLeftRadius: \"0px\",\r\n        borderBottomRightRadius: \"0px\",\r\n      };\r\n\r\nexport const PositionHandle = styled.div`\r\n  width: ${({ theme }) => theme.dimensions.width * ACTIVE_CHECKER_RATIO}px;\r\n  height: ${({ theme }) =>\r\n    theme.dimensions.height *\r\n    ACTIVE_CHECKER_RATIO *\r\n    1.75 *\r\n    BEAROFF_CHECKER_RATIO}px;\r\n  background-color: black;\r\n  margin: 0px auto;\r\n  visibility: hidden;\r\n`;\r\n\r\nexport const BearOffContainer = styled.div`\r\n  box-sizing: border-box;\r\n  width: 90%;\r\n  margin: auto;\r\n  height: calc(50% - 50px);\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: left;\r\n  padding: 8px 8px;\r\n\r\n  // border-radius: 9px;\r\n  // box-shadow: -5px -3px 18px #4f4a46;\r\n  // background: linear-gradient(\r\n  //   0deg,\r\n  //   rgb(0 0 0 / 72%) 0%,\r\n  //   rgb(39 23 12 / 79%) 100%\r\n  // );\r\n  // border: 1px solid black;\r\n\r\n  // border-left: 1px solid #7a7575;\r\n  // border-bottom: 1px solid #7a7574;\r\n  border-radius: 9px;\r\n  box-shadow: 3px 6px 9px 4px rgb(15 12 23 / 81%) inset,\r\n    1px -1px 7px 0 rgb(38 20 20) inset;\r\n`;\r\n\r\nexport const Inner = styled.div<{\r\n  direction: \"N\" | \"S\";\r\n  shouldHighlight: boolean;\r\n}>`\r\n  width: 100%;\r\n  height: 100%;\r\n  display: flex;\r\n\r\n  transition: background-color 0.3s ease-out;\r\n  // background-image: url(/wood-board.jpg);\r\n  // border-radius: 9px;\r\n  // box-shadow: -5px -3px 18px black;\r\n  // padding: 3px 0px;\r\n\r\n  border-radius: inherit;\r\n\r\n  ${({ shouldHighlight }) =>\r\n    shouldHighlight &&\r\n    `\r\n    background-image: none;\r\n    background-color: #7db53c;\r\n    cursor: pointer;\r\n  `}\r\n  ${({ direction }) => getDirectionStyles(direction) as any}\r\n`;\r\n","import React from \"react\";\r\nimport times from \"lodash/times\";\r\nimport find from \"lodash/find\";\r\n\r\nimport { isThereMoveOnPipPosition } from \"../../utils/backgammon\";\r\n\r\n//types\r\nimport {\r\n  PlayerType,\r\n  PositionTransitionEntry,\r\n  PositionTransition,\r\n} from \"../../types\";\r\n\r\n//hooks\r\nimport { useGameState } from \"../../game-manager/game-state\";\r\nimport { useNetworkManager } from \"../../game-manager/network-manager\";\r\nimport { useGameUI } from \"../../game-manager/game-ui\";\r\n\r\n//utils\r\nimport { bearOffRefs } from \"../../dom-refs\";\r\n\r\n//styles\r\nimport { BearOffContainer, PositionHandle, Inner } from \"./styles\";\r\n\r\n//components\r\nimport Checker from \"../checker\";\r\n\r\nconst MAX_CHECKERS_SHOWN = 3;\r\n\r\ninterface Props {\r\n  player: PlayerType;\r\n}\r\n\r\nconst BearOffComponent: React.FC<Props> = ({ player }) => {\r\n  const { state } = useGameState();\r\n  const { emitterService } = useNetworkManager();\r\n\r\n  const { uiState, updateUiState } = useGameUI();\r\n  const { bearOff } = state;\r\n\r\n  const currentCount = bearOff[player];\r\n  const checkersIterator = times(currentCount);\r\n\r\n  const pipNum = player === \"W\" ? -1 : 24; //TODO: get this from somewhere else\r\n  const checkersDirection = player === \"W\" ? \"S\" : \"N\"; //TODO: get this from somewhere else\r\n  const { selectedChecker } = uiState;\r\n  const { positionTransitionsMap } = state || {};\r\n\r\n  const positionTranslationsForSelectedChecker = find(positionTransitionsMap, {\r\n    from: selectedChecker?.pipId,\r\n  }) as PositionTransitionEntry;\r\n\r\n  const shouldHighlightMovePosition = isThereMoveOnPipPosition(\r\n    pipNum,\r\n    positionTranslationsForSelectedChecker\r\n  );\r\n\r\n  const onSelectPosition = () => {\r\n    const positionTranslation = {\r\n      from: selectedChecker?.pipId,\r\n      to: pipNum,\r\n    };\r\n\r\n    updateUiState({\r\n      ...uiState,\r\n      selectedChecker: undefined,\r\n    });\r\n\r\n    emitterService.selectToMove(positionTranslation as PositionTransition);\r\n  };\r\n\r\n  return (\r\n    <BearOffContainer ref={(ref) => (bearOffRefs[player] = ref)}>\r\n      <Inner\r\n        direction={checkersDirection}\r\n        shouldHighlight={shouldHighlightMovePosition}\r\n        onClick={() => shouldHighlightMovePosition && onSelectPosition()}\r\n      >\r\n        {checkersIterator.map((checkerNum) => (\r\n          <Checker\r\n            key={checkerNum}\r\n            checkerNum={checkerNum}\r\n            canBeSelected={false}\r\n            hasMove={false}\r\n            pipNum={pipNum}\r\n            player={player}\r\n            countIndicator={undefined}\r\n            isBearOffChecker={true}\r\n          />\r\n        ))}\r\n        <PositionHandle className=\"position-handle\" />\r\n      </Inner>\r\n    </BearOffContainer>\r\n  );\r\n};\r\n\r\nexport default BearOffComponent;\r\n","var _path, _path2;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgUndo(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    height: \"24px\",\n    viewBox: \"0 0 24 24\",\n    width: \"24px\",\n    fill: \"#000000\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M0 0h24v24H0z\",\n    fill: \"none\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    stroke: \"currentColor\",\n    fill: \"currentColor\",\n    d: \"M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z\"\n  })));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgUndo);\nexport default __webpack_public_path__ + \"static/media/undo.603316ba.svg\";\nexport { ForwardRef as ReactComponent };","import styled from \"styled-components\";\r\n\r\nimport { ReactComponent as $CheckIcon } from \"./icons/check.svg\";\r\nimport { ReactComponent as $UndoIcon } from \"./icons/undo.svg\";\r\n\r\nconst getIconStyles = () => `\r\n  width: 30px;\r\n  padding: 4px;\r\n  height: 30px;\r\n`;\r\n\r\nexport const BarActions = styled.div`\r\n  box-shadow: -5px -3px 18px #4f4a46;\r\n  background-image: url(/wood-board.jpg);\r\n  width: 150%;\r\n  height: 50px;\r\n  border-radius: 10px;\r\n  display: flex;\r\n  z-index: 5;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  position: relative;\r\n  left: -25%;\r\n`;\r\n\r\nexport const ControlItem = styled.div<{ isDisabled: boolean }>`\r\n  border: 1px solid #64badd;\r\n  box-sizing: border-box;\r\n  border-radius: 50%;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  cursor: pointer;\r\n  margin-right: 2px;\r\n  box-shadow: -5px -3px 18px #4f4a46;\r\n  transition: background-color 0.3s ease-out;\r\n\r\n  cursor: pointer;\r\n  background-color: white;\r\n\r\n  ${({ isDisabled }) =>\r\n    isDisabled &&\r\n    `\r\n    background-color: lightgray;\r\n    pointer-events: none;\r\n  `}\r\n\r\n  &:hover {\r\n    ${({ isDisabled }) =>\r\n      !isDisabled &&\r\n      `\r\n    border: 1px solid orange;\r\n    background-color: #b5c9d0;\r\n    `}\r\n  }\r\n`;\r\n\r\nexport const CheckIcon = styled($CheckIcon)<{ is_disabled: string }>`\r\n  color: ${({ is_disabled }) => (is_disabled === \"true\" ? \"gray\" : \"#64badd\")};\r\n  ${getIconStyles()}\r\n`;\r\n\r\nexport const UndoIcon = styled($UndoIcon)<{ is_disabled: string }>`\r\n  color: ${({ is_disabled }) => (is_disabled === \"true\" ? \"gray\" : \"#638def\")};\r\n  ${getIconStyles()}\r\n`;\r\n","import React from \"react\";\r\nimport { ReactComponent as $CheckIcon } from \"./icons/check.svg\";\r\n\r\n//types\r\nimport { PlayerType } from \"../../types\";\r\n\r\n//hooks\r\nimport { useGameUI } from \"../../game-manager/game-ui\";\r\nimport { useGameInference } from \"../../game-manager/inference\";\r\nimport { useNetworkManager } from \"../../game-manager/network-manager\";\r\n\r\n//styles\r\nimport { BarActions, ControlItem, CheckIcon, UndoIcon } from \"./styles\";\r\n\r\n//components\r\n\r\ninterface Props {}\r\n\r\nconst BarActionsComponent: React.FC<Props> = () => {\r\n  const { uiState, updateUiState } = useGameUI();\r\n  const { emitterService } = useNetworkManager();\r\n  const { canConfirmMove, canUndo } = useGameInference();\r\n\r\n  const onConfirm = () => {\r\n    const el = document.querySelector(\r\n      \"#play-confirm-move\"\r\n    ) as HTMLButtonElement;\r\n    el.click();\r\n\r\n    updateUiState({ ...uiState, pressedConfirm: true });\r\n    emitterService.confirmMove();\r\n  };\r\n\r\n  const onUndo = () => {\r\n    const el = document.querySelector(\"#play-undo-move\") as HTMLButtonElement;\r\n    el.click();\r\n\r\n    updateUiState({ ...uiState, pressedUndo: true });\r\n    emitterService.undo();\r\n  };\r\n\r\n  const isUndoDisabled = !canUndo();\r\n  const isConfirmDisabled = !canConfirmMove();\r\n\r\n  return (\r\n    <BarActions>\r\n      <ControlItem\r\n        title=\"Undo\"\r\n        isDisabled={isUndoDisabled}\r\n        onClick={() => onUndo()}\r\n      >\r\n        <UndoIcon is_disabled={String(isUndoDisabled)} />\r\n      </ControlItem>\r\n      <ControlItem\r\n        title=\"Confirm\"\r\n        isDisabled={isConfirmDisabled}\r\n        onClick={() => onConfirm()}\r\n      >\r\n        <CheckIcon is_disabled={String(isConfirmDisabled)} />\r\n      </ControlItem>\r\n    </BarActions>\r\n  );\r\n};\r\n\r\nexport default BarActionsComponent;\r\n","import React, { useEffect } from \"react\";\r\n\r\nimport {\r\n  Board,\r\n  ActiveSection,\r\n  WoodBar,\r\n  PlaygroundContainer,\r\n  Side,\r\n  Ruler,\r\n  Pips,\r\n} from \"./styles\";\r\n\r\nimport { QUADRANT_CONFIGS } from \"../constants\";\r\n\r\nimport { useGameInference } from \"../../game-manager/inference\";\r\n\r\n//components\r\nimport Quadrant from \"../quadrant\";\r\nimport HUD from \"../hud\";\r\nimport HitSpace from \"../hit-space\";\r\nimport BearOff from \"../bear-off\";\r\nimport BarActions from \"../bar-actions\";\r\n\r\ninterface Props {}\r\n\r\nconst woodBarsSides: Side[] = [\"W\", \"N\", \"S\", \"E\", \"CENTER\"];\r\n\r\nconst BoardComponent: React.FC<Props> = () => {\r\n  const { isMyTurn, hasWin } = useGameInference();\r\n\r\n  useEffect(() => {\r\n    if (hasWin()) {\r\n      const el = document.querySelector(\"#play-win\") as HTMLButtonElement;\r\n      el.click();\r\n    }\r\n  }, [hasWin()]);\r\n\r\n  return (\r\n    <Board>\r\n      <ActiveSection>\r\n        {woodBarsSides.map((side) => (\r\n          <WoodBar key={side} side={side}>\r\n            {side === \"CENTER\" && (\r\n              <>\r\n                <HitSpace player=\"B\" />\r\n                {isMyTurn && <BarActions />}\r\n                <HitSpace player=\"W\" />\r\n              </>\r\n            )}\r\n          </WoodBar>\r\n        ))}\r\n        <Ruler>\r\n          <Pips />\r\n        </Ruler>\r\n        <PlaygroundContainer side=\"left\">\r\n          {QUADRANT_CONFIGS.left.map((config) => (\r\n            <Quadrant\r\n              key={config.quadrantNum}\r\n              quadrantNum={config.quadrantNum}\r\n              pipsRange={config.pipsRange}\r\n            />\r\n          ))}\r\n          <HUD player=\"W\" />\r\n        </PlaygroundContainer>\r\n        <PlaygroundContainer side=\"right\">\r\n          {QUADRANT_CONFIGS.right.map((config) => (\r\n            <Quadrant\r\n              key={config.quadrantNum}\r\n              quadrantNum={config.quadrantNum}\r\n              pipsRange={config.pipsRange}\r\n            />\r\n          ))}\r\n          <HUD player=\"B\" />\r\n        </PlaygroundContainer>\r\n      </ActiveSection>\r\n      <WoodBar side=\"BEAROFF\">\r\n        <BearOff player=\"W\" />\r\n        <BearOff player=\"B\" />\r\n      </WoodBar>\r\n      {/* <img src = {\"/jump_out2.png\"} /> */}\r\n    </Board>\r\n  );\r\n};\r\n\r\nexport default BoardComponent;\r\n","import styled, { keyframes, css } from \"styled-components\";\r\n\r\nconst spin = () => keyframes`\r\n  0% {\r\n    transform: rotate(0deg);\r\n  }\r\n  100% {\r\n    transform: rotate(360deg);\r\n  }\r\n`;\r\n\r\nconst animatePopup = () => keyframes`\r\n  0% {\r\n    bottom: -15vh;\r\n  }\r\n  100% {\r\n    bottom: 0px;\r\n  }\r\n`;\r\n\r\nexport const Playground = styled.div`\r\n  box-sizing: border-box;\r\n  background-image: url(/wood-texture.png);\r\n  width: 100%;\r\n  height: 100vh;\r\n  margin: auto;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  padding-top: 20px;\r\n`;\r\n\r\nexport const BoardContainer = styled.div`\r\n  background-color: white;\r\n  border-radius: 4px;\r\n  // box-shadow: 19px -7px 19px black;\r\n`;\r\n\r\nexport const Stats = styled.div`\r\n  border: 1px solid black;\r\n  background-image: url(/wood-board.jpg);\r\n  box-shadow: 9px 3px 19px black;\r\n  border-radius: 4px;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  height: 5%;\r\n  margin-bottom: 50px;\r\n  width: 80%;\r\n  color: white;\r\n`;\r\n\r\nexport const PendingBanner = styled.div`\r\n  border: 1px solid black;\r\n  background-image: url(/wood-board.jpg);\r\n  box-shadow: 9px 3px 19px black;\r\n  border-radius: 4px;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  height: 10%;\r\n  width: 71%;\r\n  margin-top: calc(50vh - 20%);\r\n  color: white;\r\n  font-size: 20px;\r\n  font-style: italic;\r\n`;\r\n\r\nexport const PlayerLane = styled.div`\r\n  background-color: transparent;\r\n  flex: 1;\r\n  color: black;\r\n  height: 100%;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  color: white;\r\n  padding: 0px 10px;\r\n\r\n  & label {\r\n    font-size: 1.2vw;\r\n  }\r\n`;\r\n\r\nexport const LogLane = styled.div`\r\n  flex: 2;\r\n  display: flex;\r\n  font-size: 1.7vw;\r\n  justify-content: center;\r\n  align-items: center;\r\n  color: orange;\r\n`;\r\n\r\nexport const Toast = styled.div`\r\n  box-sizing: border-box;\r\n  border: 1px solid black;\r\n  border-bottom: none;\r\n  border-radius: 8px;\r\n  border-bottom-left-radius: 0px;\r\n  border-bottom-right-radius: 0px;\r\n  border-top-right-radius: 0px;\r\n  border-right: 0px;\r\n  box-shadow: -5px -3px 18px #4f4a46;\r\n  background-image: url(/wood-board.jpg);\r\n  position: absolute;\r\n  display: flex;\r\n  flex-direction: column;\r\n\r\n  bottom: 0px;\r\n  right: 0px;\r\n  width: 40vw;\r\n  height: 15vh;\r\n  min-width: 300px;\r\n  min-height: 80px;\r\n  z-index: 9999;\r\n\r\n  transition: bottom 0.5s ease-out;\r\n\r\n  animation: ${animatePopup()} 0.5s ease-out;\r\n  animation-direction: alternate;\r\n\r\n  h4 {\r\n    margin: 0px;\r\n    padding: 0px;\r\n    font-size: calc(8px + 0.8vw);\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    height: 35%;\r\n    border-bottom: 1px solid black;\r\n    font-style: italic;\r\n    font-weight: normal;\r\n    color: white;\r\n  }\r\n\r\n  .buttons {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    flex: 1;\r\n\r\n    & button {\r\n      width: 100px;\r\n      height: 30px;\r\n      &:nth-child(even) {\r\n        background-color: #fa4f4f;\r\n        margin-left: 20px;\r\n      }\r\n\r\n      &:nth-child(odd) {\r\n        background-color: #4f8c4f;\r\n        margin-left: 20px;\r\n      }\r\n    }\r\n  }\r\n`;\r\n\r\nexport const Spinner = styled.div`\r\n  background-image: url(/wood-t.jpg);\r\n  border-radius: 50%;\r\n  box-shadow: 3px 6px 9px 4px rgb(15 12 23 / 81%) inset;\r\n  width: 40px;\r\n  height: 40px;\r\n  margin-left: 40px;\r\n\r\n  animation: ${spin()} 0.7s infinite;\r\n  animation-direction: alternate;\r\n`;\r\n\r\nexport const JumpOutImage = styled.div`\r\n  position: fixed;\r\n  bottom: 0;\r\n  right: 0;\r\n  width: 50px;\r\n  border: 3px solid #73AD21;\r\n`;\r\n","import React, { useEffect } from \"react\";\r\nimport { useHistory } from \"react-router-dom\";\r\n\r\n// hooks\r\nimport { useGameStats } from \"../../game-manager/stats\";\r\nimport { useNetworkManager } from \"../../game-manager/network-manager\";\r\nimport { useGameInference } from \"../../game-manager/inference\";\r\n\r\n//components\r\nimport Checker from \"../checker\";\r\nimport Board from \"../board\";\r\nimport { Button } from \"../lobby/ui/styles\";\r\n\r\n//styles\r\nimport {\r\n  Playground,\r\n  Stats,\r\n  PlayerLane,\r\n  LogLane,\r\n  BoardContainer,\r\n  PendingBanner,\r\n  Toast,\r\n  Spinner,\r\n  JumpOutImage,\r\n} from \"./styles\";\r\n\r\n//image\r\n\r\ninterface Props {}\r\n\r\nconst PlaygroundComponent: React.FC<Props> = () => {\r\n\r\n  const history = useHistory();\r\n  \r\n  const { inferLog } = useGameStats();\r\n  const { networkState, roomsService, emitterService } = useNetworkManager();\r\n  const { canInviteForRematch, shouldShowRematchInvitation } =\r\n    useGameInference();\r\n\r\n  const { setIsSendRematchInvitationLoading } = roomsService;\r\n\r\n  const shouldRenderBoard = networkState.status === \"STARTED\";\r\n\r\n  const { status, hostUsername, guestUsername, role, roomId } = networkState;\r\n\r\n  const onRematchInvite = () => {\r\n    setIsSendRematchInvitationLoading(true);\r\n    emitterService.sendRematchInvitation();\r\n  };\r\n\r\n  const onAcceptRematchInvitation = () => {\r\n    emitterService.acceptRematchInvitation();\r\n  };\r\n\r\n  const onDeclineRematchInvitation = () => {\r\n    emitterService.declineRematchInvitation();\r\n  };\r\n\r\n  const onQuitFromGame = () => {\r\n    console.log(\"=======1.onQuitFromGame function called.==========\");\r\n    emitterService.quitFromGame(status, roomId!, role!, hostUsername!, guestUsername!);\r\n    history.push(\"/game\");\r\n  };\r\n\r\n\r\n  useEffect(() => {\r\n    if (networkState.roomName !== undefined) {\r\n      document.title = `Game Room: ${networkState.roomName}`;\r\n    }\r\n\r\n    return () => {\r\n      document.title = \"Backgammon\";\r\n    };\r\n  }, [networkState.roomName]);\r\n  \r\n  let username: string\r\n\r\n  return (\r\n    <Playground>\r\n      {!shouldRenderBoard && (\r\n        <PendingBanner>\r\n          <span>Waiting for guest player to join </span>\r\n          <Spinner></Spinner>\r\n        </PendingBanner>\r\n      )}\r\n      {shouldRenderBoard && (\r\n        <>\r\n          <Stats>\r\n            <PlayerLane style={{ borderRight: \"1px solid #7e512f\" }}>\r\n              <Checker\r\n                canBeSelected={false}\r\n                checkerNum={0}\r\n                player=\"W\"\r\n                hasMove={false}\r\n                canBeHit={false}\r\n                countIndicator={undefined}\r\n              />\r\n              <label>{hostUsername}</label>\r\n            </PlayerLane>\r\n            <LogLane>{inferLog()}</LogLane>\r\n            <PlayerLane style={{ borderLeft: \"1px solid #7e512f\" }}>\r\n              <Checker\r\n                canBeSelected={false}\r\n                checkerNum={0}\r\n                player=\"B\"\r\n                hasMove={false}\r\n                canBeHit={false}\r\n                countIndicator={undefined}\r\n              />\r\n              <label>{guestUsername}</label>\r\n            </PlayerLane>\r\n          </Stats>\r\n\r\n          <BoardContainer>\r\n            <Board />\r\n          </BoardContainer>\r\n          {canInviteForRematch() && (\r\n            <Button onClick={onRematchInvite}>Invite for Rematch</Button>\r\n          )}\r\n          {shouldShowRematchInvitation() && (\r\n            <Toast>\r\n              <h4>Kiko invited you to play again</h4>\r\n              <div className=\"buttons\">\r\n                <Button onClick={onAcceptRematchInvitation}>Accept</Button>\r\n                <Button onClick={onDeclineRematchInvitation}>Decline</Button>\r\n              </div>\r\n            </Toast>\r\n          )}\r\n        </>\r\n      )}\r\n      <JumpOutImage>\r\n        <img src = {\"/jump_out2.png\"} onClick={onQuitFromGame} />\r\n      </JumpOutImage>\r\n    </Playground>\r\n  );\r\n};\r\n\r\nexport default PlaygroundComponent;\r\n","import React from \"react\";\r\n\r\nimport styled from \"styled-components\";\r\n\r\nimport Playground from \"../../game/components/playground\";\r\n\r\nconst PlaygroundPage: React.FC = () => (\r\n  <Page>\r\n    <Playground />\r\n  </Page>\r\n);\r\n\r\nconst Page = styled.div``;\r\n\r\nexport default PlaygroundPage;\r\n","import React, { useState } from \"react\";\r\nimport { Formik, Field, Form, ErrorMessage } from \"formik\";\r\nimport * as Yup from \"yup\";\r\nimport AuthService from \"../../../services/auth.service\";\r\nimport { RouteComponentProps } from \"react-router-dom\";\r\nimport styled from \"styled-components\";\r\n// import \"./login.css\";\r\ninterface RouterProps {\r\n  history: string;\r\n}\r\n\r\nconst Styles = styled.div`\r\n  background-image: url(/wood-texture.png);\r\n  height: calc(100vh - 56px);\r\n  padding: 10px;\r\n\r\n  display: flex;\r\n  justify-content: center;\r\n  // align-items: center;\r\n`;\r\n\r\ntype Props = RouteComponentProps<RouterProps>;\r\nconst Login: React.FC<Props> = ({ history }) => {\r\n  const [loading, setLoading] = useState<boolean>(false);\r\n  const [message, setMessage] = useState<string>(\"\");\r\n  const initialValues: {\r\n    username: string;\r\n    password: string;\r\n  } = {\r\n    username: \"\",\r\n    password: \"\",\r\n  };\r\n  const validationSchema = Yup.object().shape({\r\n    username: Yup.string().required(\"This field is required!\"),\r\n    password: Yup.string().required(\"This field is required!\"),\r\n  });\r\n  const handleLogin = (formValue: { username: string; password: string }) => {\r\n    const { username, password } = formValue;\r\n    setMessage(\"\");\r\n    setLoading(true);\r\n    AuthService.login(username, password).then(\r\n      () => {\r\n        history.push(\"/game\");\r\n        window.location.reload();\r\n      },\r\n      (error) => {\r\n        const resMessage =\r\n          (error.response &&\r\n            error.response.data &&\r\n            error.response.data.message) ||\r\n          error.message ||\r\n          error.toString();\r\n        setLoading(false);\r\n        setMessage(resMessage);\r\n      }\r\n    );\r\n  };\r\n  return (\r\n    <Styles>\r\n\r\n      <div className=\"col-md-12\">\r\n        <div className=\"card card-container\">\r\n          <img\r\n            src=\"//ssl.gstatic.com/accounts/ui/avatar_2x.png\"\r\n            alt=\"profile-img\"\r\n            className=\"profile-img-card\"\r\n          />\r\n          <Formik\r\n            initialValues={initialValues}\r\n            validationSchema={validationSchema}\r\n            onSubmit={handleLogin}\r\n          >\r\n            <Form>\r\n              <div className=\"form-group\">\r\n                <label htmlFor=\"username\">Username</label>\r\n                <Field name=\"username\" type=\"text\" className=\"form-control\" />\r\n                <ErrorMessage\r\n                  name=\"username\"\r\n                  component=\"div\"\r\n                  className=\"alert alert-danger\"\r\n                />\r\n              </div>\r\n              <div className=\"form-group\">\r\n                <label htmlFor=\"password\">Password</label>\r\n                <Field name=\"password\" type=\"password\" className=\"form-control\" />\r\n                <ErrorMessage\r\n                  name=\"password\"\r\n                  component=\"div\"\r\n                  className=\"alert alert-danger\"\r\n                />\r\n              </div>\r\n              <div className=\"form-group\">\r\n                <button type=\"submit\" className=\"btn btn-primary btn-block\" disabled={loading}>\r\n                  {loading && (\r\n                    <span className=\"spinner-border spinner-border-sm\"></span>\r\n                  )}\r\n                  <span>Login</span>\r\n                </button>\r\n              </div>\r\n              {message && (\r\n                <div className=\"form-group\">\r\n                  <div className=\"alert alert-danger\" role=\"alert\">\r\n                    {message}\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </Form>\r\n          </Formik>\r\n        </div>\r\n      </div>\r\n    </Styles>\r\n  );\r\n};\r\n\r\nexport default Login;","import React, { useState } from \"react\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { Formik, Field, Form, ErrorMessage } from \"formik\";\r\nimport * as Yup from \"yup\";\r\nimport IUser from \"../../../types/user.type\";\r\nimport AuthService from \"../../../services/auth.service\";\r\nimport styled from \"styled-components\";\r\n\r\nimport { CountryDropdown, RegionDropdown, CountryRegionData } from 'react-country-region-selector';\r\nimport { getFilterFormValues } from \"react-admin\";\r\nimport { setConstantValue } from \"typescript\";\r\n\r\n// import \"./register.css\";\r\n\r\nconst Styles = styled.div`\r\n  background-image: url(/wood-texture.png);\r\n  height: 100%;\r\n  padding: 10px;\r\n\r\n  display: flex;\r\n  justify-content: center;\r\n  // align-items: center;\r\n`;\r\n\r\nconst Register: React.FC = () => {\r\n  const history = useHistory();\r\n  const [successful, setSuccessful] = useState<boolean>(false);\r\n  const [message, setMessage] = useState<string>(\"\");\r\n  const [showState, setShowState] = useState(true);\r\n  const [countryValue, setCountryValue] = useState(\"United States of America\");\r\n  const initialValues: IUser = {\r\n    username: \"\",\r\n    email: \"\",\r\n    password: \"\",\r\n    country: \"United States of America\",\r\n    state:\"Nebraska\",\r\n    gender: \"Male\",\r\n    birthday: \"\",\r\n  };\r\n  const validationSchema = Yup.object().shape({\r\n    username: Yup.string()\r\n      .test(\r\n        \"len\",\r\n        \"The username must be between 3 and 20 characters.\",\r\n        (val: any) =>\r\n          val &&\r\n          val.toString().length >= 3 &&\r\n          val.toString().length <= 20\r\n      )\r\n      .required(\"This field is required!\"),\r\n    email: Yup.string()\r\n      .email(\"This is not a valid email.\")\r\n      .required(\"This field is required!\"),\r\n    password: Yup.string()\r\n      .test(\r\n        \"len\",\r\n        \"The password must be between 6 and 40 characters.\",\r\n        (val: any) =>\r\n          val &&\r\n          val.toString().length >= 6 &&\r\n          val.toString().length <= 40\r\n      )\r\n      .required(\"This field is required!\"),\r\n  });\r\n  const handleRegister = (formValue: IUser) => {\r\n    const { username, email, password, state, gender, birthday } = formValue;\r\n    console.log(state);\r\n    const country = countryValue;\r\n    let role = \"user\";\r\n    if (username === \"backgammonAdmin\") {\r\n      role = \"admin\";\r\n      console.log(role);\r\n    }\r\n\r\n    AuthService.register(username!, email!, password!, country!, state!, gender!, birthday!, role).then(\r\n      (response) => {\r\n        setMessage(response.message);\r\n        setSuccessful(true);\r\n        history.push(\"/game\");\r\n        window.location.reload();\r\n      },\r\n      (error) => {\r\n        const resMessage =\r\n          (error.response &&\r\n            error.response.data &&\r\n            error.response.data.message) ||\r\n          error.message ||\r\n          error.toString();\r\n        setMessage(resMessage);\r\n        setSuccessful(false);\r\n      }\r\n    );\r\n\r\n  };\r\n\r\n  const selectCountry = (event: React.MouseEvent<HTMLButtonElement>) => {\r\n    console.log(event.currentTarget.value);\r\n    setCountryValue(event.currentTarget.value);\r\n    if(event.currentTarget.value === \"United States of America\") {      \r\n      setShowState(true);\r\n    }\r\n    else setShowState(false);\r\n  }\r\n\r\n  return (\r\n    <Styles>\r\n      <div className=\"col-md-12\">\r\n        <div className=\"card card-container\">\r\n          <img\r\n            src=\"//ssl.gstatic.com/accounts/ui/avatar_2x.png\"\r\n            alt=\"profile-img\"\r\n            className=\"profile-img-card\"\r\n          />\r\n          <Formik\r\n            initialValues={initialValues}\r\n            validationSchema={validationSchema}\r\n            onSubmit={handleRegister}\r\n          >\r\n            <Form>\r\n              {!successful && (\r\n                <div>\r\n                  <div className=\"form-group\">\r\n                    <label htmlFor=\"username\"> Username </label>\r\n                    <Field name=\"username\" type=\"text\" className=\"form-control\" />\r\n                    <ErrorMessage\r\n                      name=\"username\"\r\n                      component=\"div\"\r\n                      className=\"alert alert-danger\"\r\n                    />\r\n                  </div>\r\n                  <div className=\"form-group\">\r\n                    <label htmlFor=\"email\"> Email </label>\r\n                    <Field name=\"email\" type=\"email\" className=\"form-control\" />\r\n                    <ErrorMessage\r\n                      name=\"email\"\r\n                      component=\"div\"\r\n                      className=\"alert alert-danger\"\r\n                    />\r\n                  </div>\r\n                  <div className=\"form-group\">\r\n                    <label htmlFor=\"password\"> Password </label>\r\n                    <Field\r\n                      name=\"password\"\r\n                      type=\"password\"\r\n                      className=\"form-control\"\r\n                    />\r\n                    <ErrorMessage\r\n                      name=\"password\"\r\n                      component=\"div\"\r\n                      className=\"alert alert-danger\"\r\n                    />\r\n                  </div>\r\n                  \r\n                  <div className=\"form-group\">\r\n                    <label htmlFor=\"country\"> Country </label>\r\n                    <Field\r\n                      name=\"country\"\r\n                      as=\"select\"\r\n                      className=\"form-control\"\r\n                      value={countryValue}\r\n                      onChange={selectCountry}\r\n                    >\r\n                      <option value=\"United States of America\">United States of America</option>\r\n                      <option value=\"United Kingdom\">United Kingdom</option>\r\n                      <option value=\"China\">China</option>\r\n                      <option value=\"Russia\">Russia</option>\r\n                      <option value=\"France\">France</option>\r\n                      <option value=\"Germany\">Germany</option>\r\n                    </Field>\r\n                    <ErrorMessage\r\n                      name=\"country\"\r\n                      component=\"div\"\r\n                      className=\"alert alert-danger\"\r\n                    />\r\n                  </div>\r\n\r\n                  {showState?\r\n                  <div className=\"form-group\" >\r\n                    <label htmlFor=\"state\"> State </label>\r\n                    <Field\r\n                      name=\"state\"\r\n                      as=\"select\"\r\n                      className=\"form-control\"\r\n                    >\r\n                      <option value=\"Nebraska\">Nebraska</option>\r\n                      <option value=\"Florida\">Florida</option>\r\n                      <option value=\"Washington\">Washington</option>\r\n                      <option value=\"Kansas\">Kansas</option>\r\n                    </Field>\r\n                    <ErrorMessage\r\n                      name=\"country\"\r\n                      component=\"div\"\r\n                      className=\"alert alert-danger\"\r\n                    />\r\n                  </div> :\r\n                  null\r\n                  }\r\n                  <div className=\"form-group\">\r\n                    <label htmlFor=\"gender\"> Gender </label>\r\n                    <Field as=\"select\" name=\"gender\" className=\"form-control\">\r\n                      <option value=\"male\">Male</option>\r\n                      <option value=\"female\">Female</option>\r\n                    </Field>\r\n                    <ErrorMessage\r\n                      name=\"gender\"\r\n                      component=\"div\"\r\n                      className=\"alert alert-danger\"\r\n                    />\r\n                  </div>\r\n                  <div className=\"form-group\">\r\n                    <label htmlFor=\"birthday\"> Birthday </label>\r\n                    <Field\r\n                      name=\"birthday\"\r\n                      type=\"date\"\r\n                      className=\"form-control\"\r\n                    />\r\n                    <ErrorMessage\r\n                      name=\"birthday\"\r\n                      component=\"div\"\r\n                      className=\"alert alert-danger\"\r\n                    />\r\n                  </div>\r\n                  <div className=\"form-group\">\r\n                    <button type=\"submit\" className=\"btn btn-primary btn-block\">Sign Up</button>\r\n                  </div>\r\n                </div>\r\n              )}\r\n              {message && (\r\n                <div className=\"form-group\">\r\n                  <div\r\n                    className={\r\n                      successful ? \"alert alert-success\" : \"alert alert-danger\"\r\n                    }\r\n                    role=\"alert\"\r\n                  >\r\n                    {message}\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </Form>\r\n          </Formik>\r\n        </div>\r\n      </div>\r\n    </Styles>\r\n  );\r\n};\r\nexport default Register;\r\n\r\n","import React, { useEffect, useState } from \"react\";\r\nimport UserService from \"../../services/user.service\";\r\nimport styled from \"styled-components\";\r\nimport \"./home.css\";\r\n\r\nfunction Home() {\r\n    const [content, setContent] = useState();\r\n    // useEffect(() => {\r\n    //     UserService.getPublicContent().then(\r\n    //         response => {\r\n    //             setContent(response.data);\r\n    //         },\r\n    //         error => {\r\n    //             setContent(\r\n    //                 (error.response && error.response.data) ||\r\n    //                 error.message ||\r\n    //                 error.toString()\r\n    //             );\r\n    //         }\r\n    //       );\r\n    // }, [])\r\n    return(\r\n        \r\n        <Page>\r\n            <header className=\"jumbotron\">\r\n                <h1 className = \"content contentColor\">WELCOME TO BACKGAMMON</h1>\r\n            </header>\r\n        </Page>\r\n    );\r\n}\r\nconst Page = styled.div`\r\n  background-image: url(/wood-texture.png);\r\n\r\n  height: 100%;\r\n  padding: 10px;\r\n\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n`;\r\n\r\nexport default Home;\r\n","import React from \"react\";\r\nimport AuthService from \"../../../services/auth.service\";\r\nconst Profile: React.FC = () => {\r\n  const currentUser = AuthService.getCurrentUser();\r\n  return (\r\n    <div className=\"container\">\r\n      <header className=\"jumbotron\">\r\n        <h3>\r\n          <strong>{currentUser.username}</strong> Profile\r\n        </h3>\r\n      </header>\r\n      <p>\r\n        <strong>Token:</strong> {currentUser.accessToken.substring(0, 20)} ...{\" \"}\r\n        {currentUser.accessToken.substr(currentUser.accessToken.length - 20)}\r\n      </p>\r\n      <p>\r\n        <strong>Id:</strong> {currentUser.id}\r\n      </p>\r\n      <p>\r\n        <strong>Email:</strong> {currentUser.email}\r\n      </p>\r\n      <strong>Authority:</strong>\r\n      <ul>\r\n        {currentUser.role }\r\n      </ul>\r\n    </div>\r\n  );\r\n};\r\nexport default Profile;","import { AxiosRequestHeaders } from 'axios';\r\n  \r\n  type UserInfo = {\r\n    accessToken: string;\r\n  };\r\n  \r\n  export default function authHeader(): AxiosRequestHeaders {\r\n    // Set this to whatever the minimum token length should be (if you know)\r\n    // Otherwise, you can leave at 1 for \"not an empty string\"\r\n    const minTokenLength = 1;\r\n  \r\n    try {\r\n      const userInfo = localStorage.getItem('user');\r\n      // Abort if not string\r\n      if (typeof userInfo !== 'string') throw new Error('User info not found');\r\n  \r\n      // Destructure token\r\n      const {accessToken} = JSON.parse(userInfo) as UserInfo;\r\n  \r\n      // Abort if token is not string and min length\r\n      if (!(typeof accessToken === 'string' && accessToken.length >= minTokenLength)) {\r\n        throw new Error('Invalid user access token');\r\n      }\r\n  \r\n      // I left this here because it seems like you weren't sure about which format you need:\r\n      // return {Authorization: `Bearer ${accessToken}`};\r\n  \r\n      // Return headers object\r\n      return {'x-access-token': accessToken};\r\n    }\r\n    catch {\r\n      // Catch any errors and return an empty headers object\r\n      return {};\r\n    }\r\n  }\r\n  ","import axios from 'axios';\r\nimport authHeader from './auth-header';\r\nimport { API_URL } from '../config';\r\n// const API_URL = \"https://backgammoncloud-z3qxp.ondigitalocean.app/api/\";\r\n\r\n// const API_URL = 'https://backgammoncloud-z3qxp.ondigitalocean.app/api/';\r\n// const API_URL = 'https://backgammoncloud.com/api/';\r\n// const API_URL = 'http://159.223.142.17:3001/api/';\r\n// const API_URL = 'http://localhost:3001/api/';\r\n// const API_URL = 'https://backgammongameproject.herokuapp.com/api/';\r\n// const API_URL = 'http://localhost:8080/api/test/';\r\n\r\nclass UserService {\r\n  getPublicContent() {\r\n    return axios.get(API_URL + 'all');\r\n  }\r\n\r\n  getUserBoard() {\r\n    return axios.get(API_URL + 'user', { headers: authHeader() });\r\n  }\r\n\r\n  getAdminBoard() {\r\n    return axios.get(API_URL + 'admin', { headers: authHeader() });\r\n  }\r\n\r\n  getAllUsers() {\r\n    return axios.get(API_URL + 'users', { headers: authHeader() });\r\n  }\r\n\r\n  deleteUser(deleteItem: string) {\r\n    let data = {\r\n      deleteItem: deleteItem\r\n    }\r\n    return axios.post(API_URL + 'delete', data, { headers: authHeader() });\r\n  }\r\n}\r\n\r\nexport default new UserService();","import { Component } from \"react\";\r\n\r\nimport UserService from \"../../services/user.service\";\r\nimport EventBus from \"../../common/EventBus\";\r\n\r\ntype Props = {};\r\n\r\ntype State = {\r\n  content: string;\r\n}\r\n\r\nexport default class BoardUser extends Component<Props, State> {\r\n  constructor(props: Props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      content: \"\"\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    UserService.getUserBoard().then(\r\n      response => {\r\n        this.setState({\r\n          content: response.data\r\n        });\r\n      },\r\n      error => {\r\n        this.setState({\r\n          content:\r\n            (error.response &&\r\n              error.response.data &&\r\n              error.response.data.message) ||\r\n            error.message ||\r\n            error.toString()\r\n        });\r\n\r\n        if (error.response && error.response.status === 401) {\r\n          EventBus.dispatch(\"logout\");\r\n        }\r\n      }\r\n    );\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"container\">\r\n        <header className=\"jumbotron\">\r\n          <h3>{this.state.content}</h3>\r\n        </header>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import { useEffect } from \"react\";\r\nimport { useNetworkManager } from \"../game-manager/network-manager\";\r\nimport styled from \"styled-components\";\r\n// import { useTable, useSortBy } from \"react-table\";\r\n\r\n// import InfiniteScroll from \"react-infinite-scroll-component\";\r\n// import { TextDecoder } from \"util\";\r\n\r\n//components\r\n\r\n\r\nconst Styles = styled.div`\r\n  background-image: url(wood-t.jpg);\r\n  height: 100%;\r\n  padding: 1rem;\r\n\r\n  table {\r\n    border-spacing: 0;\r\n    border: 1px solid black;\r\n    margin: auto;\r\n    tr {\r\n      :last-child {\r\n        td {\r\n          border-bottom: 0;\r\n        }\r\n      }\r\n    }\r\n\r\n    th,\r\n    td {\r\n      margin: 0;\r\n      padding: 0.5rem;\r\n      text-align: center;\r\n      border-bottom: 1px solid black;\r\n      border-right: 1px solid black;\r\n\r\n      :last-child {\r\n        border-right: 0;\r\n      }\r\n    }\r\n    tr:hover {background-color: #D6EEEE;}\r\n\r\n  }\r\n`;\r\n\r\n\r\nfunction AllRoomsComponent() {\r\n  const { emitterService, roomsService } = useNetworkManager();\r\n\r\n  const {\r\n    allRooms,\r\n  } = roomsService;\r\n\r\n  useEffect(() => {\r\n    emitterService.getAllRooms();\r\n  }, []);\r\n  // let i = 0;\r\n\r\n  const deleteItem = (event: React.MouseEvent<HTMLButtonElement>) => {\r\n    console.log(event.currentTarget.value);\r\n    emitterService.deleteRoom(event.currentTarget.value);\r\n  }\r\n\r\n  const countPlayers = (j: number): number => {\r\n    if(!(allRooms[j-1].hostUsername)) return 0;\r\n    else if(allRooms[j-1].hostUsername && !(allRooms[j-1].guestUsername)) return 1;\r\n    else return 2;\r\n  }\r\n  \r\n  return (\r\n    <Styles>\r\n      <table>\r\n        <thead>\r\n          <tr>\r\n            <th>Room No</th>\r\n            <th>Room Name</th>\r\n            <th>Live Users</th>\r\n            <th>First Player</th>\r\n            <th>Second Player</th>\r\n            <th>First Player Country</th>\r\n            <th>Second Player Country</th>\r\n            <th>Delete</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n\r\n          {allRooms.map((room, i) => (\r\n            <tr key = {i}>\r\n              <td>{ ++i }</td>\r\n              <td>{ room.name }</td>\r\n              <td>{ countPlayers(i) }</td>\r\n              <td>{ room.hostUsername }</td>\r\n              <td>{ room.guestUsername }</td>\r\n              <td>{ room.hostCountry }</td>\r\n              <td>{ room.guestCountry }</td>\r\n              <td>\r\n                <button value={room.id} onClick={deleteItem}>\r\n                  Delete\r\n                </button>\r\n              </td>\r\n            </tr>\r\n          ))}\r\n        </tbody>\r\n      </table>\r\n    </Styles>\r\n  );\r\n}\r\n\r\nexport default AllRoomsComponent;\r\n","import React, { useEffect, useState } from \"react\";\r\nimport userService from \"../../../services/user.service\";\r\nimport { UserInfo } from \"../../../types/user.type\";\r\nimport EventBus from \"../../../common/EventBus\";\r\nimport styled from \"styled-components\";\r\n\r\n//components\r\nconst Styles = styled.div`\r\n  background-image: url(wood-t.jpg);\r\n  height: 100%;\r\n  padding: 1rem;\r\n\r\n  table {\r\n    border-spacing: 0;\r\n    border: 1px solid black;\r\n    margin: auto;\r\n    tr {\r\n      :last-child {\r\n        td {\r\n          border-bottom: 0;\r\n        }\r\n      }\r\n    }\r\n\r\n    th,\r\n    td {\r\n      margin: 0;\r\n      padding: 0.5rem;\r\n      text-align: center;\r\n      border-bottom: 1px solid black;\r\n      border-right: 1px solid black;\r\n\r\n      :last-child {\r\n        border-right: 0;\r\n      }\r\n    }\r\n    tr:hover {background-color: #D6EEEE;}\r\n\r\n  }\r\n`;\r\n\r\n\r\n\r\nfunction AllUsersComponent() {\r\n\r\n  const [ Datas, setDatas ] = useState<UserInfo[]>([]);\r\n  const [ error, setError ] = useState(\"\");\r\n\r\n\r\n  useEffect(() => {\r\n\r\n    userService.getAllUsers().then(\r\n        response => {\r\n            console.log(response.data);\r\n            setDatas(response.data);\r\n        },\r\n        error => {\r\n                setError(\r\n\r\n                    (error.response &&\r\n                        error.response.data &&\r\n                        error.response.data.message) ||\r\n                        error.message ||\r\n                        error.toString()\r\n                )\r\n            \r\n    \r\n            if (error.response && error.response.status === 401) {\r\n              EventBus.dispatch(\"logout\");\r\n            }\r\n        }\r\n    );\r\n  }, []);\r\n  const deleteItem = (event: React.MouseEvent<HTMLButtonElement>) => {\r\n    userService.deleteUser(event.currentTarget.value).then(\r\n      response => {\r\n        console.log(response.data);\r\n        setDatas(response.data);\r\n      },\r\n      error => {\r\n        setError(\r\n\r\n            (error.response &&\r\n                error.response.data &&\r\n                error.response.data.message) ||\r\n                error.message ||\r\n                error.toString()\r\n        )\r\n    \r\n\r\n          if (error.response && error.response.status === 401) {\r\n            EventBus.dispatch(\"logout\");\r\n          }\r\n      }\r\n    );\r\n    console.log(event.currentTarget.value);\r\n  }\r\n\r\n  const editItem = (event: React.MouseEvent<HTMLButtonElement>) => {\r\n    const result = Datas.filter(data => data.email === event.currentTarget.value);\r\n    console.log(result);\r\n    //Todo: make modal for editing content\r\n  }\r\n  \r\n  return (\r\n    <Styles>\r\n      <table>\r\n        <thead>\r\n          <tr>\r\n            <th>No</th>\r\n            <th>Name</th>\r\n            <th>Email</th>\r\n            <th>Country</th>\r\n            <th>Gender</th>\r\n            <th>Birthday</th>\r\n            <th>Win Times</th>\r\n            <th>Loss Times</th>\r\n            <th>Created Date</th>\r\n            <th>Last Login Date</th>\r\n            <th>Delete</th>\r\n            {/* <th>Edit</th> */}\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {Datas.map((user, i) => (\r\n            <tr key = {i}>\r\n              <td>{ ++i }</td>\r\n              <td>{ user.username }</td>\r\n              <td>{ user.email }</td>\r\n              {(user.state)?\r\n              <td>{ user.country }/{user.state}</td>:\r\n              <td>{ user.country }</td>\r\n              }\r\n              <td>{ user.gender }</td>\r\n              <td>{ user.birthday }</td>\r\n              <td>{ user.win_time }</td>\r\n              <td>{ user.loss_time }</td>\r\n              <td>{ user.created_date }</td>\r\n              <td>{ user.last_login_date }</td>\r\n              <td>\r\n                <button value={user.email} onClick={deleteItem}>\r\n                  Delete\r\n                </button>\r\n              </td>\r\n              {/* <td>\r\n                <button value={user.email} onClick={editItem}>\r\n                  Edit\r\n                </button>\r\n              </td> */}\r\n            </tr>\r\n          ))}\r\n        </tbody>\r\n      </table>\r\n    </Styles>\r\n  );\r\n};\r\n\r\nexport default AllUsersComponent;\r\n\r\n","import React, { ReactComponentElement, FC, Component } from \"react\";\r\nimport LobbyPage from \"./lobby\";\r\nimport PlaygroundPage from \"./playground\";\r\nimport Login from \"../game/components/login\";\r\nimport Register from \"../game/components/register\";\r\nimport Home from \"./Home\";\r\nimport Profile from \"../game/components/profile\";\r\nimport BoardUser from \"./boardUser\";\r\nimport BoardAdmin from \"./boardAdmin\";\r\nimport { RouteComponentProps } from \"react-router-dom\";\r\nimport AllRoomsComponent from \"../game/components/allRooms\";\r\nimport AllUsersComponent from \"../game/components/allUsers\";\r\ninterface RouterProps {\r\n  history: string;\r\n}\r\ntype Props = RouteComponentProps<RouterProps>;\r\ninterface RouteConfig {\r\n  id: string;\r\n  path: string;\r\n  component: FC<{}> | FC<Props> | Component;\r\n  isExact: boolean;\r\n}\r\n\r\nconst routes = [\r\n  {\r\n    id: \"dashboard\",\r\n    path: \"/\",\r\n    component: Home,\r\n    isExact: true,\r\n  },\r\n  {\r\n    id: \"login\",\r\n    path: \"/login\",\r\n    component: Login,\r\n    isExact: true,\r\n  },\r\n  {\r\n    id: \"register\",\r\n    path: \"/register\",\r\n    component: Register,\r\n    isExact: true,\r\n  },\r\n  {\r\n    id: \"profile\",\r\n    path: \"/profile\",\r\n    component: Profile,\r\n    isExact: true,\r\n  },\r\n  {\r\n    id: \"boardUser\",\r\n    path: \"/boardUser\",\r\n    component: BoardUser,\r\n    isExact: true,\r\n  },\r\n  {\r\n    id: \"allRooms\",\r\n    path: \"/roomStatus\",\r\n    component: AllRoomsComponent,\r\n    isExact: true,\r\n  },\r\n  {\r\n    id: \"allUsers\",\r\n    path: \"/users\",\r\n    component: AllUsersComponent,\r\n    isExact: true,\r\n  },\r\n  {\r\n    id: \"lobby\",\r\n    path: \"/game\",\r\n    component: LobbyPage,\r\n    isExact: true,\r\n  },\r\n  {\r\n    id: \"lobby\",\r\n    path: \"/game/create\",\r\n    component: LobbyPage,\r\n    isExact: true,\r\n  },\r\n  {\r\n    id: \"lobby\",\r\n    path: \"/game/join\",\r\n    component: LobbyPage,\r\n    isExact: true,\r\n  },\r\n  {\r\n    id: \"lobby\",\r\n    path: \"/about\",\r\n    component: LobbyPage,\r\n    isExact: true,\r\n  },\r\n  {\r\n    id: \"playground\",\r\n    path: \"/game/:id\",\r\n    component: PlaygroundPage,\r\n    isExact: true,\r\n  },\r\n];\r\n\r\nexport default routes;\r\n","import React, { useState, useEffect, useContext } from \"react\";\r\nimport { BrowserRouter, Switch, Route, Link } from \"react-router-dom\";\r\n\r\nimport routes from \"./config\";\r\n\r\nimport { useNetworkManager } from \"../game/game-manager/network-manager\";\r\n\r\nimport AuthService from \"../services/auth.service\";\r\nimport IUser from '../types/user.type';\r\n\r\nimport EventBus from \"../common/EventBus\";\r\n\r\nconst Main: React.FC = () => {\r\n  \r\n  const networkManager = useNetworkManager();\r\n  const networkState = networkManager.networkState;\r\n  const [ gameStatus, setGameStatus ] = useState(false);\r\n  const [ currentUser, setCurrentUser ] = useState<IUser>();\r\n  const [ showAdminBoard, setShowAdminBoard ] = useState(false);\r\n  const [ numberOfLogin, setNumberOfLogin ] = useState(0);\r\n  // const [ isLobby, setIsLobby ] = useState(false);\r\n  useEffect(() => {    \r\n    const user = AuthService.getCurrentUser();\r\n    if (user) {\r\n      setCurrentUser(user);\r\n    //   setNumberOfLogin(user.numberOfLogin)\r\n      setShowAdminBoard((user.role == \"ROLE_ADMIN\"));\r\n      EventBus.on(\"logout\", logOut);\r\n\r\n      return () => {\r\n        EventBus.remove(\"logout\", logOut);\r\n      }\r\n    }\r\n  \r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    if(networkState.status === \"STARTED\" || networkState.status === \"WAITING_FOR_GUEST\") setGameStatus(true);\r\n    else setGameStatus(false);\r\n  }, [networkState])\r\n\r\n  // function set_isLobby(islobby = false) {\r\n  //   setIsLobby(islobby);\r\n  //   console.log(\"set as true:\", isLobby);\r\n  // }\r\n  \r\n  function logOut() {\r\n    AuthService.logout();\r\n    setCurrentUser(undefined);\r\n    setShowAdminBoard(false);\r\n  }\r\n\r\n  return (\r\n    <div className=\"d-flex flex-column h-100\">\r\n        {!gameStatus &&\r\n        \r\n        <nav className=\"navbar navbar-expand navbar-dark bg-dark\">\r\n            <Link to={\"/\"} className=\"navbar-brand\">\r\n                Backgammon\r\n            </Link>\r\n            <div className=\"navbar-nav mr-auto\">\r\n                {currentUser && (\r\n                <li className=\"nav-item\">\r\n                    <Link to={\"/game\"} className=\"nav-link\">\r\n                    Lobby\r\n                    </Link>\r\n                </li>\r\n                )}\r\n\r\n                {showAdminBoard && (\r\n                    <li className=\"nav-item\">\r\n                    <Link to={\"/roomStatus\"} className=\"nav-link\">\r\n                        Room Status\r\n                    </Link>\r\n                    </li>\r\n\r\n                )}\r\n                {showAdminBoard && (\r\n\r\n                    <li className=\"nav-item\">\r\n                    <Link to={\"/users\"} className=\"nav-link\">\r\n                        Users Info\r\n                    </Link>\r\n                    </li>\r\n                )}\r\n\r\n                {/* {currentUser && (\r\n                <li className=\"nav-item\">\r\n                    <Link to={\"/user\"} className=\"nav-link\">\r\n                    User\r\n                    </Link>\r\n                </li>\r\n                )} */}\r\n            </div>\r\n\r\n            {currentUser ? (\r\n                <div className=\"navbar-nav ms-auto\">\r\n                {/* <li className=\"nav-item nav-link\">\r\n                    Number Of Login {numberOfLogin}\r\n                </li> */}\r\n                <li className=\"nav-item\">\r\n                    <a href=\"/login\" className=\"nav-link\" onClick={logOut}>\r\n                    LogOut\r\n                    </a>\r\n                </li>\r\n                </div>\r\n            ) : (\r\n                <div className=\"navbar-nav ms-auto\">\r\n                <li className=\"nav-item\">\r\n                    <Link to={\"/login\"} className=\"nav-link\">\r\n                    Login\r\n                    </Link>\r\n                </li>\r\n\r\n                <li className=\"nav-item\">\r\n                    <Link to={\"/register\"} className=\"nav-link\">\r\n                    Sign Up\r\n                    </Link>\r\n                </li>\r\n                </div>\r\n            )}\r\n        </nav>\r\n        }\r\n\r\n        <div className=\"flex-fill\">\r\n        <Switch>\r\n            {routes.map((route) => (\r\n\r\n            <Route\r\n            key={route.id}\r\n            exact={route.isExact}\r\n            path={route.path}\r\n            component={route.component}\r\n            />\r\n            ))}\r\n        </Switch>\r\n        </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Main;\r\n\r\n\r\n","import React, { useState, useEffect, useContext } from \"react\";\r\nimport { BrowserRouter, Switch, Route, Link } from \"react-router-dom\";\r\n\r\nimport routes from \"./config\";\r\n\r\nimport { GameStateProvider } from \"../game/game-manager/game-state\";\r\nimport { GameUIProvider } from \"../game/game-manager/game-ui\";\r\nimport { NetworkManagerProvider, useNetworkManager } from \"../game/game-manager/network-manager\";\r\nimport { InferenceProvider } from \"../game/game-manager/inference\";\r\nimport { StatsProvider } from \"../game/game-manager/stats\";\r\n\r\nimport AuthService from \"../services/auth.service\";\r\nimport IUser from '../types/user.type';\r\n\r\nimport EventBus from \"../common/EventBus\";\r\nimport Main from \"./main\";\r\n\r\nconst RouterWrapper: React.FC = () => {\r\n  \r\n  // const networkState = useNetworkManager();\r\n  // const status = networkState.networkState;\r\n  const [ gameStatus, setGameStatus ] = useState(false);\r\n  const [ currentUser, setCurrentUser ] = useState<IUser>();\r\n  const [ showAdminBoard, setShowAdminBoard ] = useState(false);\r\n  // const [ isLobby, setIsLobby ] = useState(false);\r\n  useEffect(() => {\r\n    // if(status.status === \"STARTED\") setGameStatus(true);\r\n    \r\n    const user = AuthService.getCurrentUser();\r\n    if (user) {\r\n      setCurrentUser(user);\r\n      setShowAdminBoard((user.role == \"ROLE_ADMIN\"));\r\n      EventBus.on(\"logout\", logOut);\r\n\r\n      return () => {\r\n        EventBus.remove(\"logout\", logOut);\r\n      }\r\n    }\r\n  \r\n  }, [])\r\n\r\n  // function set_isLobby(islobby = false) {\r\n  //   setIsLobby(islobby);\r\n  //   console.log(\"set as true:\", isLobby);\r\n  // }\r\n  \r\n  function logOut() {\r\n    AuthService.logout();\r\n    setCurrentUser(undefined);\r\n    setShowAdminBoard(false);\r\n  }\r\n\r\n  return (\r\n    <BrowserRouter>\r\n      <GameStateProvider>\r\n        <GameUIProvider>\r\n          <NetworkManagerProvider>\r\n            <InferenceProvider>\r\n              <StatsProvider>\r\n                <Main />\r\n              </StatsProvider>\r\n            </InferenceProvider>\r\n          </NetworkManagerProvider>\r\n        </GameUIProvider>\r\n      </GameStateProvider>\r\n    </BrowserRouter>\r\n  );\r\n};\r\n\r\nexport default RouterWrapper;\r\n\r\n\r\n","import React, { useEffect, useState } from \"react\";\r\nimport useSound from \"use-sound\";\r\n\r\nimport { ThemeProvider } from \"styled-components\";\r\n// import styled from \"styled-components\";\r\n\r\n//styles\r\nimport \"./App.css\";\r\nimport \"bootstrap/dist/css/bootstrap.min.css\";\r\n\r\nimport Pages from \"./pages\";\r\n\r\n// let BOARD_RATIO = 1;\r\n// let BOARD_ASPECT_RATIO = 2;\r\n\r\nconst App: React.FC = () => {\r\n  const [currentWidth, setCurrentWidth] = useState<number>(window.innerWidth);\r\n  const [currentHeight, setCurrentHeight] = useState<number>(\r\n    window.innerHeight\r\n  );\r\n\r\n  const [playMove] = useSound(\"/sound-effects/move.mp3\");\r\n  const [playHit] = useSound(\"/sound-effects/hit.wav\");\r\n  const [playDieThrow] = useSound(\"/sound-effects/dice.wav\");\r\n  const [playSelectChecker] = useSound(\"/sound-effects/select-checker.wav\");\r\n  const [confirmMove] = useSound(\"/sound-effects/confirm-move.wav\");\r\n  const [undoMove] = useSound(\"/sound-effects/undo.wav\");\r\n  const [playWin] = useSound(\"/sound-effects/win.wav\");\r\n\r\n  useEffect(() => {\r\n    const onResize = () => {\r\n      const { innerWidth, innerHeight } = window;\r\n\r\n      // if (innerHeight > innerWidth) {\r\n      //   BOARD_RATIO = 0.9;\r\n      //   BOARD_ASPECT_RATIO = 1.1;\r\n      // } else {\r\n      //   BOARD_RATIO = 0.85;\r\n      //   BOARD_ASPECT_RATIO = 1.8;\r\n      // }\r\n\r\n      setCurrentWidth(innerWidth);\r\n      setCurrentHeight(innerHeight);\r\n    };\r\n\r\n    window.addEventListener(\"resize\", onResize);\r\n\r\n    return () => window.removeEventListener(\"resize\", onResize);\r\n  }, []);\r\n\r\n  const theme = {\r\n    dimensions: {\r\n      width: Math.min(1000, currentWidth * 0.8), //currentWidth * BOARD_RATIO,\r\n      height: Math.min(1000, currentHeight * 0.8), //(currentWidth * BOARD_RATIO) / BOARD_ASPECT_RATIO,\r\n    },\r\n  };\r\n\r\n  return (\r\n    <div style={{height: 100 + 'vh'}}>\r\n\r\n      <ThemeProvider theme={theme} >\r\n        <Pages />\r\n        <button\r\n          style={{ display: \"none\" }}\r\n          onClick={() => playMove()}\r\n          id=\"play-move\"\r\n        >\r\n          play\r\n        </button>\r\n        <button\r\n          style={{ display: \"none\" }}\r\n          onClick={() => playHit()}\r\n          id=\"play-hit\"\r\n        >\r\n          hit\r\n        </button>\r\n        <button\r\n          style={{ display: \"none\" }}\r\n          onClick={() => playDieThrow()}\r\n          id=\"play-dice-throw\"\r\n        >\r\n          Dice Throw\r\n        </button>\r\n\r\n        <button\r\n          style={{ display: \"none\" }}\r\n          onClick={() => playSelectChecker()}\r\n          id=\"play-select-checker\"\r\n        >\r\n          Select Checker\r\n        </button>\r\n\r\n        <button\r\n          style={{ display: \"none\" }}\r\n          onClick={() => confirmMove()}\r\n          id=\"play-confirm-move\"\r\n        >\r\n          Confirm Move\r\n        </button>\r\n        <button\r\n          style={{ display: \"none\" }}\r\n          onClick={() => undoMove()}\r\n          id=\"play-undo-move\"\r\n        >\r\n          Undo Move\r\n        </button>\r\n        <button\r\n          style={{ display: \"none\" }}\r\n          onClick={() => playWin()}\r\n          id=\"play-win\"\r\n        >\r\n          Win\r\n        </button>\r\n      </ThemeProvider>\r\n    </div>\r\n  );\r\n};\r\n\r\n// const Wrapper = styled.div`\r\n//   background-image: url(wood-texture.png);\r\n//   min-height: 100vh;\r\n//   display: flex;\r\n//   justify-content: center;\r\n//   align-items: center;\r\n// `;\r\n\r\nexport default App;\r\n","import { ReportHandler } from 'web-vitals';\r\n\r\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport \"./index.css\";\r\nimport App from \"./App\";\r\nimport reportWebVitals from \"./reportWebVitals\";\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById(\"root\")\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}